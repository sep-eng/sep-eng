<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>SEP | Your Choice</title>
<meta name="description" content="Minimalist clothing made with intention. Hand-pressed in Copenhagen." />
<link rel="icon" href="https://upload.wikimedia.org/wikipedia/commons/3/3f/Black_square.jpg">

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>

<style>
body {
  font-family: 'Inter', sans-serif;
  background: linear-gradient(to bottom, #000, #fff);
  color: #111;
  transition: background .5s, color .5s;
  scroll-behavior: smooth;
}

h1, h2, h3, p, select, input, button, span {
  transition: color .5s, background-color .5s, border-color .5s;
}

.theme-text { color: #e6e6e6; }

button, a { transition: all .25s ease; }
button:hover, a:hover { transform: translateY(-2px); }

.popup{
  position:fixed;
  top:20px;
  right:20px;
  background:#16a34a;
  color:#fff;
  padding:10px 16px;
  border-radius:8px;
  opacity:0;
  transition:opacity .3s;
  z-index:100;
}
.popup.show{opacity:1;}

.fade-section{opacity:0;transform:translateY(30px);}

/* Cart sidebar base */
#cartSidebar{color:#000;transition:background .5s,color .5s;}

/* Scenes: only one visible at a time */
.scene { display:none; }
.scene.active { display:block; }

/* GLOBAL NAV BUTTON GROUP (top-right) */
#globalNavButtons {
  position:fixed;
  top:10px;
  right:12px;
  z-index:70;
  display:flex;
  flex-direction:column;
  gap:6px;
}

/* Hamburger main button */
.nav-toggle-btn {
  background:rgba(0,0,0,0.8);
  color:#fff;
  border-radius:9999px;
  padding:6px 10px;
  font-size:10px;
  border:1px solid rgba(255,255,255,0.3);
  display:flex;
  align-items:center;
  gap:6px;
}

/* The lines icon */
.nav-lines {
  display:inline-block;
  width:14px;
  height:10px;
  position:relative;
}
.nav-lines span {
  position:absolute;
  left:0;
  right:0;
  height:2px;
  background:#fff;
  border-radius:999px;
}
.nav-lines span:nth-child(1){top:0;}
.nav-lines span:nth-child(2){top:4px;}
.nav-lines span:nth-child(3){top:8px;}

/* Dropdown nav under the button */
#navMenu {
  margin-top:4px;
  background:rgba(0,0,0,0.85);
  border-radius:9999px;
  padding:4px 6px;
  border:1px solid rgba(255,255,255,0.25);
  display:none;
}
#navMenu.show { display:flex; }

#navMenu button {
  font-size:10px;
  padding:4px 8px;
  border-radius:9999px;
  border:1px solid rgba(255,255,255,0.15);
  background:transparent;
  color:#f3f3f3;
  white-space:nowrap;
}

/* MIH cards */
.mih-card {
  background:rgba(255,255,255,0.04);
  border-radius:16px;
  border:1px solid rgba(255,255,255,0.12);
  box-shadow:0 18px 45px rgba(0,0,0,0.45);
}

/* Small helper to hide while cart open */
.hidden-during-cart { transition:opacity .2s; }

/* Simple profile layout */
.profile-label { font-size:11px; text-transform:uppercase; letter-spacing:0.08em; color:#9ca3af; }
.profile-value { font-size:14px; }
</style>

<script>
window.addEventListener('load',()=>{
  gsap.registerPlugin(ScrollTrigger);
  gsap.utils.toArray('.fade-section').forEach(sec=>{
    gsap.to(sec,{
      opacity:1,
      y:0,
      duration:1,
      scrollTrigger:{trigger:sec,start:'top 80%',once:true}
    });
  });
});
</script>
</head>

<body>

<!-- GLOBAL NAV BUTTONS (works on all scenes, hidden when cart open) -->
<div id="globalNavButtons" class="hidden-during-cart">
  <button id="mainNavToggle" class="nav-toggle-btn" type="button">
    <span class="nav-lines">
      <span></span><span></span><span></span>
    </span>
    <span>Menu</span>
  </button>
  <div id="navMenu">
    <button type="button" onclick="showScene('sep-shop')">SEP shop</button>
    <button type="button" onclick="showScene('sep-about')">About SEP</button>
    <button type="button" onclick="showScene('mih-welcome')">Make it happen</button>
    <button type="button" onclick="showScene('mih-about')">About Make it happen</button>
  </div>
</div>

<!-- ===================== SCENE: SEP SHOP ===================== -->
<section id="scene-sep-shop" class="scene active">
  <header class="py-20 text-center fade-section">
    <h1 class="theme-text text-5xl font-bold mb-4">Minimalist clothing, made with intention.</h1>
    <p class="theme-text text-lg mb-8">Soft, clean, and hand-pressed in Copenhagen.</p>
    <div id="sepHeroButtons" class="flex justify-center gap-4 hidden-during-cart">
      <a href="#products" class="bg-white text-black px-6 py-3 rounded-full font-medium">Shop Now</a>
      <button id="viewCartBtn" class="border border-white text-white px-6 py-3 rounded-full font-medium relative">
        View Cart
        <span id="cartCounter" class="absolute -top-2 -right-2 bg-red-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs hidden">0</span>
      </button>
    </div>
  </header>

  <section id="products" class="py-20 px-6 fade-section">
    <div class="text-center mb-12">
      <h2 class="theme-text text-4xl font-bold mb-4">Three products. One choice.</h2>
      <p class="theme-text">Soft, durable, and timeless.</p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 max-w-6xl mx-auto">
      <div class="product-card bg-white/10 p-6 rounded-xl shadow-md text-center backdrop-blur">
        <img src="http://static.photos/textures/1024x576/1" class="w-full h-64 object-cover rounded mb-4" alt="White T-shirt">
        <h3 class="text-xl font-bold mb-2">SEP White T-shirt</h3>
        <p class="mb-2">180 kr.</p>
        <select class="theme-text border rounded px-3 py-2 mb-2 bg-transparent">
          <option>XS</option><option>S</option><option>M</option><option>L</option><option>XL</option>
        </select>
        <div class="flex justify-center gap-2">
          <input type="number" min="1" value="1" class="theme-text border rounded w-16 text-center bg-transparent quantity-selector">
          <button class="add-to-cart bg-white text-black px-4 py-2 rounded">Add</button>
        </div>
      </div>

      <div class="product-card bg-white/10 p-6 rounded-xl shadow-md text-center backdrop-blur">
        <img src="http://static.photos/textures/1024x576/2" class="w-full h-64 object-cover rounded mb-4" alt="Black Hoodie">
        <h3 class="text-xl font-bold mb-2">SEP Black Hoodie</h3>
        <p class="mb-2">180 kr.</p>
        <select class="theme-text border rounded px-3 py-2 mb-2 bg-transparent">
          <option>XS</option><option>S</option><option>M</option><option>L</option><option>XL</option>
        </select>
        <div class="flex justify-center gap-2">
          <input type="number" min="1" value="1" class="theme-text border rounded w-16 text-center bg-transparent quantity-selector">
          <button class="add-to-cart bg-white text-black px-4 py-2 rounded">Add</button>
        </div>
      </div>

      <div class="product-card bg-white/10 p-6 rounded-xl shadow-md text-center backdrop-blur">
        <img src="http://static.photos/textures/1024x576/3" class="w-full h-64 object-cover rounded mb-4" alt="Black Trousers">
        <h3 class="text-xl font-bold mb-2">SEP Black Trousers</h3>
        <p class="mb-2">180 kr.</p>
        <select class="theme-text border rounded px-3 py-2 mb-2 bg-transparent">
          <option>XS</option><option>S</option><option>M</option><option>L</option><option>XL</option>
        </select>
        <div class="flex justify-center gap-2">
          <input type="number" min="1" value="1" class="theme-text border rounded w-16 text-center bg-transparent quantity-selector">
          <button class="add-to-cart bg-white text-black px-4 py-2 rounded">Add</button>
        </div>
      </div>
    </div>
  </section>

  <!-- Cart sidebar -->
  <div id="cartSidebar" class="fixed top-0 right-0 h-full w-80 bg-white shadow-xl translate-x-full transition-transform duration-300 z-50 overflow-y-auto">
    <div class="p-6">
      <div class="flex justify-between items-center mb-4">
        <h3 class="text-xl font-bold">Your Cart</h3>
        <button id="closeCart">✕</button>
      </div>

      <!-- Shipping choice -->
      <div class="mb-4 text-sm">
        <p class="mb-1 font-medium">Shipping destination</p>
        <div class="flex gap-2 text-xs">
          <button id="shippingCph" class="px-3 py-1 rounded-full border border-gray-400 bg-gray-200">Copenhagen</button>
          <button id="shippingNonCph" class="px-3 py-1 rounded-full border border-gray-400 bg-transparent">Rest of Denmark</button>
        </div>
        <p class="mt-1 text-gray-500 text-xs">
          Copenhagen = free shipping. Rest of Denmark = +45 kr.
        </p>
      </div>

      <div id="cartItems" class="space-y-4 text-sm"></div>
      <div class="border-t border-gray-300 pt-4 mt-4 text-sm">
        <div class="flex justify-between mb-1">
          <span>Subtotal:</span><span id="cartSubtotal" class="font-bold">0 kr.</span>
        </div>
        <div class="flex justify-between mb-2 text-xs text-gray-600">
          <span>Shipping:</span><span id="cartShippingLabel">+45 kr.</span>
        </div>
        <div class="flex justify-between font-semibold border-t border-gray-300 pt-2 mb-3">
          <span>Total:</span><span id="cartTotal">45 kr.</span>
        </div>
        <button id="openMobilePay" class="w-full bg-green-500 text-white py-2 rounded mb-2">Open MobilePay</button>
        <p class="text-xs text-gray-500 mb-2 text-center">“Open MobilePay” is only a real link on mobile.</p>
        <button id="copyMobilePay" class="w-full bg-gray-200 py-2 rounded">Copy Order Message</button>
      </div>
    </div>
  </div>
  <div id="cartOverlay" class="fixed inset-0 bg-black/50 hidden z-40"></div>

  <section class="py-20 text-center fade-section">
    <h2 class="text-3xl font-bold mb-10">How to Order</h2>
    <div class="grid grid-cols-1 md:grid-cols-5 gap-6 max-w-6xl mx-auto text-sm md:text-base">
      <div class="bg-white/10 rounded-xl p-6 backdrop-blur">
        <h3 class="font-bold text-lg mb-2">1. Choose</h3>
        <p>Select your favourite SEP piece: T-shirt, Hoodie or Trousers. Then pick your size and quantity.</p>
      </div>
      <div class="bg-white/10 rounded-xl p-6 backdrop-blur">
        <h3 class="font-bold text-lg mb-2">2. Add to Cart</h3>
        <p>Click “Add” to add your chosen items to your cart. When ready, click “View Cart” to review your order.</p>
      </div>
      <div class="bg-white/10 rounded-xl p-6 backdrop-blur">
        <h3 class="font-bold text-lg mb-2">3. Copy Order Message</h3>
        <p>Inside your cart, press “Copy Order Message”. This copies your full order, including shipping, automatically.</p>
      </div>
      <div class="bg-white/10 rounded-xl p-6 backdrop-blur">
        <h3 class="font-bold text-lg mb-2">4. Pay with MobilePay</h3>
        <p>Send the total amount (incl. +45 kr. shipping, unless in Copenhagen) to <b>5894BZ</b> using MobilePay.<br><span class="text-xs italic">“Open MobilePay” works only on mobile devices.</span></p>
      </div>
      <div class="bg-white/10 rounded-xl p-6 backdrop-blur">
        <h3 class="font-bold text-lg mb-2">5. Send us your order</h3>
        <p>DM your copied message to <b>@seproairesis</b> (Instagram or TikTok).<br>We currently deliver only within Denmark.</p>
      </div>
    </div>
  </section>

  <footer class="text-center py-10 fade-section text-sm">
    <p>© 2025 SEP – Se Proairesis (ancient Greek for “Your Choice”) • MobilePay 5894BZ • +45 kr. Shipping (FREE in Copenhagen) • Made in Copenhagen. Delivered only across Denmark.</p>
    <p class="mt-2 text-xs text-gray-400">
      No data selling. No ads following you around. Just simple, intentional clothing.
    </p>
    <div class="flex justify-center gap-4 mt-4">
      <a href="https://instagram.com/seproairesis" class="bg-gradient-to-br from-pink-500 to-purple-600 text-white p-3 rounded-full">IG</a>
      <a href="https://tiktok.com/@seproairesis" class="bg-black text-white p-3 rounded-full">TT</a>
    </div>
  </footer>
</section>
<!-- ================= END SCENE: SEP SHOP ================= -->


<!-- ===================== SCENE: ABOUT SEP ===================== -->
<section id="scene-sep-about" class="scene">
  <div class="min-h-screen bg-black text-white flex items-center justify-center px-6 py-16">
    <div class="max-w-3xl mx-auto space-y-6 text-sm md:text-base">
      <h2 class="text-3xl font-bold tracking-wide">About SEP</h2>
      <p class="text-gray-300">
        SEP stands for <span class="italic">Se Proairesis</span>. It is an ancient Greek phrase that roughly means “Your Choice”.
        The brand is built around that idea: you choose how simple, intentional and calm your wardrobe can be.
      </p>
      <p class="text-gray-300">
        The clothes are minimalist on purpose. A white T-shirt, a black hoodie and black trousers that feel good to wear
        and work with almost anything. Everything is hand-pressed in Copenhagen in small batches.
      </p>
      <p class="text-gray-300">
        There are no big collections and no constant drops. You pick your size and quantity, copy your order message,
        send it, and that’s it.
      </p>
      <p class="text-gray-400 text-xs">
        There are also no hidden tricks behind SEP. No data selling. No tracking across the internet. No ads chasing you.
        Just a simple site that helps you get the pieces you want.
      </p>
      <div class="flex flex-wrap gap-3 text-xs md:text-sm mt-4">
        <button class="px-4 py-2 rounded-full border border-white/20" onclick="showScene('sep-shop')">
          Back to SEP shop
        </button>
        <button class="px-4 py-2 rounded-full border border-white/20" onclick="showScene('mih-welcome')">
          Go to Make it happen
        </button>
      </div>
    </div>
  </div>
</section>
<!-- ================= END SCENE: ABOUT SEP ================= -->


<!-- ===================== SCENE: MIH WELCOME ===================== -->
<section id="scene-mih-welcome" class="scene">
  <div class="min-h-screen bg-black text-white pt-16 pb-20 px-4 md:px-6">
    <div class="max-w-5xl mx-auto mb-8 flex flex-col md:flex-row md:items-center md:justify-between gap-4">
      <div>
        <div class="text-[10px] tracking-[0.5em] uppercase text-gray-400 mb-1">MAKE IT</div>
        <div class="text-2xl md:text-3xl font-semibold tracking-[0.5em] uppercase">SEP</div>
        <div class="text-[10px] tracking-[0.5em] uppercase text-gray-400 mt-1">HAPPEN</div>
      </div>
      <div class="flex flex-wrap gap-2 text-xs md:text-sm">
        <button class="px-3 py-1 rounded-full border border-white/20 text-gray-300" onclick="showScene('mih-login')">Login</button>
        <button class="px-3 py-1 rounded-full border border-white/20 text-gray-300" onclick="showScene('mih-welcome')">Welcome</button>
        <button class="px-3 py-1 rounded-full border border-white/20 text-gray-300" onclick="showScene('mih-leaderboard')">Leaderboard</button>
        <button class="px-3 py-1 rounded-full border border-white/20 text-gray-300" onclick="showScene('mih-stats')">Stats</button>
        <button class="px-3 py-1 rounded-full border border-white/20 text-gray-300" onclick="showScene('mih-about')">About</button>
      </div>
      <div class="flex flex-col items-end gap-2 text-[11px] text-gray-400 min-w-[160px]">
        <button type="button"
                class="px-3 py-1 rounded-full border border-white/25 text-[11px] text-gray-200"
                onclick="showScene('sep-shop')">
          Back to SEP
        </button>
      </div>
    </div>

    <main class="max-w-5xl mx-auto">
      <div class="mih-card p-6 md:p-8 space-y-4 text-sm md:text-base">
        <div>
          <h1 class="text-2xl md:text-3xl font-semibold mb-2">Move more. Compete. Make it happen.</h1>
          <p class="text-gray-300">
            Run, walk or cycle, log your distance, and slowly climb the leaderboard in your own league.
          </p>
        </div>
        <div class="flex flex-wrap gap-3 text-xs md:text-sm">
          <button class="px-5 py-2 rounded-full bg-white text-black"
                  onclick="showScene('mih-leaderboard')">
            See leaderboard →
          </button>
          <button class="px-5 py-2 rounded-full border border-white/20 text-gray-200"
                  onclick="showScene('mih-about')">
            What is this?
          </button>
        </div>
        <div class="flex flex-wrap gap-2 text-[11px] text-gray-300 mt-2">
          <span class="px-3 py-1 rounded-full border border-white/10 bg-white/5">4 leagues: Amateurs, Intermediates, Pros, Legends</span>
          <span class="px-3 py-1 rounded-full border border-white/10 bg-white/5">New people are placed where leagues are lightest</span>
          <span class="px-3 py-1 rounded-full border border-white/10 bg-white/5">Ranking rewards distance, commitment and improvement</span>
        </div>
      </div>
    </main>
  </div>
</section>
<!-- ================= END SCENE: MIH WELCOME ===================== -->


<!-- ===================== SCENE: MIH LOGIN ===================== -->
<section id="scene-mih-login" class="scene">
  <div class="min-h-screen bg-black text-white pt-16 pb-20 px-4 md:px-6">
    <div class="max-w-5xl mx-auto mb-8 flex flex-col md:flex-row md:items-center md:justify-between gap-4">
      <div>
        <div class="text-[10px] tracking-[0.5em] uppercase text-gray-400 mb-1">MAKE IT</div>
        <div class="text-2xl md:text-3xl font-semibold tracking-[0.5em] uppercase">SEP</div>
        <div class="text-[10px] tracking-[0.5em] uppercase text-gray-400 mt-1">HAPPEN</div>
      </div>
      <div class="flex flex-wrap gap-2 text-xs md:text-sm">
        <button class="px-3 py-1 rounded-full border border-white/20 text-gray-300" onclick="showScene('mih-login')">Login</button>
        <button class="px-3 py-1 rounded-full border border-white/20 text-gray-300" onclick="showScene('mih-welcome')">Welcome</button>
        <button class="px-3 py-1 rounded-full border border-white/20 text-gray-300" onclick="showScene('mih-leaderboard')">Leaderboard</button>
        <button class="px-3 py-1 rounded-full border border-white/20 text-gray-300" onclick="showScene('mih-stats')">Stats</button>
        <button class="px-3 py-1 rounded-full border border-white/20 text-gray-300" onclick="showScene('mih-about')">About</button>
      </div>
      <div class="flex flex-col items-end gap-2 text-[11px] text-gray-400 min-w-[160px]">
        <button type="button"
                class="px-3 py-1 rounded-full border border-white/25 text-[11px] text-gray-200"
                onclick="showScene('sep-shop')">
          Back to SEP
        </button>
      </div>
    </div>

    <main class="max-w-5xl mx-auto">
      <div class="mih-card p-6 md:p-8 text-sm md:text-base">
        <h1 class="text-2xl md:text-3xl font-semibold mb-2">Log in to make it happen</h1>
        <p class="text-gray-300 mb-4">
          Create a simple account so the site knows who you are and only you can manage your activities.
        </p>
        <form id="login-form" class="space-y-3 mt-2">
          <div>
            <label for="login-name" class="block text-xs text-gray-400 mb-1">Name</label>
            <input id="login-name" type="text" placeholder="e.g. Daniel"
              class="w-full px-3 py-2 rounded-full bg-black/40 border border-white/15 text-sm" required />
          </div>
          <div>
            <label for="login-password" class="block text-xs text-gray-400 mb-1">Password</label>
            <input id="login-password" type="password" placeholder="Choose something simple"
              class="w-full px-3 py-2 rounded-full bg-black/40 border border-white/15 text-sm" required />
          </div>
          <button type="submit" class="px-5 py-2 rounded-full bg-white text-black text-xs md:text-sm mt-1">
            Log in / Create account
          </button>
          <p class="text-[11px] text-gray-400 mt-2">
            If this is your first time with this name, we’ll create a new account and place you into a league.
          </p>
        </form>
        <p class="text-[11px] text-gray-500 mt-4">
          Your login is saved on this browser. Accounts logged out for more than 30 days are deleted, together with their activities.
        </p>
      </div>
    </main>
  </div>
</section>
<!-- ================= END SCENE: MIH LOGIN ===================== -->


<!-- ===================== SCENE: MIH LEADERBOARD ===================== -->
<section id="scene-mih-leaderboard" class="scene">
  <div class="min-h-screen bg-black text-white pt-16 pb-20 px-4 md:px-6">
    <div class="max-w-5xl mx-auto mb-8 flex flex-col md:flex-row md:items-center md:justify-between gap-4">
      <div>
        <div class="text-[10px] tracking-[0.5em] uppercase text-gray-400 mb-1">MAKE IT</div>
        <div class="text-2xl md:text-3xl font-semibold tracking-[0.5em] uppercase">SEP</div>
        <div class="text-[10px] tracking-[0.5em] uppercase text-gray-400 mt-1">HAPPEN</div>
      </div>
      <div class="flex flex-wrap gap-2 text-xs md:text-sm">
        <button class="px-3 py-1 rounded-full border border-white/20 text-gray-300" onclick="showScene('mih-login')">Login</button>
        <button class="px-3 py-1 rounded-full border border-white/20 text-gray-300" onclick="showScene('mih-welcome')">Welcome</button>
        <button class="px-3 py-1 rounded-full border border-white/20 text-gray-300" onclick="showScene('mih-leaderboard')">Leaderboard</button>
        <button class="px-3 py-1 rounded-full border border-white/20 text-gray-300" onclick="showScene('mih-stats')">Stats</button>
        <button class="px-3 py-1 rounded-full border border-white/20 text-gray-300" onclick="showScene('mih-about')">About</button>
      </div>
      <div class="flex flex-col items-end gap-2 text-[11px] text-gray-400 min-w-[160px]">
        <div id="user-controls" class="flex flex-wrap gap-2 justify-end">
          <!-- Filled by JS -->
        </div>
        <button type="button"
                class="px-3 py-1 rounded-full border border-white/25 text-[11px] text-gray-200"
                onclick="showScene('sep-shop')">
          Back to SEP
        </button>
      </div>
    </div>

    <main class="max-w-5xl mx-auto space-y-6 text-sm md:text-base">
      <div class="mih-card p-6 md:p-8">
        <div class="grid md:grid-cols-2 gap-6">
          <div>
            <h2 class="text-xl font-semibold mb-2">Add your latest activity</h2>
            <p class="text-sm text-gray-300 mb-3">
              Log any run, walk or ride. Use kilometres and minutes so the leaderboard stays fair for everyone.
            </p>
            <form id="entry-form" class="space-y-3">
              <div>
                <label for="name" class="block text-xs text-gray-400 mb-1">Your name</label>
                <input id="name" type="text" disabled placeholder="Log in to set your name"
                  class="w-full px-3 py-2 rounded-full bg-black/40 border border-white/15 text-sm" />
                <p class="text-[11px] text-gray-500 mt-1">
                  Name comes from your account. You cannot change it here.
                </p>
              </div>
              <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                <div>
                  <label for="distance" class="block text-xs text-gray-400 mb-1">Distance (km)</label>
                  <input id="distance" type="number" step="0.1" min="0" placeholder="e.g. 5"
                    class="w-full px-3 py-2 rounded-full bg-black/40 border border-white/15 text-sm" required />
                </div>
                <div>
                  <label for="time" class="block text-xs text-gray-400 mb-1">Time (minutes)</label>
                  <input id="time" type="number" step="0.1" min="0" placeholder="e.g. 28"
                    class="w-full px-3 py-2 rounded-full bg-black/40 border border-white/15 text-sm" required />
                </div>
              </div>
              <button type="submit" class="px-5 py-2 rounded-full bg-white text-black text-xs md:text-sm">
                Save my activity
              </button>
              <p class="text-[11px] text-gray-400 mt-2">
                Leagues have unlimited spaces. New accounts are spread so the numbers stay balanced.
              </p>
            </form>
          </div>

          <div>
            <h3 class="text-lg font-semibold mb-2">How ranking works</h3>
            <p class="text-sm text-gray-300">
              The leaderboard gives credit for:
            </p>
            <ul class="text-sm text-gray-300 list-disc list-inside mt-2 space-y-1">
              <li><strong>Total distance</strong> – the more you move, the higher you go.</li>
              <li><strong>Commitment over time</strong> – more sessions and more weeks logged is a good thing.</li>
              <li><strong>Speed</strong> – faster pace helps, but it is not the only thing that matters.</li>
            </ul>
            <p class="text-xs text-gray-400 mt-3">
              This way someone who is older, heavier or slower but shows up again and again can still climb.
            </p>
          </div>
        </div>
      </div>

      <div class="mih-card p-6 md:p-8">
        <div class="flex flex-wrap items-center justify-between gap-3 mb-3">
          <h2 class="text-xl font-semibold">Live leaderboard</h2>
          <div class="flex items-center gap-2 text-xs text-gray-300">
            <span>League:</span>
            <select id="league-filter"
                    class="px-3 py-1 rounded-full bg-black/40 border border-white/20 text-xs"
                    onchange="renderLeaderboard()">
              <option value="all">All leagues</option>
              <option value="amateurs">Amateurs</option>
              <option value="intermediates">Intermediates</option>
              <option value="pros">Pros</option>
              <option value="legends">Legends</option>
            </select>
          </div>
        </div>
        <div class="overflow-x-auto text-xs md:text-sm">
          <table class="w-full border-collapse min-w-full">
            <thead class="text-gray-400 text-[11px] uppercase tracking-wide border-b border-white/10">
              <tr>
                <th class="py-2 pr-2 text-left">#</th>
                <th class="py-2 px-2 text-left">Participant</th>
                <th class="py-2 px-2 text-left">League</th>
                <th class="py-2 px-2 text-left">Total distance</th>
                <th class="py-2 px-2 text-left">Total time</th>
              </tr>
            </thead>
            <tbody id="leaderboard-body"></tbody>
          </table>
        </div>
        <div id="no-entries" class="text-xs text-gray-400 mt-3">
          No activities yet. Be the first to log a run and grab the number one spot.
        </div>
      </div>

      <div class="mih-card p-6 md:p-8">
        <h3 class="text-lg font-semibold mb-2">My activities</h3>
        <p class="text-xs text-gray-400 mb-3">
          Only the activities from the account you are logged in with are shown here. You can delete them if you make a mistake.
        </p>
        <div class="overflow-x-auto text-xs md:text-sm">
          <table class="w-full border-collapse min-w-full">
            <thead class="text-gray-400 text-[11px] uppercase tracking-wide border-b border-white/10">
              <tr>
                <th class="py-2 pr-2 text-left">Date</th>
                <th class="py-2 px-2 text-left">Distance</th>
                <th class="py-2 px-2 text-left">Time</th>
                <th class="py-2 px-2 text-left"></th>
              </tr>
            </thead>
            <tbody id="my-activities-body"></tbody>
          </table>
        </div>
        <div id="no-my-activities" class="text-xs text-gray-400 mt-3">
          No activities yet for this account.
        </div>
      </div>
    </main>
  </div>
</section>
<!-- ================= END SCENE: MIH LEADERBOARD ===================== -->


<!-- ===================== SCENE: MIH STATS ===================== -->
<section id="scene-mih-stats" class="scene">
  <div class="min-h-screen bg-black text-white pt-16 pb-20 px-4 md:px-6">
    <div class="max-w-5xl mx-auto mb-8 flex flex-col md:flex-row md:items-center md:justify-between gap-4">
      <div>
        <div class="text-[10px] tracking-[0.5em] uppercase text-gray-400 mb-1">MAKE IT</div>
        <div class="text-2xl md:text-3xl font-semibold tracking-[0.5em] uppercase">SEP</div>
        <div class="text-[10px] tracking-[0.5em] uppercase text-gray-400 mt-1">HAPPEN</div>
      </div>
      <div class="flex flex-wrap gap-2 text-xs md:text-sm">
        <button class="px-3 py-1 rounded-full border border-white/20 text-gray-300" onclick="showScene('mih-login')">Login</button>
        <button class="px-3 py-1 rounded-full border border-white/20 text-gray-300" onclick="showScene('mih-welcome')">Welcome</button>
        <button class="px-3 py-1 rounded-full border border-white/20 text-gray-300" onclick="showScene('mih-leaderboard')">Leaderboard</button>
        <button class="px-3 py-1 rounded-full border border-white/20 text-gray-300" onclick="showScene('mih-stats')">Stats</button>
        <button class="px-3 py-1 rounded-full border border-white/20 text-gray-300" onclick="showScene('mih-about')">About</button>
      </div>
      <div class="flex flex-col items-end gap-2 text-[11px] text-gray-400 min-w-[160px]">
        <button type="button"
                class="px-3 py-1 rounded-full border border-white/25 text-[11px] text-gray-200"
                onclick="showScene('sep-shop')">
          Back to SEP
        </button>
      </div>
    </div>

    <main class="max-w-5xl mx-auto">
      <div class="mih-card p-6 md:p-8">
        <div class="flex justify-between items-center mb-3">
          <h2 class="text-xl font-semibold">Player stats</h2>
        </div>
        <p class="text-sm text-gray-300 mb-3">
          Every activity builds your personal stats. Improvement is based on both distance and time. If you run the same
          distance faster next time, that also counts as progress.
        </p>
        <div class="overflow-x-auto text-xs md:text-sm">
          <table class="w-full border-collapse min-w-full">
            <thead class="text-gray-400 text-[11px] uppercase tracking-wide border-b border-white/10">
              <tr>
                <th class="py-2 px-2 text-left">Participant</th>
                <th class="py-2 px-2 text-left">League</th>
                <th class="py-2 px-2 text-left">Runs</th>
                <th class="py-2 px-2 text-left">Total distance</th>
                <th class="py-2 px-2 text-left">Total time</th>
                <th class="py-2 px-2 text-left">Avg distance</th>
                <th class="py-2 px-2 text-left">Best distance</th>
                <th class="py-2 px-2 text-left">Improvement</th>
              </tr>
            </thead>
            <tbody id="stats-body"></tbody>
          </table>
        </div>
        <div id="no-stats" class="text-xs text-gray-400 mt-3">
          Stats will appear as soon as people start logging their activities.
        </div>
      </div>
    </main>
  </div>
</section>
<!-- ================= END SCENE: MIH STATS ===================== -->


<!-- ===================== SCENE: MIH PROFILE ===================== -->
<section id="scene-mih-profile" class="scene">
  <div class="min-h-screen bg-black text-white pt-16 pb-20 px-4 md:px-6">
    <div class="max-w-3xl mx-auto space-y-6">
      <div class="flex items-center justify-between">
        <div>
          <h2 class="text-2xl font-semibold" id="profileName">Runner profile</h2>
          <p class="text-xs text-gray-400" id="profileLeague"></p>
        </div>
        <button class="px-3 py-1 rounded-full border border-white/25 text-[11px]" onclick="showScene('mih-leaderboard')">
          Back to leaderboard
        </button>
      </div>

      <div class="mih-card p-6 space-y-4 text-sm">
        <div class="grid grid-cols-2 gap-4">
          <div>
            <div class="profile-label">Total distance</div>
            <div class="profile-value" id="profileTotalDistance">–</div>
          </div>
          <div>
            <div class="profile-label">Total time</div>
            <div class="profile-value" id="profileTotalTime">–</div>
          </div>
          <div>
            <div class="profile-label">Runs logged</div>
            <div class="profile-value" id="profileRuns">–</div>
          </div>
          <div>
            <div class="profile-label">Average distance</div>
            <div class="profile-value" id="profileAvgDistance">–</div>
          </div>
        </div>

        <hr class="border-white/10 my-4">

        <h3 class="text-lg font-semibold mb-1">Estimated best times</h3>
        <p class="text-xs text-gray-400 mb-3">
          Based on the pace from your logged runs.
        </p>
        <div class="grid grid-cols-3 gap-4 text-sm">
          <div>
            <div class="profile-label">5 km</div>
            <div class="profile-value" id="profileBest5k">–</div>
          </div>
          <div>
            <div class="profile-label">10 km</div>
            <div class="profile-value" id="profileBest10k">–</div>
          </div>
          <div>
            <div class="profile-label">100 m</div>
            <div class="profile-value" id="profileBest100m">–</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- ================= END SCENE: MIH PROFILE ===================== -->


<!-- ===================== SCENE: MIH ABOUT ===================== -->
<section id="scene-mih-about" class="scene">
  <div class="min-h-screen bg-black text-white pt-16 pb-20 px-4 md:px-6">
    <div class="max-w-5xl mx-auto mb-8 flex flex-col md:flex-row md:items-center md:justify-between gap-4">
      <div>
        <div class="text-[10px] tracking-[0.5em] uppercase text-gray-400 mb-1">MAKE IT</div>
        <div class="text-2xl md:text-3xl font-semibold tracking-[0.5em] uppercase">SEP</div>
        <div class="text-[10px] tracking-[0.5em] uppercase text-gray-400 mt-1">HAPPEN</div>
      </div>
      <div class="flex flex-wrap gap-2 text-xs md:text-sm">
        <button class="px-3 py-1 rounded-full border border-white/20 text-gray-300" onclick="showScene('mih-login')">Login</button>
        <button class="px-3 py-1 rounded-full border border-white/20 text-gray-300" onclick="showScene('mih-welcome')">Welcome</button>
        <button class="px-3 py-1 rounded-full border border-white/20 text-gray-300" onclick="showScene('mih-leaderboard')">Leaderboard</button>
        <button class="px-3 py-1 rounded-full border border-white/20 text-gray-300" onclick="showScene('mih-stats')">Stats</button>
        <button class="px-3 py-1 rounded-full border border-white/20 text-gray-300" onclick="showScene('mih-about')">About</button>
      </div>
      <div class="flex flex-col items-end gap-2 text-[11px] text-gray-400 min-w-[160px]">
        <button type="button"
                class="px-3 py-1 rounded-full border border-white/25 text-[11px] text-gray-200"
                onclick="showScene('sep-shop')">
          Back to SEP
        </button>
      </div>
    </div>

    <main class="max-w-5xl mx-auto">
      <div class="mih-card p-6 md:p-8 space-y-4 text-sm md:text-base text-gray-200">
        <h2 class="text-xl font-semibold mb-2">About Make it happen</h2>
        <p>
          Make it happen is a simple health challenge for anyone who wants to move a bit more, without paying for apps,
          subscriptions or fancy gear. You log what you do and see where you land in your league.
        </p>
        <p>
          It is not about being the fastest in the world. It is about small sessions adding up over weeks and months.
          Older runners, heavier runners, busy parents and complete beginners can all take part and see progress.
        </p>
        <p class="font-semibold">It is built to be:</p>
        <ul class="list-disc list-inside space-y-1">
          <li><strong>Healthy</strong> – even short walks and slow runs help your heart, sleep and energy.</li>
          <li><strong>Free</strong> – no paid tiers, no premium version, no “unlock more stats” button.</li>
          <li><strong>Fun</strong> – friendly leagues, gentle competition and visible progress instead of pressure.</li>
        </ul>
        <p class="text-sm text-gray-300">
          Behind the scenes, it is intentionally boring in a good way. Your data stays in your browser storage. There
          is no data selling, no ad network and no dark patterns trying to keep you here for hours.
        </p>
        <div class="flex flex-wrap gap-3 text-xs md:text-sm mt-2">
          <button class="px-4 py-2 rounded-full border border-white/20" onclick="showScene('mih-leaderboard')">
            Go to leaderboard
          </button>
          <button class="px-4 py-2 rounded-full border border-white/20" onclick="showScene('sep-shop')">
            Back to SEP
          </button>
        </div>
      </div>
    </main>
  </div>
</section>
<!-- ================= END SCENE: MIH ABOUT ===================== -->


<!-- ========== JS: NAV, CART, SCENES, MIH LOGIC ========== -->
<script>
/* Global nav hamburger */
const navToggleBtn = document.getElementById('mainNavToggle');
const navMenu = document.getElementById('navMenu');

navToggleBtn.addEventListener('click', () => {
  navMenu.classList.toggle('show');
});

/* Scene handling */
function showScene(name){
  document.querySelectorAll('.scene').forEach(s=>s.classList.remove('active'));
  const target=document.getElementById('scene-'+name);
  if(target) target.classList.add('active');
  window.scrollTo({top:0,left:0,behavior:'instant'});
}

/* SEP cart logic */
let cart = JSON.parse(localStorage.getItem('cart')) || [];
const cartSidebar = document.getElementById('cartSidebar');
const cartOverlay = document.getElementById('cartOverlay');
const SHIPPING_BASE = 45;
let isCopenhagen = false;

const globalNav = document.getElementById('globalNavButtons');
const sepHeroButtons = document.getElementById('sepHeroButtons');

function setShippingButtons(){
  const btnCph = document.getElementById('shippingCph');
  const btnNon = document.getElementById('shippingNonCph');
  if (isCopenhagen) {
    btnCph.classList.add('bg-gray-200');
    btnNon.classList.remove('bg-gray-200');
    btnNon.classList.add('bg-transparent');
  } else {
    btnCph.classList.remove('bg-gray-200');
    btnNon.classList.add('bg-gray-200');
  }
}

function currentShippingCost(){
  return isCopenhagen ? 0 : SHIPPING_BASE;
}

function updateCart(){
  const items=document.getElementById('cartItems');
  const subtotal=document.getElementById('cartSubtotal');
  const total=document.getElementById('cartTotal');
  const shippingLabel=document.getElementById('cartShippingLabel');
  items.innerHTML=''; let sum=0;
  if(cart.length===0){
    items.innerHTML='<p class="text-center text-gray-500 py-10">Cart is empty</p>';
    subtotal.textContent='0 kr.';
  }else{
    cart.forEach((it,i)=>{
      const price=parseInt(it.price.replace(/\D/g,''))*it.qty; sum+=price;
      items.innerHTML+=`
        <div class="border-b pb-2">
          <div class="flex justify-between"><span>${it.name}</span><span>${price} kr.</span></div>
          <div class="text-gray-500 text-xs">Size: ${it.size} | Qty: ${it.qty}</div>
          <button onclick="removeFromCart(${i})" class="text-red-500 text-xs mt-1">Remove</button>
        </div>`;
    });
    subtotal.textContent=sum+' kr.';
  }
  const ship = currentShippingCost();
  shippingLabel.textContent = ship === 0 ? '0 kr. (FREE in Copenhagen)' : `+${ship} kr.`;
  total.textContent=(sum+ship)+' kr.';
  localStorage.setItem('cart',JSON.stringify(cart));
  updateCounter();
}
function addToCart(n,p,s,q){
  if (q <= 0 || !Number.isFinite(q)) return;
  const f=cart.findIndex(i=>i.name===n&&i.size===s);
  if(f>=0) cart[f].qty+=q; else cart.push({name:n,price:p,size:s,qty:q});
  updateCart();
  const popup=document.createElement('div'); popup.className='popup'; popup.textContent='Added to cart';
  document.body.appendChild(popup);
  setTimeout(()=>popup.classList.add('show'),10);
  setTimeout(()=>{popup.classList.remove('show'); setTimeout(()=>popup.remove(),300);},2000);
}
function removeFromCart(i){cart.splice(i,1);updateCart();}
function updateCounter(){
  const c=document.getElementById('cartCounter');
  const t=cart.reduce((s,i)=>s+i.qty,0);
  if(t>0){c.textContent=t; c.classList.remove('hidden');}
  else c.classList.add('hidden');
}
document.querySelectorAll('.add-to-cart').forEach(b=>{
  b.onclick=()=>{
    const card=b.closest('.product-card');
    const name=card.querySelector('h3').textContent;
    const price=card.querySelector('p').textContent;
    const size=card.querySelector('select').value;
    const qty=parseInt(card.querySelector('.quantity-selector').value,10);
    addToCart(name,price,size,qty);
  };
});

if (document.getElementById('viewCartBtn')) {
  document.getElementById('viewCartBtn').onclick=()=>{
    cartSidebar.classList.remove('translate-x-full');
    cartOverlay.classList.remove('hidden');
    if (globalNav) globalNav.style.opacity = '0';
    if (sepHeroButtons) sepHeroButtons.style.opacity = '0';
  };
}
document.getElementById('closeCart').onclick=closeCart;
cartOverlay.onclick=closeCart;
function closeCart(){
  cartSidebar.classList.add('translate-x-full');
  cartOverlay.classList.add('hidden');
  if (globalNav) globalNav.style.opacity = '1';
  if (sepHeroButtons) sepHeroButtons.style.opacity = '1';
}
updateCart();

/* Shipping toggles */
document.getElementById('shippingCph').onclick = () => {
  isCopenhagen = true;
  setShippingButtons();
  updateCart();
};
document.getElementById('shippingNonCph').onclick = () => {
  isCopenhagen = false;
  setShippingButtons();
  updateCart();
};
setShippingButtons();

/* MobilePay */
const mobilePayNum='5894BZ';
document.getElementById('openMobilePay').onclick=()=>{
  window.location.href='mobilepay://transfer?phone='+mobilePayNum.replace(/\D/g,'');
  alert('Thanks for supporting SEP!');
};
document.getElementById('copyMobilePay').onclick=()=>{
  const subtotal=document.getElementById('cartSubtotal').textContent;
  const total=document.getElementById('cartTotal').textContent;
  const msg=`Hi SEP, here’s my order:
${cart.map(i=>`${i.qty}× ${i.name} (Size: ${i.size})`).join('\n')}
Subtotal: ${subtotal}
Shipping: ${document.getElementById('cartShippingLabel').textContent}
Total: ${total}`;
  navigator.clipboard.writeText(msg);
  const popup=document.createElement('div');
  popup.className='popup';
  popup.textContent='Order message copied!';
  document.body.appendChild(popup);
  setTimeout(()=>popup.classList.add('show'),10);
  setTimeout(()=>{popup.classList.remove('show');setTimeout(()=>popup.remove(),300);},2000);
};

/* MAKE IT HAPPEN data / logic */
const STORAGE_KEY_ENTRIES = "mih_entries_v5";
const STORAGE_KEY_USERS = "mih_users_v5";
const STORAGE_KEY_CURRENT_USER = "mih_current_user_v5";
const THIRTY_DAYS_MS = 30 * 24 * 60 * 60 * 1000;
const LEAGUES = ["amateurs","intermediates","pros","legends"];

let entries = [];
let users = [];
let currentUser = null;

function generateId(){return Date.now().toString(36)+Math.random().toString(36).slice(2,8);}
function saveEntries(){localStorage.setItem(STORAGE_KEY_ENTRIES,JSON.stringify(entries));}
function saveUsers(){localStorage.setItem(STORAGE_KEY_USERS,JSON.stringify(users));}
function loadEntries(){
  const saved=localStorage.getItem(STORAGE_KEY_ENTRIES);
  if(saved){try{entries=JSON.parse(saved)||[];}catch(e){entries=[];}}else{entries=[];}
}
function loadUsers(){
  const saved=localStorage.getItem(STORAGE_KEY_USERS);
  if(saved){try{users=JSON.parse(saved)||[];}catch(e){users=[];}}else{users=[];}
  users.forEach(u=>{if(!u.league||!LEAGUES.includes(u.league)){u.league="amateurs";}});
  saveUsers();
}
function getUserById(id){return users.find(u=>u.id===id)||null;}
function getUserByName(name){return users.find(u=>u.name.toLowerCase()===name.toLowerCase())||null;}
function leagueIndex(league){return LEAGUES.indexOf(league);}
function assignStartingLeague(){
  const counts={amateurs:0,intermediates:0,pros:0,legends:0};
  users.forEach(u=>{if(u.league&&counts.hasOwnProperty(u.league)){counts[u.league]++;}});
  const values=Object.values(counts);
  const minCount=Math.min(...values);
  const candidate=LEAGUES.filter(l=>counts[l]===minCount);
  return candidate[0]||"amateurs";
}
function cleanupOldAccounts(){
  const now=Date.now();
  const currentUserId=localStorage.getItem(STORAGE_KEY_CURRENT_USER);
  const keptUsers=[];
  const removedIds=new Set();
  users.forEach(user=>{
    const isCurrent=currentUserId&&user.id===currentUserId;
    if(!user.lastLogoutAt||isCurrent){
      keptUsers.push(user);return;
    }
    const delta=now-user.lastLogoutAt;
    if(delta>THIRTY_DAYS_MS){removedIds.add(user.id);}
    else{keptUsers.push(user);}
  });
  users=keptUsers;
  if(removedIds.size>0){
    entries=entries.filter(e=>!removedIds.has(e.userId));
  }
  saveUsers();saveEntries();
}
function formatDate(ts){
  const d=new Date(ts);
  if(isNaN(d.getTime()))return "";
  return d.toLocaleDateString(undefined,{year:"numeric",month:"short",day:"numeric"});
}
function formatMinutes(mins){
  if(!isFinite(mins)||mins<=0)return "–";
  const totalSeconds=Math.round(mins*60);
  const m=Math.floor(totalSeconds/60);
  const s=totalSeconds%60;
  return `${m}:${s.toString().padStart(2,"0")}`;
}
function formatImprovement(value){
  if(!isFinite(value)||value===0)return "0%";
  const r=Math.round(value);
  return (r>0?"+":"")+r+"%";
}

/* Compute stats per user */
function getPlayerStats(){
  const byUser={};
  users.forEach(user=>{
    byUser[user.id]={
      userId:user.id,
      name:user.name,
      league:user.league||"amateurs",
      runs:0,
      totalDistance:0,
      totalTime:0,
      bestDistance:0,
      baselineDistance:null,
      baselineTime:null
    };
  });

  entries.forEach(e=>{
    const user=getUserById(e.userId);
    if(!user)return;
    const stats=byUser[user.id];
    if(stats.runs===0){
      stats.baselineDistance=e.distanceKm;
      stats.baselineTime=e.timeMinutes;
    }
    stats.runs+=1;
    stats.totalDistance+=e.distanceKm;
    stats.totalTime+=e.timeMinutes;
    if(e.distanceKm>stats.bestDistance)stats.bestDistance=e.distanceKm;
  });

  let players=Object.values(byUser);

  players.forEach(p=>{
    p.avgDistance=p.runs>0?p.totalDistance/p.runs:0;
    p.avgPace=p.totalDistance>0?p.totalTime/p.totalDistance:null; // minutes per km
    let distImp=0;
    if(p.baselineDistance && p.runs>1){
      distImp=((p.avgDistance-p.baselineDistance)/p.baselineDistance)*100;
    }
    let paceImp=0;
    if(p.baselineTime && p.baselineDistance && p.runs>1){
      const basePace=p.baselineTime/p.baselineDistance;
      if(basePace>0 && p.avgPace){
        paceImp=((basePace-p.avgPace)/basePace)*100;
      }
    }
    p.improvement=distImp+paceImp;
  });

  players.sort((a,b)=>{
    if(b.totalDistance!==a.totalDistance)return b.totalDistance-a.totalDistance;
    if(b.runs!==a.runs)return b.runs-a.runs;
    const aSpeed=a.totalTime>0?a.totalDistance/a.totalTime:0;
    const bSpeed=b.totalTime>0?b.totalDistance/b.totalTime:0;
    if(bSpeed!==aSpeed)return bSpeed-aSpeed;
    return a.totalTime-b.totalTime;
  });

  players=players.map((p,index)=>({...p,rank:index+1}));
  return players;
}

/* Render header user chips */
function renderHeaderUser(){
  const el=document.getElementById("user-controls");
  const nameInput=document.getElementById("name");
  if(!el)return;
  el.innerHTML="";
  if(!currentUser){
    const status=document.createElement("span");
    status.id="user-status";
    status.textContent="Not logged in";
    el.appendChild(status);
    const btn=document.createElement("button");
    btn.className="px-3 py-1 rounded-full border border-white/20 text-[11px] text-gray-300";
    btn.textContent="Log in";
    btn.onclick=()=>showScene("mih-login");
    el.appendChild(btn);
    if(nameInput){
      nameInput.value="";
      nameInput.placeholder="Log in to set your name";
    }
    return;
  }
  const status=document.createElement("span");
  status.id="user-status";
  status.innerHTML=
    `Logged in as <span class="font-semibold">${currentUser.name}</span> · `+
    `<span class="px-2 py-0.5 rounded-full border border-white/25 text-[10px] uppercase tracking-wide">${currentUser.league.charAt(0).toUpperCase()+currentUser.league.slice(1)}</span>`;
  el.appendChild(status);

  const logoutBtn=document.createElement("button");
  logoutBtn.className="px-3 py-1 rounded-full border border-white/20 text-[11px] text-gray-300";
  logoutBtn.textContent="Log out";
  logoutBtn.onclick=logout;
  el.appendChild(logoutBtn);

  const deleteBtn=document.createElement("button");
  deleteBtn.className="px-3 py-1 rounded-full border border-red-400/60 text-[11px] text-red-200";
  deleteBtn.textContent="Delete account";
  deleteBtn.onclick=deleteAccount;
  el.appendChild(deleteBtn);

  if(nameInput){
    nameInput.value=currentUser.name;
    nameInput.placeholder="";
  }
}

/* Leaderboard rendering */
function renderLeaderboard(){
  const tbody=document.getElementById("leaderboard-body");
  const empty=document.getElementById("no-entries");
  if(!tbody)return;
  tbody.innerHTML="";
  const players=getPlayerStats();
  const filter=document.getElementById("league-filter")?.value || "all";
  let filtered=players;
  if(filter!=="all"){
    filtered=players.filter(p=>p.league===filter);
  }
  if(!filtered.length){
    if(empty)empty.style.display="block";
    return;
  }
  if(empty)empty.style.display="none";

  filtered.forEach(player=>{
    const tr=document.createElement("tr");
    tr.className="border-b border-white/10";
    let rankSymbol=player.rank;
    if(player.rank===1)rankSymbol="🥇";
    else if(player.rank===2)rankSymbol="🥈";
    else if(player.rank===3)rankSymbol="🥉";
    tr.innerHTML=`
      <td class="py-2 pr-2">${rankSymbol}</td>
      <td class="py-2 px-2">
        <button class="underline text-gray-200 text-xs md:text-sm" onclick="openProfile('${player.userId}')">
          ${player.name}
        </button>
      </td>
      <td class="py-2 px-2">
        <span class="px-2 py-0.5 rounded-full border border-white/25 text-[10px] uppercase tracking-wide">
          ${player.league.charAt(0).toUpperCase()+player.league.slice(1)}
        </span>
      </td>
      <td class="py-2 px-2">${player.totalDistance.toFixed(2)} km</td>
      <td class="py-2 px-2">${player.totalTime.toFixed(1)} min</td>
    `;
    tbody.appendChild(tr);
  });
}

/* Stats rendering */
function renderStats(){
  const tbody=document.getElementById("stats-body");
  const empty=document.getElementById("no-stats");
  if(!tbody)return;
  tbody.innerHTML="";
  if(!users.length){
    if(empty)empty.style.display="block";
    return;
  }
  if(empty)empty.style.display="none";
  const players=getPlayerStats();
  players.forEach(stats=>{
    const tr=document.createElement("tr");
    tr.className="border-b border-white/10";
    tr.innerHTML=`
      <td class="py-2 px-2">${stats.name}</td>
      <td class="py-2 px-2">
        <span class="px-2 py-0.5 rounded-full border border-white/25 text-[10px] uppercase tracking-wide">
          ${stats.league.charAt(0).toUpperCase()+stats.league.slice(1)}</span></td>
      <td class="py-2 px-2">${stats.runs}</td>
      <td class="py-2 px-2">${stats.totalDistance.toFixed(2)} km</td>
      <td class="py-2 px-2">${stats.avgDistance.toFixed(2)} km</td>
      <td class="py-2 px-2">${stats.bestDistance.toFixed(2)} km</td>
      <td class="py-2 px-2">${formatImprovement(stats.improvement)}</td>
    `;
    tbody.appendChild(tr);
  });
}

/* My activities */
function renderMyActivities(){
  const tbody=document.getElementById("my-activities-body");
  const empty=document.getElementById("no-my-activities");
  if(!tbody)return;
  tbody.innerHTML="";
  if(!currentUser){
    if(empty){
      empty.style.display="block";
      empty.textContent="Log in to see and manage your activities.";
    }
    return;
  }
  const myEntries=entries.filter(e=>e.userId===currentUser.id);
  if(!myEntries.length){
    if(empty){
      empty.style.display="block";
      empty.textContent="No activities yet for this account.";
    }
    return;
  }
  if(empty)empty.style.display="none";
  myEntries.slice().sort((a,b)=>b.timestamp-a.timestamp).forEach(e=>{
    const tr=document.createElement("tr");
    tr.className="border-b border-white/10";
    tr.innerHTML=`
      <td class="py-2 px-2">${formatDate(e.timestamp)}</td>
      <td class="py-2 px-2">${e.distanceKm.toFixed(2)} km</td>
      <td class="py-2 px-2">${e.timeMinutes.toFixed(1)} min</td>
      <td class="py-2 px-2 text-right">
        <button class="text-[11px] text-red-300 underline" onclick="deleteActivity('${e.id}')">Delete</button>
      </td>
    `;
    tbody.appendChild(tr);
  });
}

function deleteActivity(id){
  if(!currentUser){alert("You need to be logged in to delete activities.");return;}
  const entry=entries.find(e=>e.id===id);
  if(!entry)return;
  if(entry.userId!==currentUser.id){alert("You can only delete your own activities.");return;}
  if(!confirm("Delete this activity?"))return;
  entries=entries.filter(e=>e.id!==id);
  saveEntries();
  renderLeaderboard();
  renderStats();
  renderMyActivities();
}

/* Profiles: open when clicking on a name */
function openProfile(userId){
  const user=getUserById(userId);
  if(!user)return;
  const userEntries=entries.filter(e=>e.userId===userId);
  let totalDist=0,totalTime=0;
  userEntries.forEach(e=>{totalDist+=e.distanceKm;totalTime+=e.timeMinutes;});
  const runs=userEntries.length;
  const avgDist=runs>0?totalDist/runs:0;
  const avgPace=totalDist>0?totalTime/totalDist:null;
  let best5k=null,best10k=null,best100m=null;
  if(avgPace){
    best5k=avgPace*5;
    best10k=avgPace*10;
    best100m=avgPace*0.1;
  }
  document.getElementById("profileName").textContent=user.name;
  document.getElementById("profileLeague").textContent=`League: ${user.league.charAt(0).toUpperCase()+user.league.slice(1)}`;
  document.getElementById("profileTotalDistance").textContent=totalDist.toFixed(2)+" km";
  document.getElementById("profileTotalTime").textContent=totalTime.toFixed(1)+" min";
  document.getElementById("profileRuns").textContent=runs.toString();
  document.getElementById("profileAvgDistance").textContent=runs?avgDist.toFixed(2)+" km":"–";
  document.getElementById("profileBest5k").textContent=best5k?formatMinutes(best5k):"–";
  document.getElementById("profileBest10k").textContent=best10k?formatMinutes(best10k):"–";
  document.getElementById("profileBest100m").textContent=best100m?formatMinutes(best100m):"–";
  showScene("mih-profile");
}

/* Auth */
function login(name,password){
  const trimmed=name.trim();
  if(!trimmed||!password){alert("Please enter both name and password.");return;}
  const existing=getUserByName(trimmed);
  if(!existing){
    const newLeague=assignStartingLeague();
    const newUser={
      id:generateId(),
      name:trimmed,
      password,
      league:newLeague,
      createdAt:Date.now(),
      lastLoginAt:Date.now(),
      lastLogoutAt:null
    };
    users.push(newUser);
    currentUser=newUser;
    saveUsers();
    localStorage.setItem(STORAGE_KEY_CURRENT_USER,newUser.id);
    renderHeaderUser();
    showScene("mih-welcome");
    return;
  }
  if(existing.password!==password){
    alert("Wrong password for this name.");
    return;
  }
  existing.lastLoginAt=Date.now();
  if(!existing.league||!LEAGUES.includes(existing.league)){
    existing.league="amateurs";
  }
  currentUser=existing;
  saveUsers();
  localStorage.setItem(STORAGE_KEY_CURRENT_USER,existing.id);
  renderHeaderUser();
  showScene("mih-welcome");
}
function logout(){
  if(!currentUser)return;
  const user=getUserById(currentUser.id);
  if(user){user.lastLogoutAt=Date.now();}
  saveUsers();
  localStorage.removeItem(STORAGE_KEY_CURRENT_USER);
  currentUser=null;
  renderHeaderUser();
  renderMyActivities();
  showScene("mih-login");
}
function deleteAccount(){
  if(!currentUser)return;
  if(!confirm("This will delete your account and all your activities. Are you sure?"))return;
  const id=currentUser.id;
  users=users.filter(u=>u.id!==id);
  entries=entries.filter(e=>e.userId!==id);
  saveUsers();
  saveEntries();
  localStorage.removeItem(STORAGE_KEY_CURRENT_USER);
  currentUser=null;
  renderHeaderUser();
  renderLeaderboard();
  renderStats();
  renderMyActivities();
  showScene("mih-login");
}

/* Form handlers */
const loginFormEl=document.getElementById("login-form");
if(loginFormEl){
  loginFormEl.addEventListener("submit",e=>{
    e.preventDefault();
    const name=document.getElementById("login-name").value;
    const pw=document.getElementById("login-password").value;
    login(name,pw);
    loginFormEl.reset();
  });
}
const entryFormEl=document.getElementById("entry-form");
if(entryFormEl){
  entryFormEl.addEventListener("submit",e=>{
    e.preventDefault();
    if(!currentUser){
      alert("Please log in before adding activities.");
      showScene("mih-login");
      return;
    }
    const distance=parseFloat(document.getElementById("distance").value);
    const time=parseFloat(document.getElementById("time").value);
    if(isNaN(distance)||isNaN(time)){alert("Please fill in distance and time correctly.");return;}
    if(distance<=0||time<=0){alert("Distance and time must be bigger than zero.");return;}
    entries.push({
      id:generateId(),
      userId:currentUser.id,
      distanceKm:distance,
      timeMinutes:time,
      timestamp:Date.now()
    });
    saveEntries();
    renderLeaderboard();
    renderStats();
    renderMyActivities();
    entryFormEl.reset();
    showScene("mih-leaderboard");
  });
}

/* Init MIH */
function initMIH(){
  loadEntries();
  loadUsers();
  cleanupOldAccounts();
  const currentId=localStorage.getItem(STORAGE_KEY_CURRENT_USER);
  if(currentId){
    const user=getUserById(currentId);
    if(user){currentUser=user;}
    else{localStorage.removeItem(STORAGE_KEY_CURRENT_USER);currentUser=null;}
  }
  renderHeaderUser();
  renderLeaderboard();
  renderStats();
  renderMyActivities();
}
initMIH();
</script>

</body>
</html>

