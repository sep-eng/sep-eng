<!-- ========================================================= -->
<!-- SEP + MAKE IT HAPPEN SINGLE PAGE SITE                    -->
<!-- PART 1 OF 4                                               -->
<!-- Paste parts 1, 2, 3 and 4 together in order into one     -->
<!-- index.html file to get the full working site.            -->
<!-- ========================================================= -->

<!DOCTYPE html>
<html lang="en">
<head>
  <!-- ===================================== -->
  <!-- BASIC META                            -->
  <!-- ===================================== -->
  <meta charset="UTF-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0"
  />
  <title>
    SEP · Your Choice · Make It Happen
  </title>
  <meta
    name="description"
    content="SEP is a minimalist clothing brand from Copenhagen plus a simple movement challenge called Make It Happen. One calm page, no creepy data."
  />

  <!-- ===================================== -->
  <!-- FAVICON                               -->
  <!-- ===================================== -->
  <link
    rel="icon"
    href="https://upload.wikimedia.org/wikipedia/commons/3/3f/Black_square.jpg"
  />

  <!-- ===================================== -->
  <!-- GOOGLE FONT                           -->
  <!-- ===================================== -->
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
    rel="stylesheet"
  />

  <!-- ===================================== -->
  <!-- TAILWIND VIA CDN                      -->
  <!-- ===================================== -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- ===================================== -->
  <!-- GSAP + SCROLLTRIGGER                  -->
  <!-- ===================================== -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>

  <!-- ===================================== -->
  <!-- CUSTOM STYLES                         -->
  <!-- ===================================== -->
  <style>
    /* ===================================== */
    /* GLOBAL BODY BASELINE                   */
    /* ===================================== */

    html,
    body {
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(
        to bottom,
        #000000 0%,
        #050505 15%,
        #0a0a0a 30%,
        #111111 45%,
        #f7f7f7 100%
      );
      color: #111111;
      scroll-behavior: smooth;
      transition:
        background 0.5s ease,
        color 0.5s ease;
    }

    /* Slightly softer scroll for in page hash jumps */
    html {
      scroll-behavior: smooth;
    }

    /* Typography shared transitions */
    h1,
    h2,
    h3,
    h4,
    h5,
    h6,
    p,
    span,
    a,
    button,
    input,
    select,
    textarea {
      transition:
        color 0.4s ease,
        background-color 0.4s ease,
        border-color 0.4s ease;
    }

    /* Primary theme text used on dark backgrounds */
    .theme-text-light {
      color: #e7e7e7;
    }

    /* Helper for muted caption text on dark areas */
    .theme-text-muted {
      color: #9ca3af;
    }

    /* Buttons and links simple hover motion */
    button,
    a {
      transition:
        transform 0.2s ease,
        box-shadow 0.2s ease,
        background-color 0.2s ease,
        color 0.2s ease,
        border-color 0.2s ease;
    }

    button:hover,
    a:hover {
      transform: translateY(-1px);
    }

    button:active,
    a:active {
      transform: translateY(0);
    }

    /* ===================================== */
    /* POPUP TOASTS                          */
    /* ===================================== */

    .popup-toast {
      position: fixed;
      top: 18px;
      right: 18px;
      background: #16a34a;
      color: #ffffff;
      padding: 10px 16px;
      border-radius: 9999px;
      font-size: 12px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      pointer-events: none;
      box-shadow: 0 18px 45px rgba(0, 0, 0, 0.45);
      z-index: 100;
      transition:
        opacity 0.25s ease,
        transform 0.25s ease;
      transform: translateY(-8px);
    }

    .popup-toast.show {
      opacity: 1;
      pointer-events: auto;
      transform: translateY(0);
    }

    /* ===================================== */
    /* REUSABLE FADE IN SECTIONS             */
    /* ===================================== */

    .fade-section {
      opacity: 0;
      transform: translateY(30px);
    }

    /* ===================================== */
    /* SCENES - ONLY ONE ACTIVE AT A TIME    */
    /* ===================================== */

    .scene {
      display: none;
    }

    .scene.active {
      display: block;
    }

    /* ===================================== */
    /* GLOBAL NAV                            */
    /* ===================================== */

    #globalNavContainer {
      position: fixed;
      top: 12px;
      right: 12px;
      z-index: 70;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .nav-toggle-button {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 7px 12px;
      border-radius: 9999px;
      border: 1px solid rgba(255, 255, 255, 0.3);
      background: rgba(0, 0, 0, 0.88);
      color: #f9fafb;
      font-size: 11px;
      letter-spacing: 0.12em;
      text-transform: uppercase;
    }

    .nav-toggle-button span.nav-toggle-label {
      white-space: nowrap;
    }

    .nav-lines-icon {
      position: relative;
      width: 16px;
      height: 11px;
      display: inline-block;
    }

    .nav-lines-icon span {
      position: absolute;
      left: 0;
      right: 0;
      height: 2px;
      border-radius: 999px;
      background: #ffffff;
    }

    .nav-lines-icon span:nth-child(1) {
      top: 0;
    }

    .nav-lines-icon span:nth-child(2) {
      top: 4.5px;
    }

    .nav-lines-icon span:nth-child(3) {
      top: 9px;
    }

    /* Dropdown navigation panel */
    #navDropdown {
      display: none;
      margin-top: 4px;
      padding: 6px 6px 8px 6px;
      border-radius: 9999px;
      border: 1px solid rgba(255, 255, 255, 0.3);
      background: rgba(0, 0, 0, 0.88);
      backdrop-filter: blur(16px);
      box-shadow: 0 16px 45px rgba(0, 0, 0, 0.65);
    }

    #navDropdown.show {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .nav-chip-row {
      display: flex;
      flex-wrap: wrap;
      gap: 4px;
    }

    .nav-chip {
      font-size: 10px;
      padding: 4px 8px;
      border-radius: 9999px;
      border: 1px solid rgba(255, 255, 255, 0.24);
      background: transparent;
      color: #f3f4f6;
      white-space: nowrap;
    }

    .nav-chip:hover {
      background: rgba(255, 255, 255, 0.06);
    }

    /* Language row inside nav */
    .nav-language-row {
      margin-top: 4px;
      padding-top: 5px;
      border-top: 1px solid rgba(148, 163, 184, 0.4);
      display: flex;
      flex-direction: column;
      gap: 3px;
    }

    .nav-language-label {
      font-size: 9px;
      letter-spacing: 0.16em;
      text-transform: uppercase;
      color: #9ca3af;
    }

    .nav-language-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 4px;
    }

    .lang-btn {
      font-size: 10px;
      padding: 3px 7px;
      border-radius: 9999px;
      border: 1px solid rgba(148, 163, 184, 0.8);
      background: transparent;
      color: #e5e7eb;
      white-space: nowrap;
    }

    .lang-btn--active {
      background: #f9fafb;
      color: #000000;
      border-color: #f9fafb;
    }

    /* Used to gently hide nav and hero when cart is open */
    .hidden-during-cart {
      transition: opacity 0.25s ease;
    }

    /* ===================================== */
    /* SEP PRODUCT CARDS                     */
    /* ===================================== */

    .sep-product-card {
      background: rgba(255, 255, 255, 0.06);
      border-radius: 18px;
      border: 1px solid rgba(255, 255, 255, 0.16);
      box-shadow: 0 18px 45px rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(18px);
    }

    .sep-product-image {
      border-radius: 16px;
      object-fit: cover;
    }

    .sep-product-select,
    .sep-qty-input {
      background: transparent;
      border-radius: 9999px;
      border: 1px solid rgba(209, 213, 219, 0.8);
      padding: 6px 10px;
      font-size: 13px;
      color: #f9fafb;
    }

    .sep-product-select:focus,
    .sep-qty-input:focus {
      outline: none;
      border-color: #e5e7eb;
      box-shadow: 0 0 0 1px rgba(249, 250, 251, 0.5);
    }

    .sep-add-button {
      border-radius: 9999px;
      padding: 8px 16px;
      font-size: 13px;
    }

    /* ===================================== */
    /* CART SIDEBAR                          */
    /* ===================================== */

    #cartSidebar {
      position: fixed;
      top: 0;
      right: 0;
      height: 100%;
      width: 320px;
      max-width: 100%;
      background: #ffffff;
      color: #000000;
      box-shadow: -20px 0 45px rgba(0, 0, 0, 0.4);
      transform: translateX(100%);
      transition: transform 0.3s ease;
      z-index: 60;
      display: flex;
      flex-direction: column;
      overflow-y: auto;
    }

    #cartSidebar.cart-open {
      transform: translateX(0%);
    }

    #cartOverlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.55);
      z-index: 50;
      display: none;
    }

    #cartOverlay.show {
      display: block;
    }

    /* Shipping buttons */
    .shipping-toggle-button {
      font-size: 11px;
      padding: 4px 10px;
      border-radius: 9999px;
      border: 1px solid rgba(148, 163, 184, 0.85);
      background: transparent;
      color: #111827;
      white-space: nowrap;
    }

    .shipping-toggle-button.active {
      background: #e5e7eb;
      border-color: #111827;
    }

    /* ===================================== */
    /* MIH CARD STYLING                      */
    /* ===================================== */

    .mih-card {
      background: rgba(17, 24, 39, 0.95);
      border-radius: 18px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      box-shadow: 0 20px 50px rgba(0, 0, 0, 0.75);
    }

    /* ===================================== */
    /* TABLE STYLING                         */
    /* ===================================== */

    .mih-table {
      width: 100%;
      border-collapse: collapse;
    }

    .mih-table thead {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.14em;
    }

    .mih-table th,
    .mih-table td {
      padding: 6px 8px;
      border-bottom: 1px solid rgba(31, 41, 55, 0.9);
    }

    .mih-table th:first-child,
    .mih-table td:first-child {
      padding-left: 0;
    }

    .mih-table th:last-child,
    .mih-table td:last-child {
      padding-right: 0;
    }

    /* ===================================== */
    /* PROFILE STATS LABELS                  */
    /* ===================================== */

    .profile-label {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.13em;
      color: #9ca3af;
    }

    .profile-value {
      font-size: 14px;
      color: #f9fafb;
    }

    /* ===================================== */
    /* SMALL HELPERS                         */
    /* ===================================== */

    .caps-label {
      text-transform: uppercase;
      letter-spacing: 0.16em;
      font-size: 10px;
    }

    .sep-subtle-border {
      border: 1px solid rgba(255, 255, 255, 0.12);
    }

    .sep-hero-gradient {
      background: radial-gradient(
        circle at top,
        rgba(249, 250, 251, 0.04) 0%,
        rgba(17, 24, 39, 0.96) 55%,
        rgba(0, 0, 0, 1) 100%
      );
    }

    .sep-section-max {
      max-width: 1120px;
      margin-left: auto;
      margin-right: auto;
    }

    .sep-glass-surface {
      background: rgba(15, 23, 42, 0.9);
      border-radius: 24px;
      border: 1px solid rgba(148, 163, 184, 0.35);
      box-shadow: 0 24px 60px rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(20px);
    }

    .sep-pill {
      border-radius: 9999px;
      padding: 6px 12px;
    }

    .sep-hero-badge {
      font-size: 11px;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      color: #9ca3af;
    }

    .sep-hero-badge-dot {
      width: 6px;
      height: 6px;
      border-radius: 9999px;
      background: #22c55e;
      box-shadow: 0 0 0 4px rgba(34, 197, 94, 0.25);
    }

    /* ===================================== */
    /* RESPONSIVE TWEAKS                     */
    /* ===================================== */

    @media (max-width: 640px) {
      #cartSidebar {
        width: 100%;
      }

      .nav-toggle-button {
        padding: 6px 10px;
      }

      .mih-card {
        border-radius: 16px;
      }
    }
  </style>
</head>

<body>
  <!-- ========================================================= -->
  <!-- GLOBAL NAVIGATION - ALWAYS PRESENT ON TOP RIGHT           -->
  <!-- ========================================================= -->
  <div
    id="globalNavContainer"
    class="hidden-during-cart"
  >
    <!-- Main hamburger style toggle button -->
    <button
      id="navToggleButton"
      type="button"
      class="nav-toggle-button"
    >
      <span class="nav-lines-icon">
        <span></span>
        <span></span>
        <span></span>
      </span>
      <span class="nav-toggle-label">
        Menu
      </span>
    </button>

    <!-- Dropdown container with scene links + language -->
    <div
      id="navDropdown"
      aria-label="Global navigation"
    >
      <!-- Scene links row -->
      <div class="nav-chip-row mb-1">
        <button
          type="button"
          class="nav-chip"
          data-scene-target="sep-shop"
          data-i18n="nav_sep_shop"
        >
          SEP shop
        </button>

        <button
          type="button"
          class="nav-chip"
          data-scene-target="sep-about"
          data-i18n="nav_sep_about"
        >
          About SEP
        </button>

        <button
          type="button"
          class="nav-chip"
          data-scene-target="mih-welcome"
          data-i18n="nav_mih_home"
        >
          Make It Happen
        </button>

        <button
          type="button"
          class="nav-chip"
          data-scene-target="mih-about"
          data-i18n="nav_mih_about"
        >
          About Make It Happen
        </button>
      </div>

      <!-- Language selection row (SEP translations only) -->
      <div class="nav-language-row">
        <div
          class="nav-language-label"
          data-i18n="nav_language_label"
        >
          Language
        </div>

        <div class="nav-language-buttons">
          <button
            type="button"
            class="lang-btn lang-btn--active"
            data-lang="en"
          >
            English
          </button>

          <button
            type="button"
            class="lang-btn"
            data-lang="da"
          >
            Dansk
          </button>

          <button
            type="button"
            class="lang-btn"
            data-lang="cs"
          >
            Česky
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- ========================================================= -->
  <!-- SCENE: SEP SHOP (DEFAULT)                                -->
  <!-- ========================================================= -->
  <section
    id="scene-sep-shop"
    class="scene active"
  >
    <!-- ======================== -->
    <!-- SEP HERO SECTION         -->
    <!-- ======================== -->
    <header
      class="relative sep-hero-gradient text-center text-white pt-28 pb-20 px-6 overflow-hidden"
    >
      <div
        class="sep-section-max mx-auto fade-section"
      >
        <!-- Small badge row -->
        <div
          class="flex items-center justify-center gap-3 mb-6"
        >
          <div class="sep-hero-badge-dot"></div>

          <div
            class="sep-hero-badge"
            data-i18n="sep_hero_badge"
          >
            Minimal clothing from Copenhagen
          </div>
        </div>

        <!-- Main heading -->
        <h1
          class="theme-text-light text-4xl md:text-5xl lg:text-6xl font-semibold tracking-tight mb-4"
          data-i18n="sep_hero_title"
        >
          Minimalist clothing made with intention.
        </h1>

        <!-- Subheading -->
        <p
          class="theme-text-muted max-w-2xl mx-auto text-sm md:text-base mb-8"
          data-i18n="sep_hero_subtitle"
        >
          Soft, clean and hand pressed in Copenhagen. One white T shirt. One black hoodie. One pair of black
          trousers. That is it.
        </p>

        <!-- Hero CTAs and cart button -->
        <div
          id="sepHeroButtons"
          class="hidden-during-cart flex flex-col sm:flex-row items-center justify-center gap-4 mb-10"
        >
          <!-- Shop now anchor button -->
          <a
            href="#sep-products"
            class="inline-flex items-center justify-center px-7 py-3 rounded-full bg-white text-black text-sm font-medium shadow-lg shadow-black/40 hover:shadow-black/60"
            data-i18n="sep_hero_shop_button"
          >
            Shop now
          </a>

          <!-- View Cart button with badge -->
          <button
            id="viewCartButton"
            type="button"
            class="relative inline-flex items-center justify-center px-7 py-3 rounded-full border border-white/70 text-sm font-medium text-white bg-white/5 hover:bg-white/10"
          >
            <span data-i18n="sep_hero_view_cart">
              View cart
            </span>

            <!-- Counter bubble -->
            <span
              id="cartItemCounter"
              class="absolute -top-2 -right-2 w-6 h-6 rounded-full bg-red-600 text-[11px] flex items-center justify-center font-semibold shadow-lg shadow-black/60 hidden"
            >
              0
            </span>
          </button>
        </div>

        <!-- Hero micro copy row -->
        <div
          class="flex flex-wrap gap-2 items-center justify-center text-[11px] text-gray-400"
        >
          <span
            class="px-3 py-1 rounded-full border border-white/10 bg-white/5"
            data-i18n="sep_hero_chip_1"
          >
            Made in small batches in Copenhagen
          </span>

          <span
            class="px-3 py-1 rounded-full border border-white/10 bg-white/5"
            data-i18n="sep_hero_chip_2"
          >
            No data selling. No creepy tracking.
          </span>

          <span
            class="px-3 py-1 rounded-full border border-white/10 bg-white/5"
            data-i18n="sep_hero_chip_3"
          >
            Free shipping in Copenhagen. +45 kr for the rest of Denmark.
          </span>
        </div>
      </div>
    </header>

    <!-- ======================== -->
    <!-- SEP PRODUCT GRID         -->
    <!-- ======================== -->
    <section
      id="sep-products"
      class="py-20 px-6 bg-gradient-to-b from-black via-slate-950 to-slate-900"
    >
      <div
        class="sep-section-max mx-auto text-center mb-12 fade-section"
      >
        <h2
          class="theme-text-light text-3xl md:text-4xl font-semibold mb-3"
          data-i18n="sep_products_title"
        >
          Three products. One choice.
        </h2>

        <p
          class="theme-text-muted max-w-xl mx-auto text-sm md:text-base"
          data-i18n="sep_products_subtitle"
        >
          The idea is simple. A white T shirt. A black hoodie. A pair of black trousers. All at 180 kr. All soft.
          All built to be worn a lot.
        </p>
      </div>

      <!-- Product cards grid -->
      <div
        class="sep-section-max mx-auto grid grid-cols-1 md:grid-cols-3 gap-8 fade-section"
      >
        <!-- ================================= -->
        <!-- PRODUCT 1 - WHITE T SHIRT         -->
        <!-- ================================= -->
        <article
          class="sep-product-card p-6 text-center text-white flex flex-col"
        >
          <!-- Product image -->
          <img
            src="https://images.pexels.com/photos/6311579/pexels-photo-6311579.jpeg?auto=compress&cs=tinysrgb&w=1200"
            alt="White T shirt on a clean background"
            class="sep-product-image w-full h-64 mb-4"
          />

          <!-- Product name + price -->
          <div class="mb-2">
            <h3
              class="text-lg md:text-xl font-semibold mb-1"
              data-i18n="sep_product_tshirt_name"
            >
              SEP White T shirt
            </h3>

            <p
              class="text-sm text-gray-300"
              data-i18n="sep_product_price_180"
            >
              180 kr.
            </p>
          </div>

          <!-- Size selector + quantity + add button -->
          <div
            class="mt-3 flex flex-col gap-3 items-center"
          >
            <div class="flex items-center gap-2">
              <label
                class="text-xs text-gray-300"
                data-i18n="sep_product_size_label"
              >
                Size
              </label>

              <select
                class="sep-product-select"
                aria-label="Size for SEP White T shirt"
                data-product="tshirt"
              >
                <option>XS</option>
                <option>S</option>
                <option>M</option>
                <option>L</option>
                <option>XL</option>
              </select>
            </div>

            <div
              class="flex items-center justify-center gap-3"
            >
              <div class="flex items-center gap-2">
                <label
                  class="text-xs text-gray-300"
                  data-i18n="sep_product_quantity_label"
                >
                  Qty
                </label>

                <input
                  type="number"
                  min="1"
                  value="1"
                  class="sep-qty-input w-16 text-center"
                  aria-label="Quantity for SEP White T shirt"
                  data-product="tshirt"
                />
              </div>

              <button
                type="button"
                class="sep-add-button bg-white text-black font-medium"
                data-product="tshirt"
                data-product-name="SEP White T shirt"
                data-product-price="180"
                data-i18n="sep_product_add_button"
              >
                Add
              </button>
            </div>
          </div>

          <!-- Short micro copy -->
          <p
            class="text-xs text-gray-400 mt-4"
            data-i18n="sep_product_tshirt_note"
          >
            Mid weight cotton. Soft from day one and pressed by hand in Copenhagen.
          </p>
        </article>

        <!-- ================================= -->
        <!-- PRODUCT 2 - BLACK HOODIE          -->
        <!-- ================================= -->
        <article
          class="sep-product-card p-6 text-center text-white flex flex-col"
        >
          <!-- Product image -->
          <img
            src="https://images.pexels.com/photos/6311577/pexels-photo-6311577.jpeg?auto=compress&cs=tinysrgb&w=1200"
            alt="Black hoodie on a minimal background"
            class="sep-product-image w-full h-64 mb-4"
          />

          <!-- Product name + price -->
          <div class="mb-2">
            <h3
              class="text-lg md:text-xl font-semibold mb-1"
              data-i18n="sep_product_hoodie_name"
            >
              SEP Black Hoodie
            </h3>

            <p
              class="text-sm text-gray-300"
              data-i18n="sep_product_price_180"
            >
              180 kr.
            </p>
          </div>

          <!-- Size selector + quantity + add button -->
          <div
            class="mt-3 flex flex-col gap-3 items-center"
          >
            <div class="flex items-center gap-2">
              <label
                class="text-xs text-gray-300"
                data-i18n="sep_product_size_label"
              >
                Size
              </label>

              <select
                class="sep-product-select"
                aria-label="Size for SEP Black Hoodie"
                data-product="hoodie"
              >
                <option>XS</option>
                <option>S</option>
                <option>M</option>
                <option>L</option>
                <option>XL</option>
              </select>
            </div>

            <div
              class="flex items-center justify-center gap-3"
            >
              <div class="flex items-center gap-2">
                <label
                  class="text-xs text-gray-300"
                  data-i18n="sep_product_quantity_label"
                >
                  Qty
                </label>

                <input
                  type="number"
                  min="1"
                  value="1"
                  class="sep-qty-input w-16 text-center"
                  aria-label="Quantity for SEP Black Hoodie"
                  data-product="hoodie"
                />
              </div>

              <button
                type="button"
                class="sep-add-button bg-white text-black font-medium"
                data-product="hoodie"
                data-product-name="SEP Black Hoodie"
                data-product-price="180"
                data-i18n="sep_product_add_button"
              >
                Add
              </button>
            </div>
          </div>

          <!-- Short micro copy -->
          <p
            class="text-xs text-gray-400 mt-4"
            data-i18n="sep_product_hoodie_note"
          >
            Heavy and warm without feeling bulky. Fits over almost anything and still looks clean.
          </p>
        </article>

        <!-- ================================= -->
        <!-- PRODUCT 3 - BLACK TROUSERS        -->
        <!-- ================================= -->
        <article
          class="sep-product-card p-6 text-center text-white flex flex-col"
        >
          <!-- Product image -->
          <img
            src="https://images.pexels.com/photos/6311580/pexels-photo-6311580.jpeg?auto=compress&cs=tinysrgb&w=1200"
            alt="Black trousers on a minimal background"
            class="sep-product-image w-full h-64 mb-4"
          />

          <!-- Product name + price -->
          <div class="mb-2">
            <h3
              class="text-lg md:text-xl font-semibold mb-1"
              data-i18n="sep_product_trousers_name"
            >
              SEP Black Trousers
            </h3>

            <p
              class="text-sm text-gray-300"
              data-i18n="sep_product_price_180"
            >
              180 kr.
            </p>
          </div>

          <!-- Size selector + quantity + add button -->
          <div
            class="mt-3 flex flex-col gap-3 items-center"
          >
            <div class="flex items-center gap-2">
              <label
                class="text-xs text-gray-300"
                data-i18n="sep_product_size_label"
              >
                Size
              </label>

              <select
                class="sep-product-select"
                aria-label="Size for SEP Black Trousers"
                data-product="trousers"
              >
                <option>XS</option>
                <option>S</option>
                <option>M</option>
                <option>L</option>
                <option>XL</option>
              </select>
            </div>

            <div
              class="flex items-center justify-center gap-3"
            >
              <div class="flex items-center gap-2">
                <label
                  class="text-xs text-gray-300"
                  data-i18n="sep_product_quantity_label"
                >
                  Qty
                </label>

                <input
                  type="number"
                  min="1"
                  value="1"
                  class="sep-qty-input w-16 text-center"
                  aria-label="Quantity for SEP Black Trousers"
                  data-product="trousers"
                />
              </div>

              <button
                type="button"
                class="sep-add-button bg-white text-black font-medium"
                data-product="trousers"
                data-product-name="SEP Black Trousers"
                data-product-price="180"
                data-i18n="sep_product_add_button"
              >
                Add
              </button>
            </div>
          </div>

          <!-- Short micro copy -->
          <p
            class="text-xs text-gray-400 mt-4"
            data-i18n="sep_product_trousers_note"
          >
            Straight leg. Soft finish. Works with trainers or smart shoes. The one pair you can reach for every day.
          </p>
        </article>
      </div>
    </section>

    <!-- ======================== -->
    <!-- SEP CART SIDEBAR + OVERLAY-->
    <!-- ======================== -->
    <aside
      id="cartSidebar"
      aria-label="Shopping cart"
    >
      <div class="flex-1 flex flex-col">
        <!-- Header row -->
        <div
          class="flex items-center justify-between px-5 py-4 border-b border-gray-200"
        >
          <h3
            class="text-sm font-semibold tracking-wide"
            data-i18n="cart_title"
          >
            Your cart
          </h3>

          <button
            id="closeCartButton"
            type="button"
            class="text-xs text-gray-500 hover:text-black"
          >
            ✕
          </button>
        </div>

        <!-- Shipping selector -->
        <div
          class="px-5 py-3 border-b border-gray-200 text-xs text-gray-800 space-y-2"
        >
          <p
            class="font-medium"
            data-i18n="cart_shipping_label"
          >
            Shipping destination
          </p>

          <div class="flex flex-wrap gap-2">
            <button
              type="button"
              id="shippingCopenhagenButton"
              class="shipping-toggle-button active"
              data-i18n="cart_shipping_cph"
            >
              Copenhagen
            </button>

            <button
              type="button"
              id="shippingDenmarkButton"
              class="shipping-toggle-button"
              data-i18n="cart_shipping_rest"
            >
              Rest of Denmark
            </button>
          </div>

          <p
            class="text-[11px] text-gray-500"
            data-i18n="cart_shipping_hint"
          >
            Copenhagen is free shipping. The rest of Denmark adds 45 kr.
          </p>
        </div>

        <!-- Cart item list -->
        <div
          id="cartItemsContainer"
          class="flex-1 px-5 py-4 overflow-y-auto text-xs text-gray-800 space-y-4"
        >
          <!-- Filled by JavaScript -->
        </div>

        <!-- Totals + actions -->
        <div
          class="px-5 py-4 border-t border-gray-200 text-xs text-gray-800 space-y-3"
        >
          <div
            class="flex items-center justify-between"
          >
            <span data-i18n="cart_subtotal_label">
              Subtotal
            </span>

            <span
              id="cartSubtotal"
              class="font-semibold"
            >
              0 kr.
            </span>
          </div>

          <div
            class="flex items-center justify-between text-[11px] text-gray-500"
          >
            <span data-i18n="cart_shipping_row_label">
              Shipping
            </span>

            <span
              id="cartShippingLabel"
              data-i18n="cart_shipping_row_value_default"
            >
              +45 kr. (free in Copenhagen)
            </span>
          </div>

          <div
            class="mt-1 pt-2 border-t border-gray-200 flex items-center justify-between"
          >
            <span class="font-semibold">
              Total
            </span>

            <span
              id="cartTotal"
              class="font-semibold"
            >
              45 kr.
            </span>
          </div>

          <!-- MobilePay button -->
          <button
            id="openMobilePayButton"
            type="button"
            class="w-full mt-3 py-2 rounded-full bg-emerald-500 text-white font-medium text-xs hover:bg-emerald-600"
            data-i18n="cart_mobilepay_button"
          >
            Open MobilePay
          </button>

          <p
            class="text-[11px] text-gray-500 text-center"
            data-i18n="cart_mobilepay_hint"
          >
            The MobilePay link only works on phones where the app is installed.
          </p>

          <!-- Copy order message button -->
          <button
            id="copyOrderMessageButton"
            type="button"
            class="w-full mt-1 py-2 rounded-full bg-gray-100 text-gray-900 font-medium text-xs hover:bg-gray-200"
            data-i18n="cart_copy_button"
          >
            Copy order message
          </button>

          <p
            class="text-[11px] text-gray-500 text-center"
            data-i18n="cart_copy_hint"
          >
            Paste this message into MobilePay and in a DM to @seproairesis on Instagram or TikTok.
          </p>
        </div>
      </div>
    </aside>

    <!-- Overlay for cart -->
    <div
      id="cartOverlay"
      aria-hidden="true"
    ></div>

    <!-- ======================== -->
    <!-- HOW TO ORDER SECTION     -->
    <!-- ======================== -->
    <section
      class="py-20 px-6 bg-slate-900 text-white"
    >
      <div class="sep-section-max mx-auto">
        <div
          class="text-center max-w-2xl mx-auto mb-12 fade-section"
        >
          <h2
            class="text-2xl md:text-3xl font-semibold mb-3"
            data-i18n="how_title"
          >
            How to order with SEP
          </h2>

          <p
            class="text-sm md:text-base text-gray-300"
            data-i18n="how_subtitle"
          >
            No login, no accounts, no checkout maze. You choose your pieces, copy one message and pay with MobilePay.
          </p>
        </div>

        <div
          class="grid grid-cols-1 md:grid-cols-5 gap-6 text-xs md:text-sm fade-section"
        >
          <!-- Step 1 -->
          <article
            class="sep-glass-surface p-5 flex flex-col gap-2"
          >
            <h3
              class="font-semibold text-base"
              data-i18n="how_step1_title"
            >
              1. Choose
            </h3>

            <p
              class="text-gray-300"
              data-i18n="how_step1_body"
            >
              Pick your SEP piece. White T shirt, black hoodie or black trousers. Choose your size and how many you
              want.
            </p>
          </article>

          <!-- Step 2 -->
          <article
            class="sep-glass-surface p-5 flex flex-col gap-2"
          >
            <h3
              class="font-semibold text-base"
              data-i18n="how_step2_title"
            >
              2. Add to cart
            </h3>

            <p
              class="text-gray-300"
              data-i18n="how_step2_body"
            >
              Press Add for each product. When you are finished, tap View cart at the top and check everything looks
              right.
            </p>
          </article>

          <!-- Step 3 -->
          <article
            class="sep-glass-surface p-5 flex flex-col gap-2"
          >
            <h3
              class="font-semibold text-base"
              data-i18n="how_step3_title"
            >
              3. Copy the message
            </h3>

            <p
              class="text-gray-300"
              data-i18n="how_step3_body"
            >
              In the cart, tap Copy order message. This copies all items, sizes, shipping choice and total price into
              your clipboard.
            </p>
          </article>

          <!-- Step 4 -->
          <article
            class="sep-glass-surface p-5 flex flex-col gap-2"
          >
            <h3
              class="font-semibold text-base"
              data-i18n="how_step4_title"
            >
              4. Pay with MobilePay
            </h3>

            <p
              class="text-gray-300"
              data-i18n="how_step4_body"
            >
              Send the total amount to MobilePay number
              <strong>5894BZ</strong>. Use the copied message as the text so we can match your payment and order.
            </p>
          </article>

          <!-- Step 5 -->
          <article
            class="sep-glass-surface p-5 flex flex-col gap-2"
          >
            <h3
              class="font-semibold text-base"
              data-i18n="how_step5_title"
            >
              5. Send us your order
            </h3>

            <p
              class="text-gray-300"
              data-i18n="how_step5_body"
            >
              Paste the same message into a DM to
              <strong>@seproairesis</strong> on Instagram or TikTok. We confirm, press your pieces and ship across
              Denmark.
            </p>
          </article>
        </div>
      </div>
    </section>

    <!-- ======================== -->
    <!-- SEP FOOTER               -->
    <!-- ======================== -->
    <footer
      class="py-12 px-6 bg-slate-950 text-slate-100 text-xs md:text-sm"
    >
      <div class="sep-section-max mx-auto">
        <div
          class="flex flex-col md:flex-row md:items-center md:justify-between gap-6 fade-section"
        >
          <div class="space-y-2 max-w-xl">
            <p data-i18n="footer_line_main">
              SEP stands for Se Proairesis, which roughly means Your choice in ancient Greek. The brand is built around
              that idea. Simple pieces you choose again and again.
            </p>

            <p data-i18n="footer_line_shipping">
              MobilePay 5894BZ · Free shipping in Copenhagen · +45 kr for the rest of Denmark · Delivery only inside
              Denmark.
            </p>

            <p
              class="text-slate-400"
              data-i18n="footer_line_privacy"
            >
              No analytics. No cookies. No data selling. No ads that follow you around. Your cart lives only in this
              browser.
            </p>
          </div>

          <div
            class="flex flex-col items-start md:items-end gap-3"
          >
            <div class="flex gap-3">
              <a
                href="https://instagram.com/seproairesis"
                target="_blank"
                rel="noreferrer"
                class="inline-flex items-center justify-center px-4 py-2 rounded-full bg-gradient-to-br from-pink-500 via-red-500 to-yellow-400 text-white font-medium text-xs shadow-lg shadow-black/40 hover:shadow-black/60"
                aria-label="Open SEP on Instagram"
                data-i18n="footer_button_instagram"
              >
                Instagram
              </a>

              <a
                href="https://tiktok.com/@seproairesis"
                target="_blank"
                rel="noreferrer"
                class="inline-flex items-center justify-center px-4 py-2 rounded-full bg-black text-white font-medium text-xs shadow-lg shadow-black/40 hover:bg-neutral-900"
                aria-label="Open SEP on TikTok"
                data-i18n="footer_button_tiktok"
              >
                TikTok
              </a>
            </div>

            <p
              class="text-[11px] text-slate-500"
              data-i18n="footer_line_copyright"
            >
              © 2025 SEP · Se Proairesis · Built in Copenhagen.
            </p>
          </div>
        </div>
      </div>
    </footer>
  </section>

  <!-- ========================================================= -->
  <!-- END OF PART 1 OF 4                                        -->
  <!-- Next parts:                                               -->
  <!--   Part 2: About SEP scene + all MIH scenes markup         -->
  <!--   Part 3: Script - translations, nav, scene handling      -->
  <!--   Part 4: Script - cart, MobilePay, MIH data and init     -->
  <!-- ========================================================= -->
  <!-- ========================================================= -->
  <!-- PART 2 OF 4                                               -->
  <!-- ABOUT SEP + ALL MIH SCENES MARKUP                         -->
  <!-- Paste directly after Part 1 inside the same <body>.       -->
  <!-- ========================================================= -->

  <!-- ========================================================= -->
  <!-- SCENE: ABOUT SEP                                          -->
  <!-- ========================================================= -->
  <section
    id="scene-sep-about"
    class="scene"
  >
    <div
      class="min-h-screen bg-black text-white px-6 py-24 flex items-center"
    >
      <div class="sep-section-max mx-auto fade-section">
        <!-- Back link style chip -->
        <button
          type="button"
          class="mb-8 inline-flex items-center gap-2 px-4 py-2 rounded-full border border-white/20 text-xs text-gray-300 hover:bg-white/5"
          data-scene-target="sep-shop"
        >
          <span>
            ←
          </span>
          <span data-i18n="sep_about_back_chip">
            Back to SEP shop
          </span>
        </button>

        <!-- Main title -->
        <h1
          class="text-3xl md:text-4xl lg:text-5xl font-semibold tracking-tight mb-6"
          data-i18n="sep_about_title"
        >
          About SEP
        </h1>

        <!-- First paragraph - meaning, philosophy -->
        <p
          class="text-sm md:text-base text-gray-200 mb-5 max-w-3xl"
          data-i18n="sep_about_p1"
        >
          SEP comes from the Greek idea Se Proairesis, often translated as Your choice. It is about the small everyday
          decisions that quietly shape how you live. What you wear, how you move, what you pay attention to. SEP is a
          calm brand built around those choices.
        </p>

        <!-- Second paragraph - small batch, slow, intentional -->
        <p
          class="text-sm md:text-base text-gray-200 mb-5 max-w-3xl"
          data-i18n="sep_about_p2"
        >
          Every piece is pressed by hand in Copenhagen in small runs. No big drops, no fast seasons, no hurry. The point
          is not to chase the next thing. It is to find a few pieces you rely on and wear until they are part of you.
        </p>

        <!-- Third paragraph - minimal items, no hype -->
        <p
          class="text-sm md:text-base text-gray-200 mb-5 max-w-3xl"
          data-i18n="sep_about_p3"
        >
          That is why SEP keeps the collection minimal. A white T shirt. A black hoodie. A pair of black trousers. No
          constant releases. No limited edition panic. Just clothes that are soft, clean and designed to quietly work
          with whatever else you already own.
        </p>

        <!-- Privacy and data paragraph -->
        <p
          class="text-sm md:text-base text-gray-200 mb-8 max-w-3xl"
          data-i18n="sep_about_p4"
        >
          The same thinking applies to data. SEP does not track you around the internet, does not sell your data and
          does not use dark patterns. Your cart and your Make It Happen stats live only on your own device.
        </p>

        <!-- CTA buttons row -->
        <div class="flex flex-wrap gap-4">
          <button
            type="button"
            class="inline-flex items-center justify-center px-6 py-3 rounded-full bg-white text-black text-sm font-medium hover:bg-gray-100"
            data-scene-target="sep-shop"
            data-i18n="sep_about_button_back_shop"
          >
            Back to SEP shop
          </button>

          <button
            type="button"
            class="inline-flex items-center justify-center px-6 py-3 rounded-full border border-white/30 text-sm text-white hover:bg-white/10"
            data-scene-target="mih-welcome"
            data-i18n="sep_about_button_to_mih"
          >
            Go to Make It Happen
          </button>
        </div>
      </div>
    </div>
  </section>

  <!-- ========================================================= -->
  <!-- SCENE: MIH WELCOME                                        -->
  <!-- ========================================================= -->
  <section
    id="scene-mih-welcome"
    class="scene"
  >
    <div
      class="min-h-screen bg-gradient-to-b from-slate-950 via-slate-900 to-slate-950 text-white px-6 py-24 flex items-center"
    >
      <div class="sep-section-max mx-auto fade-section">
        <!-- Header badge and title -->
        <div class="flex flex-col gap-4 mb-10">
          <div class="inline-flex items-center gap-3">
            <span class="sep-hero-badge-dot"></span>

            <span class="sep-hero-badge">
              SEP · Make It Happen
            </span>
          </div>

          <h1 class="text-3xl md:text-4xl lg:text-5xl font-semibold tracking-tight">
            Move more. Compete gently. Make it happen.
          </h1>

          <p class="text-sm md:text-base text-gray-300 max-w-2xl">
            Make It Happen is a simple movement challenge that lives inside the SEP site. No app. No subscription. Just
            a small leaderboard that rewards distance, commitment and slow improvement over time.
          </p>
        </div>

        <!-- CTA buttons -->
        <div class="flex flex-wrap items-center gap-4 mb-10">
          <button
            type="button"
            class="inline-flex items-center justify-center px-7 py-3 rounded-full bg-white text-black text-sm font-medium hover:bg-gray-100"
            data-scene-target="mih-leaderboard"
          >
            See leaderboard
          </button>

          <button
            type="button"
            class="inline-flex items-center justify-center px-7 py-3 rounded-full border border-white/30 text-sm text-white hover:bg-white/10"
            data-scene-target="mih-about"
          >
            What is this
          </button>
        </div>

        <!-- Leagues row -->
        <div
          class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-12 text-xs md:text-sm"
        >
          <article class="mih-card p-5 flex flex-col gap-2">
            <h2 class="caps-label text-gray-300">
              Four leagues
            </h2>

            <p class="text-gray-200">
              Amateurs, Intermediates, Pros and Legends. Each league is for a different level, from gentle beginners to
              long distance obsessives.
            </p>
          </article>

          <article class="mih-card p-5 flex flex-col gap-2">
            <h2 class="caps-label text-gray-300">
              Automatic placement
            </h2>

            <p class="text-gray-200">
              When you join, the system puts you in the league with the fewest people so that numbers stay balanced and
              nobody gets lost.
            </p>
          </article>

          <article class="mih-card p-5 flex flex-col gap-2">
            <h2 class="caps-label text-gray-300">
              Distance and sessions
            </h2>

            <p class="text-gray-200">
              The leaderboard rewards both how far you go and how often you show up. Lots of short runs still count.
            </p>
          </article>

          <article class="mih-card p-5 flex flex-col gap-2">
            <h2 class="caps-label text-gray-300">
              Improvement over time
            </h2>

            <p class="text-gray-200">
              The stats view tracks improvements so slower runners who keep progressing can still feel competitive.
            </p>
          </article>
        </div>

        <!-- Login prompt panel -->
        <div class="mih-card p-6 flex flex-col md:flex-row items-start md:items-center gap-4 fade-section">
          <div class="flex-1">
            <h2 class="text-lg font-semibold mb-1">
              Log in to start logging runs
            </h2>

            <p class="text-xs md:text-sm text-gray-300">
              You only need a name and a simple password. Everything stays in your browser. You can export your stats
              manually any time.
            </p>
          </div>

          <div class="flex gap-3">
            <button
              type="button"
              class="px-5 py-2 rounded-full bg-white text-black text-xs font-medium hover:bg-gray-100"
              data-scene-target="mih-login"
            >
              Go to login
            </button>

            <button
              type="button"
              class="px-5 py-2 rounded-full border border-white/40 text-xs text-white hover:bg-white/10"
              data-scene-target="sep-shop"
            >
              Back to SEP
            </button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- ========================================================= -->
  <!-- SCENE: MIH LOGIN                                          -->
  <!-- ========================================================= -->
  <section
    id="scene-mih-login"
    class="scene"
  >
    <div
      class="min-h-screen bg-slate-950 text-white px-6 py-24 flex items-center"
    >
      <div class="sep-section-max mx-auto fade-section">
        <!-- Header with back button -->
        <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-10">
          <div>
            <h1 class="text-2xl md:text-3xl font-semibold tracking-tight mb-2">
              Make It Happen login
            </h1>

            <p class="text-sm md:text-base text-gray-300 max-w-xl">
              Create a simple account with your name and a password. If your name does not exist yet, we make a new
              account for you and place you in a league. If it does exist, we log you in.
            </p>
          </div>

          <button
            type="button"
            class="inline-flex items-center justify-center px-4 py-2 rounded-full border border-white/30 text-xs text-white hover:bg-white/10"
            data-scene-target="mih-welcome"
          >
            ← Back to welcome
          </button>
        </div>

        <!-- Login card -->
        <div class="mih-card p-6 md:p-8 grid grid-cols-1 md:grid-cols-3 gap-6">
          <!-- Login form -->
          <div class="md:col-span-2 flex flex-col gap-4">
            <div class="flex flex-col gap-1">
              <label
                for="mihLoginName"
                class="caps-label text-gray-300"
              >
                Name
              </label>

              <input
                id="mihLoginName"
                type="text"
                class="w-full rounded-full border border-slate-600 bg-transparent text-sm px-4 py-2 focus:outline-none focus:border-slate-300"
                placeholder="Your name as you want it on the leaderboard"
              />
            </div>

            <div class="flex flex-col gap-1">
              <label
                for="mihLoginPassword"
                class="caps-label text-gray-300"
              >
                Password
              </label>

              <input
                id="mihLoginPassword"
                type="password"
                class="w-full rounded-full border border-slate-600 bg-transparent text-sm px-4 py-2 focus:outline-none focus:border-slate-300"
                placeholder="Simple is fine. This never leaves your browser."
              />
            </div>

            <div class="flex flex-wrap gap-3 items-center mt-2">
              <button
                id="mihLoginButton"
                type="button"
                class="px-6 py-2 rounded-full bg-white text-black text-sm font-medium hover:bg-gray-100"
              >
                Log in or create account
              </button>

              <button
                id="mihLogoutButton"
                type="button"
                class="px-6 py-2 rounded-full border border-slate-500 text-xs text-slate-200 hover:bg-white/10"
              >
                Log out current user
              </button>
            </div>

            <!-- Current user display -->
            <p
              id="mihCurrentUserLabel"
              class="text-xs text-gray-400 mt-2"
            >
              No one is logged in yet.
            </p>
          </div>

          <!-- Right side info -->
          <div class="flex flex-col gap-4 text-xs text-gray-300">
            <div>
              <h2 class="caps-label text-gray-400 mb-1">
                Data and privacy
              </h2>

              <p>
                Your Make It Happen account and all of your activity logs live in your own browser storage. SEP does not
                send them to any server. If you clear your browser data, they will disappear.
              </p>
            </div>

            <div>
              <h2 class="caps-label text-gray-400 mb-1">
                Account cleanup
              </h2>

              <p>
                Accounts that have been logged out for more than 30 days can be removed automatically together with
                their activities. This keeps the leaderboard honest and light.
              </p>
            </div>

            <div>
              <h2 class="caps-label text-gray-400 mb-1">
                After login
              </h2>

              <p>
                Once you are logged in, go to the leaderboard view to add your first run, walk or ride and see how you
                rank against other people in your league.
              </p>
            </div>
          </div>
        </div>

        <!-- Short navigation row -->
        <div class="mt-8 flex flex-wrap gap-3 text-xs">
          <button
            type="button"
            class="px-4 py-2 rounded-full border border-white/20 text-white hover:bg-white/10"
            data-scene-target="mih-leaderboard"
          >
            Go to leaderboard
          </button>

          <button
            type="button"
            class="px-4 py-2 rounded-full border border-white/20 text-white hover:bg-white/10"
            data-scene-target="sep-shop"
          >
            Back to SEP
          </button>
        </div>
      </div>
    </div>
  </section>

  <!-- ========================================================= -->
  <!-- SCENE: MIH LEADERBOARD                                    -->
  <!-- ========================================================= -->
  <section
    id="scene-mih-leaderboard"
    class="scene"
  >
    <div
      class="min-h-screen bg-slate-950 text-white px-6 py-24 flex items-start"
    >
      <div class="sep-section-max mx-auto w-full fade-section">
        <!-- Header with filters and navigation -->
        <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-8">
          <div>
            <h1 class="text-2xl md:text-3xl font-semibold tracking-tight mb-2">
              Make It Happen leaderboard
            </h1>

            <p class="text-sm md:text-base text-gray-300 max-w-xl">
              Log your distance and time every time you run, walk or cycle. The board below shows total distance per
              participant plus simple stats so you can track your own progress.
            </p>
          </div>

          <div class="flex flex-wrap gap-3 text-xs">
            <button
              type="button"
              class="px-4 py-2 rounded-full border border-white/25 text-white hover:bg-white/10"
              data-scene-target="mih-login"
            >
              Go to login
            </button>

            <button
              type="button"
              class="px-4 py-2 rounded-full border border-white/25 text-white hover:bg-white/10"
              data-scene-target="mih-stats"
            >
              Stats view
            </button>

            <button
              type="button"
              class="px-4 py-2 rounded-full border border-white/25 text-white hover:bg-white/10"
              data-scene-target="sep-shop"
            >
              Back to SEP
            </button>
          </div>
        </div>

        <!-- Main two column layout -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12">
          <!-- Left: add activity form -->
          <div class="mih-card p-6 flex flex-col gap-4">
            <h2 class="text-lg font-semibold mb-1">
              Add a new activity
            </h2>

            <p class="text-xs text-gray-300 mb-2">
              You need to be logged in to add a new entry. Your name is pulled from your account and cannot be changed
              here.
            </p>

            <div class="flex flex-col gap-3">
              <div class="flex flex-col gap-1">
                <label
                  for="mihEntryName"
                  class="caps-label text-gray-400"
                >
                  Name
                </label>

                <input
                  id="mihEntryName"
                  type="text"
                  class="w-full rounded-full border border-slate-600 bg-transparent text-sm px-4 py-2 text-gray-400"
                  disabled
                  placeholder="Log in to see your name here"
                />
              </div>

              <div class="flex flex-col gap-1">
                <label
                  for="mihEntryDistance"
                  class="caps-label text-gray-400"
                >
                  Distance (km)
                </label>

                <input
                  id="mihEntryDistance"
                  type="number"
                  min="0"
                  step="0.01"
                  class="w-full rounded-full border border-slate-600 bg-transparent text-sm px-4 py-2 focus:outline-none focus:border-slate-300"
                  placeholder="For example 2.5"
                />
              </div>

              <div class="flex flex-col gap-1">
                <label
                  for="mihEntryTime"
                  class="caps-label text-gray-400"
                >
                  Time (minutes)
                </label>

                <input
                  id="mihEntryTime"
                  type="number"
                  min="0"
                  step="1"
                  class="w-full rounded-full border border-slate-600 bg-transparent text-sm px-4 py-2 focus:outline-none focus:border-slate-300"
                  placeholder="For example 22"
                />
              </div>

              <button
                id="mihSaveEntryButton"
                type="button"
                class="mt-2 px-6 py-2 rounded-full bg-white text-black text-sm font-medium hover:bg-gray-100"
              >
                Save my activity
              </button>
            </div>

            <div class="mt-4 text-xs text-gray-300">
              <h3 class="caps-label text-gray-400 mb-1">
                How ranking works
              </h3>

              <p class="mb-1">
                The leaderboard shows people with the highest total distance at the top inside each league.
              </p>

              <p class="mb-1">
                It also takes into account how many sessions you complete and how your average pace improves over time.
              </p>

              <p>
                Short runs still count. The goal is consistency rather than perfection.
              </p>
            </div>
          </div>

          <!-- Right: leaderboard table -->
          <div class="mih-card p-6 flex flex-col gap-4">
            <div class="flex items-center justify-between mb-2">
              <h2 class="text-lg font-semibold">
                Leaderboard
              </h2>

              <div class="flex items-center gap-2 text-xs">
                <label
                  for="mihLeagueFilter"
                  class="caps-label text-gray-400"
                >
                  League filter
                </label>

                <select
                  id="mihLeagueFilter"
                  class="rounded-full border border-slate-600 bg-transparent text-xs px-3 py-1 focus:outline-none focus:border-slate-300"
                >
                  <option value="all">
                    All leagues
                  </option>
                  <option value="amateurs">
                    Amateurs
                  </option>
                  <option value="intermediates">
                    Intermediates
                  </option>
                  <option value="pros">
                    Pros
                  </option>
                  <option value="legends">
                    Legends
                  </option>
                </select>
              </div>
            </div>

            <!-- Table wrapper -->
            <div class="overflow-x-auto text-xs">
              <table class="mih-table">
                <thead>
                  <tr class="text-gray-400">
                    <th class="text-left">
                      #
                    </th>
                    <th class="text-left">
                      Name
                    </th>
                    <th class="text-left">
                      League
                    </th>
                    <th class="text-right">
                      Total km
                    </th>
                    <th class="text-right">
                      Total min
                    </th>
                    <th class="text-right">
                      Avg km
                    </th>
                  </tr>
                </thead>

                <tbody id="mihLeaderboardBody">
                  <!-- Filled by JavaScript -->
                </tbody>
              </table>
            </div>

            <p
              id="mihLeaderboardEmptyMessage"
              class="text-xs text-gray-500 mt-2"
            >
              No entries yet. Log in, add your first activity and you will appear here.
            </p>
          </div>
        </div>

        <!-- Healthy / Free / Fun blocks and privacy note -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-5 mb-10 text-xs text-gray-300 fade-section">
          <article class="mih-card p-5 flex flex-col gap-2">
            <h2 class="caps-label text-green-400">
              Healthy
            </h2>

            <p>
              This is for older runners, heavier runners, busy parents and complete beginners. No punishment for going
              slow. Only credit for showing up.
            </p>
          </article>

          <article class="mih-card p-5 flex flex-col gap-2">
            <h2 class="caps-label text-blue-400">
              Free
            </h2>

            <p>
              There is no subscription, no paid tier and no hidden features. It is a simple board that rewards moving a
              bit more this month than last.
            </p>
          </article>

          <article class="mih-card p-5 flex flex-col gap-2">
            <h2 class="caps-label text-yellow-300">
              Fun
            </h2>

            <p>
              Friendly competition helps people stick to habits. The leagues mean everyone has someone close to their
              own level to chase.
            </p>
          </article>

          <article class="mih-card p-5 flex flex-col gap-2">
            <h2 class="caps-label text-gray-400">
              Data
            </h2>

            <p>
              All Make It Happen data lives only in this browser. No tracking scripts, no selling data, no ads that
              follow you. If you clear your storage, everything is gone.
            </p>
          </article>
        </div>

        <!-- My activities table -->
        <div class="mih-card p-6 fade-section">
          <div class="flex items-center justify-between mb-3">
            <h2 class="text-lg font-semibold">
              My activities
            </h2>

            <p
              id="mihMyActivitiesUserLabel"
              class="text-xs text-gray-400"
            >
              Not logged in yet.
            </p>
          </div>

          <div class="overflow-x-auto text-xs">
            <table class="mih-table">
              <thead>
                <tr class="text-gray-400">
                  <th class="text-left">
                    Date
                  </th>
                  <th class="text-right">
                    Distance (km)
                  </th>
                  <th class="text-right">
                    Time (min)
                  </th>
                  <th class="text-right">
                    Pace
                  </th>
                  <th class="text-right">
                    Actions
                  </th>
                </tr>
              </thead>

              <tbody id="mihMyActivitiesBody">
                <!-- Filled by JavaScript -->
              </tbody>
            </table>
          </div>

          <p
            id="mihMyActivitiesEmptyMessage"
            class="text-xs text-gray-500 mt-2"
          >
            Log in and add your first activity to see your own list here.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- ========================================================= -->
  <!-- SCENE: MIH STATS                                          -->
  <!-- ========================================================= -->
  <section
    id="scene-mih-stats"
    class="scene"
  >
    <div
      class="min-h-screen bg-slate-950 text-white px-6 py-24 flex items-start"
    >
      <div class="sep-section-max mx-auto w-full fade-section">
        <!-- Header -->
        <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-8">
          <div>
            <h1 class="text-2xl md:text-3xl font-semibold tracking-tight mb-2">
              Make It Happen stats
            </h1>

            <p class="text-sm md:text-base text-gray-300 max-w-xl">
              This view summarises runs per participant, total distance, total time, average distance, best distance and
              a simple improvement metric based on your pace over time.
            </p>
          </div>

          <div class="flex flex-wrap gap-3 text-xs">
            <button
              type="button"
              class="px-4 py-2 rounded-full border border-white/25 text-white hover:bg-white/10"
              data-scene-target="mih-leaderboard"
            >
              Back to leaderboard
            </button>

            <button
              type="button"
              class="px-4 py-2 rounded-full border border-white/25 text-white hover:bg-white/10"
              data-scene-target="sep-shop"
            >
              Back to SEP
            </button>
          </div>
        </div>

        <!-- Stats table -->
        <div class="mih-card p-6">
          <div class="flex items-center justify-between mb-3">
            <h2 class="text-lg font-semibold">
              Participant stats
            </h2>

            <p
              id="mihStatsSummaryLabel"
              class="text-xs text-gray-400"
            >
              No stats yet.
            </p>
          </div>

          <div class="overflow-x-auto text-xs">
            <table class="mih-table">
              <thead>
                <tr class="text-gray-400">
                  <th class="text-left">
                    Name
                  </th>
                  <th class="text-left">
                    League
                  </th>
                  <th class="text-right">
                    Runs
                  </th>
                  <th class="text-right">
                    Total km
                  </th>
                  <th class="text-right">
                    Total min
                  </th>
                  <th class="text-right">
                    Avg km
                  </th>
                  <th class="text-right">
                    Best km
                  </th>
                  <th class="text-right">
                    Improvement
                  </th>
                </tr>
              </thead>

              <tbody id="mihStatsBody">
                <!-- Filled by JavaScript -->
              </tbody>
            </table>
          </div>

          <p
            id="mihStatsEmptyMessage"
            class="text-xs text-gray-500 mt-2"
          >
            Once people start logging activities, each name will appear here with a summary of their progress.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- ========================================================= -->
  <!-- SCENE: MIH PROFILE                                        -->
  <!-- ========================================================= -->
  <section
    id="scene-mih-profile"
    class="scene"
  >
    <div
      class="min-h-screen bg-slate-950 text-white px-6 py-24 flex items-start"
    >
      <div class="sep-section-max mx-auto w-full fade-section">
        <!-- Header -->
        <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-8">
          <div>
            <h1
              id="mihProfileTitle"
              class="text-2xl md:text-3xl font-semibold tracking-tight mb-2"
            >
              Runner profile
            </h1>

            <p class="text-sm md:text-base text-gray-300 max-w-xl">
              Simple profile view for one runner. It shows basic totals, averages and rough estimated best times based
              on your current average pace.
            </p>
          </div>

          <button
            type="button"
            class="px-4 py-2 rounded-full border border-white/25 text-white text-xs hover:bg-white/10"
            data-scene-target="mih-leaderboard"
          >
            ← Back to leaderboard
          </button>
        </div>

        <!-- Profile card -->
        <div class="mih-card p-6 md:p-8 grid grid-cols-1 md:grid-cols-3 gap-6">
          <!-- Left: basics -->
          <div class="md:col-span-1 flex flex-col gap-4">
            <div>
              <p class="profile-label mb-1">
                Name
              </p>

              <p
                id="mihProfileName"
                class="profile-value"
              >
                -
              </p>
            </div>

            <div>
              <p class="profile-label mb-1">
                League
              </p>

              <p
                id="mihProfileLeague"
                class="profile-value"
              >
                -
              </p>
            </div>

            <div>
              <p class="profile-label mb-1">
                Runs
              </p>

              <p
                id="mihProfileRuns"
                class="profile-value"
              >
                0
              </p>
            </div>
          </div>

          <!-- Middle: distance and time -->
          <div class="md:col-span-1 flex flex-col gap-4">
            <div>
              <p class="profile-label mb-1">
                Total distance
              </p>

              <p
                id="mihProfileTotalKm"
                class="profile-value"
              >
                0 km
              </p>
            </div>

            <div>
              <p class="profile-label mb-1">
                Total time
              </p>

              <p
                id="mihProfileTotalMin"
                class="profile-value"
              >
                0 minutes
              </p>
            </div>

            <div>
              <p class="profile-label mb-1">
                Average distance
              </p>

              <p
                id="mihProfileAvgKm"
                class="profile-value"
              >
                0 km
              </p>
            </div>
          </div>

          <!-- Right: estimated best times -->
          <div class="md:col-span-1 flex flex-col gap-4">
            <div>
              <p class="profile-label mb-1">
                Estimated 5 km
              </p>

              <p
                id="mihProfileEstimate5k"
                class="profile-value"
              >
                -
              </p>
            </div>

            <div>
              <p class="profile-label mb-1">
                Estimated 10 km
              </p>

              <p
                id="mihProfileEstimate10k"
                class="profile-value"
              >
                -
              </p>
            </div>

            <div>
              <p class="profile-label mb-1">
                Estimated 100 m
              </p>

              <p
                id="mihProfileEstimate100m"
                class="profile-value"
              >
                -
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- ========================================================= -->
  <!-- SCENE: MIH ABOUT                                          -->
  <!-- ========================================================= -->
  <section
    id="scene-mih-about"
    class="scene"
  >
    <div
      class="min-h-screen bg-slate-950 text-white px-6 py-24 flex items-center"
    >
      <div class="sep-section-max mx-auto fade-section">
        <!-- Back chip -->
        <button
          type="button"
          class="mb-8 inline-flex items-center gap-2 px-4 py-2 rounded-full border border-white/20 text-xs text-gray-300 hover:bg-white/5"
          data-scene-target="mih-welcome"
        >
          <span>
            ←
          </span>
          <span>
            Back to Make It Happen
          </span>
        </button>

        <!-- Title and copy -->
        <h1 class="text-3xl md:text-4xl font-semibold tracking-tight mb-6">
          What Make It Happen is about
        </h1>

        <p class="text-sm md:text-base text-gray-200 mb-5 max-w-3xl">
          Make It Happen started as a tiny experiment. One simple leaderboard can push people to move more, even when
          there is no time for a big training plan. The idea is to reward consistency and small steps rather than
          perfection.
        </p>

        <p class="text-sm md:text-base text-gray-200 mb-5 max-w-3xl">
          It is built for older runners, heavier runners, busy parents and complete beginners. People who might not feel
          at home inside a traditional running club but still want a bit of structure and a gentle push.
        </p>

        <p class="text-sm md:text-base text-gray-200 mb-5 max-w-3xl">
          There is no subscription, no app, no upgrade path. Just four leagues, a few stats and a clear way to see that
          this month you did more than last month.
        </p>

        <p class="text-sm md:text-base text-gray-200 mb-8 max-w-3xl">
          All data lives in your browser. SEP does not use third party analytics, does not sell any data and does not
          have tracking pixels. If you are not comfortable with that, you can simply not use the leaderboard and still
          read the guidance for free.
        </p>

        <!-- Buttons row -->
        <div class="flex flex-wrap gap-4">
          <button
            type="button"
            class="inline-flex items-center justify-center px-6 py-3 rounded-full bg-white text-black text-sm font-medium hover:bg-gray-100"
            data-scene-target="mih-leaderboard"
          >
            Go to leaderboard
          </button>

          <button
            type="button"
            class="inline-flex items-center justify-center px-6 py-3 rounded-full border border-white/30 text-sm text-white hover:bg-white/10"
            data-scene-target="sep-shop"
          >
            Back to SEP
          </button>
        </div>
      </div>
    </div>
  </section>

  <!-- ========================================================= -->
  <!-- GLOBAL POPUP TOAST (USED BY CART + MIH)                   -->
  <!-- ========================================================= -->
  <div
    id="popupToast"
    class="popup-toast"
    role="status"
    aria-live="polite"
  >
    <!-- Filled by JavaScript -->
  </div>

  <!-- ========================================================= -->
  <!-- END OF PART 2 OF 4                                        -->
  <!-- Next parts:                                               -->
  <!--   Part 3: Script - translations, nav, scene switching     -->
  <!--   Part 4: Script - cart, MobilePay, MIH logic, initAll    -->
  <!-- ========================================================= -->
  <!-- ========================================================= -->
  <!-- PART 3 OF 4                                               -->
  <!-- GLOBAL SCRIPT - TRANSLATIONS, NAV, SCENES, ANIMATION      -->
  <!-- Paste directly after Part 2 and before Part 4 closing     -->
  <!-- tags. This opens the single global <script> tag.          -->
  <!-- ========================================================= -->

  <script>
    // ============================================================
    // SEP + MIH - SINGLE PAGE APP SCRIPT
    // ------------------------------------------------------------
    // Structure:
    //   1. Translation keys and helpers - SEP only
    //   2. Global navigation and language buttons
    //   3. Scene switching helpers
    //   4. GSAP animations for fade sections and hero
    //   5. initAll() skeleton (SEP cart + MIH wired in Part 4)
    // ============================================================

    // ------------------------------------------------------------
    // 1. TRANSLATION KEYS AND HELPERS - SEP ONLY
    // ------------------------------------------------------------

    // Local storage key for language preference.
    const SEP_LANG_STORAGE_KEY =
      "sep_lang";

    // Supported language codes.
    const SEP_SUPPORTED_LANGS =
      ["en", "da", "cs"];

    // Current language in memory.
    let currentLang =
      "en";

    // Translations object.
    // Note:
    //   - Only SEP facing copy needs translation.
    //   - MIH copy stays in English unless changed later.
    //   - New keys can be added over time without breaking anything.
    const translations =
      {
        // --------------------------------------------------------
        // English - default
        // --------------------------------------------------------
        en: {
          // Global navigation
          nav_sep_shop:
            "SEP shop",
          nav_sep_about:
            "About SEP",
          nav_mih:
            "Make It Happen",
          nav_mih_about:
            "About Make It Happen",
          nav_language_label:
            "Language",

          // SEP hero section
          sep_hero_title:
            "Minimalist clothing made with intention.",
          sep_hero_subtitle:
            "Soft, clean and hand pressed in Copenhagen.",
          sep_hero_button_shop:
            "Shop now",
          sep_hero_button_cart:
            "View cart",

          // Product section
          sep_products_title:
            "Three pieces. One calm wardrobe.",
          sep_products_subtitle:
            "Soft fabrics, clean shapes and a slow approach to production.",

          sep_product_tshirt_name:
            "SEP white T shirt",
          sep_product_hoodie_name:
            "SEP black hoodie",
          sep_product_trousers_name:
            "SEP black trousers",

          sep_product_price:
            "180 kr.",

          sep_product_size_label:
            "Size",
          sep_product_quantity_label:
            "Quantity",
          sep_product_add_button:
            "Add",

          // Cart sidebar
          sep_cart_title:
            "Your cart",
          sep_cart_shipping_label:
            "Shipping destination",
          sep_cart_shipping_cph:
            "Copenhagen",
          sep_cart_shipping_dk:
            "Rest of Denmark",
          sep_cart_shipping_helper:
            "Copenhagen is free shipping. Rest of Denmark is +45 kr.",
          sep_cart_empty:
            "Your cart is empty.",
          sep_cart_subtotal_label:
            "Subtotal",
          sep_cart_shipping_cost_label:
            "Shipping",
          sep_cart_total_label:
            "Total",
          sep_cart_remove:
            "Remove",
          sep_cart_shipping_free_cph:
            "0 kr. (Free in Copenhagen)",
          sep_cart_shipping_paid_dk:
            "+45 kr.",

          sep_cart_mobilepay_button:
            "Open MobilePay",
          sep_cart_mobilepay_hint:
            "MobilePay only opens on phones that have the app installed.",
          sep_cart_copy_button:
            "Copy order message",

          // Cart popup messages
          sep_popup_added_to_cart:
            "Added to cart.",
          sep_popup_order_copied:
            "Order message copied.",
          sep_popup_mobilepay_thanks:
            "Thank you for supporting SEP.",

          // How to order section
          sep_how_title:
            "How to order",
          sep_how_step1_title:
            "1. Choose",
          sep_how_step1_body:
            "Pick your SEP piece and size. White T shirt, black hoodie or black trousers.",
          sep_how_step2_title:
            "2. Add to cart",
          sep_how_step2_body:
            "Add your items to the cart and check the quantities.",
          sep_how_step3_title:
            "3. Copy message",
          sep_how_step3_body:
            "Use the copy button in the cart to copy your full order.",
          sep_how_step4_title:
            "4. Pay with MobilePay",
          sep_how_step4_body:
            "Send the total to 5894BZ using MobilePay.",
          sep_how_step5_title:
            "5. Send your order",
          sep_how_step5_body:
            "Send your copied message as a DM to @seproairesis on Instagram or TikTok.",

          // Footer
          sep_footer_main:
            "SEP - Se Proairesis (Your choice). Minimal pieces, made with care in Copenhagen.",
          sep_footer_shipping:
            "+45 kr shipping inside Denmark - free in Copenhagen.",
          sep_footer_privacy:
            "No data selling. No creepy tracking. No ads that follow you around.",
          sep_footer_only_dk:
            "We currently deliver only within Denmark.",
          sep_footer_instagram:
            "Instagram",
          sep_footer_tiktok:
            "TikTok",

          // About SEP scene
          sep_about_title:
            "About SEP",
          sep_about_p1:
            "SEP comes from the Greek idea Se Proairesis, often translated as your choice. It is about the small everyday decisions that quietly shape how you live. What you wear, how you move, what you pay attention to. SEP is a calm brand built around those choices.",
          sep_about_p2:
            "Every piece is pressed by hand in Copenhagen in small runs. No big drops, no fast seasons, no hurry. The point is not to chase the next thing. It is to find a few pieces you rely on and wear until they feel like your own.",
          sep_about_p3:
            "That is why SEP keeps the collection minimal. A white T shirt. A black hoodie. A pair of black trousers. No constant releases. No hype drops. Just clothes that are soft, clean and designed to quietly work with the rest of your wardrobe.",
          sep_about_p4:
            "The same thinking applies to data. SEP does not track you across the internet, does not sell your data and does not use dark patterns. Your cart and your Make It Happen stats live only on your own device.",
          sep_about_back_chip:
            "Back to SEP shop",
          sep_about_button_back_shop:
            "Back to SEP shop",
          sep_about_button_to_mih:
            "Go to Make It Happen",

          // Order message template fragments
          sep_order_message_greeting:
            "Hi SEP. Here is my order:",
          sep_order_message_subtotal:
            "Subtotal",
          sep_order_message_shipping:
            "Shipping",
          sep_order_message_total:
            "Total"
        },

        // --------------------------------------------------------
        // Danish
        // --------------------------------------------------------
        da: {
          // Global navigation
          nav_sep_shop:
            "SEP butik",
          nav_sep_about:
            "Om SEP",
          nav_mih:
            "Make It Happen",
          nav_mih_about:
            "Om Make It Happen",
          nav_language_label:
            "Sprog",

          // SEP hero
          sep_hero_title:
            "Minimalistisk tøj lavet med omtanke.",
          sep_hero_subtitle:
            "Blødt, rent og håndpresset i København.",
          sep_hero_button_shop:
            "Shop nu",
          sep_hero_button_cart:
            "Se kurv",

          // Product section
          sep_products_title:
            "Tre dele. En rolig garderobe.",
          sep_products_subtitle:
            "Bløde materialer, rene linjer og en langsom tilgang til produktion.",

          sep_product_tshirt_name:
            "SEP hvid T shirt",
          sep_product_hoodie_name:
            "SEP sort hættetrøje",
          sep_product_trousers_name:
            "SEP sorte bukser",

          sep_product_price:
            "180 kr.",

          sep_product_size_label:
            "Størrelse",
          sep_product_quantity_label:
            "Antal",
          sep_product_add_button:
            "Læg i kurv",

          // Cart sidebar
          sep_cart_title:
            "Din kurv",
          sep_cart_shipping_label:
            "Levering",
          sep_cart_shipping_cph:
            "København",
          sep_cart_shipping_dk:
            "Resten af Danmark",
          sep_cart_shipping_helper:
            "København er gratis levering. Resten af Danmark er +45 kr.",
          sep_cart_empty:
            "Din kurv er tom.",
          sep_cart_subtotal_label:
            "Subtotal",
          sep_cart_shipping_cost_label:
            "Fragt",
          sep_cart_total_label:
            "I alt",
          sep_cart_remove:
            "Fjern",
          sep_cart_shipping_free_cph:
            "0 kr. (Gratis i København)",
          sep_cart_shipping_paid_dk:
            "+45 kr.",

          sep_cart_mobilepay_button:
            "Åbn MobilePay",
          sep_cart_mobilepay_hint:
            "MobilePay åbner kun på telefoner der har appen.",
          sep_cart_copy_button:
            "Kopiér ordretekst",

          // Cart popup messages
          sep_popup_added_to_cart:
            "Lagt i kurven.",
          sep_popup_order_copied:
            "Ordretekst kopieret.",
          sep_popup_mobilepay_thanks:
            "Tak fordi du støtter SEP.",

          // How to order section
          sep_how_title:
            "Sådan bestiller du",
          sep_how_step1_title:
            "1. Vælg",
          sep_how_step1_body:
            "Vælg dit SEP produkt og størrelse. Hvid T shirt, sort hættetrøje eller sorte bukser.",
          sep_how_step2_title:
            "2. Læg i kurv",
          sep_how_step2_body:
            "Læg dine valg i kurven og tjek antal.",
          sep_how_step3_title:
            "3. Kopiér besked",
          sep_how_step3_body:
            "Brug kopi knappen i kurven til at kopiere din samlede ordre.",
          sep_how_step4_title:
            "4. Betal med MobilePay",
          sep_how_step4_body:
            "Send beløbet til 5894BZ via MobilePay.",
          sep_how_step5_title:
            "5. Send ordren",
          sep_how_step5_body:
            "Send din kopierede tekst som DM til @seproairesis på Instagram eller TikTok.",

          // Footer
          sep_footer_main:
            "SEP - Se Proairesis (Dit valg). Få dele, lavet med omtanke i København.",
          sep_footer_shipping:
            "+45 kr fragt i Danmark - gratis i København.",
          sep_footer_privacy:
            "Ingen datasalg. Ingen uhyggelig tracking. Ingen annoncer der følger dig rundt.",
          sep_footer_only_dk:
            "Vi leverer lige nu kun i Danmark.",
          sep_footer_instagram:
            "Instagram",
          sep_footer_tiktok:
            "TikTok",

          // About SEP scene
          sep_about_title:
            "Om SEP",
          sep_about_p1:
            "SEP kommer af den græske idé Se Proairesis, ofte oversat til dit valg. Det handler om de små beslutninger i hverdagen, der stille former hvordan du lever. Hvad du har på, hvordan du bevæger dig, hvad du lægger mærke til. SEP er et roligt brand bygget omkring de valg.",
          sep_about_p2:
            "Hver del bliver presset i hånden i København i små serier. Ingen store drops, ingen hurtige sæsoner, ingen stress. Pointen er ikke at jagte det næste. Det er at finde få ting du bruger igen og igen, til de føles som dine egne.",
          sep_about_p3:
            "Derfor holder SEP kollektionen enkel. En hvid T shirt. En sort hættetrøje. Et par sorte bukser. Ingen konstante releases. Ingen hype drops. Bare tøj der er blødt, rent og passer stille sammen med resten af din garderobe.",
          sep_about_p4:
            "Den samme tanke gælder data. SEP tracker dig ikke på nettet, sælger ikke dine data og bruger ikke mørke tricks. Din kurv og dine Make It Happen tal ligger kun på din egen enhed.",
          sep_about_back_chip:
            "Tilbage til SEP butik",
          sep_about_button_back_shop:
            "Tilbage til SEP butik",
          sep_about_button_to_mih:
            "Gå til Make It Happen",

          // Order message fragments
          sep_order_message_greeting:
            "Hej SEP. Her er min ordre:",
          sep_order_message_subtotal:
            "Subtotal",
          sep_order_message_shipping:
            "Fragt",
          sep_order_message_total:
            "I alt"
        },

        // --------------------------------------------------------
        // Czech
        // --------------------------------------------------------
        cs: {
          // Global navigation
          nav_sep_shop:
            "Obchod SEP",
          nav_sep_about:
            "O značce SEP",
          nav_mih:
            "Make It Happen",
          nav_mih_about:
            "O Make It Happen",
          nav_language_label:
            "Jazyk",

          // SEP hero
          sep_hero_title:
            "Minimalistické oblečení vytvořené s úmyslem.",
          sep_hero_subtitle:
            "Měkké, čisté a ručně lisované v Kodani.",
          sep_hero_button_shop:
            "Do obchodu",
          sep_hero_button_cart:
            "Zobrazit košík",

          // Product section
          sep_products_title:
            "Tři kusy. Jeden klidný šatník.",
          sep_products_subtitle:
            "Měkké materiály, čisté linie a pomalý přístup k výrobě.",

          sep_product_tshirt_name:
            "SEP bílé tričko",
          sep_product_hoodie_name:
            "SEP černá mikina s kapucí",
          sep_product_trousers_name:
            "SEP černé kalhoty",

          sep_product_price:
            "180 kr.",

          sep_product_size_label:
            "Velikost",
          sep_product_quantity_label:
            "Počet kusů",
          sep_product_add_button:
            "Přidat do košíku",

          // Cart sidebar
          sep_cart_title:
            "Váš košík",
          sep_cart_shipping_label:
            "Doručení",
          sep_cart_shipping_cph:
            "Kodaň",
          sep_cart_shipping_dk:
            "Zbytek Dánska",
          sep_cart_shipping_helper:
            "Kodaň má dopravu zdarma. Zbytek Dánska stojí +45 kr.",
          sep_cart_empty:
            "Váš košík je prázdný.",
          sep_cart_subtotal_label:
            "Mezisoučet",
          sep_cart_shipping_cost_label:
            "Doprava",
          sep_cart_total_label:
            "Celkem",
          sep_cart_remove:
            "Odebrat",
          sep_cart_shipping_free_cph:
            "0 kr. (Zdarma v Kodani)",
          sep_cart_shipping_paid_dk:
            "+45 kr.",

          sep_cart_mobilepay_button:
            "Otevřít MobilePay",
          sep_cart_mobilepay_hint:
            "MobilePay se otevře pouze na telefonech s nainstalovanou aplikací.",
          sep_cart_copy_button:
            "Kopírovat objednávku",

          // Cart popup messages
          sep_popup_added_to_cart:
            "Přidáno do košíku.",
          sep_popup_order_copied:
            "Text objednávky zkopírován.",
          sep_popup_mobilepay_thanks:
            "Děkujeme za podporu značky SEP.",

          // How to order section
          sep_how_title:
            "Jak objednat",
          sep_how_step1_title:
            "1. Vyberte",
          sep_how_step1_body:
            "Vyberte produkt SEP a velikost. Bílé tričko, černá mikina nebo černé kalhoty.",
          sep_how_step2_title:
            "2. Přidejte do košíku",
          sep_how_step2_body:
            "Přidejte vybrané položky do košíku a zkontrolujte počet kusů.",
          sep_how_step3_title:
            "3. Zkopírujte zprávu",
          sep_how_step3_body:
            "V košíku použijte tlačítko kopírovat pro zkopírování celé objednávky.",
          sep_how_step4_title:
            "4. Zaplaťte MobilePay",
          sep_how_step4_body:
            "Pošlete částku na 5894BZ přes MobilePay.",
          sep_how_step5_title:
            "5. Pošlete objednávku",
          sep_how_step5_body:
            "Pošlete zkopírovaný text jako zprávu na @seproairesis na Instagramu nebo TikToku.",

          // Footer
          sep_footer_main:
            "SEP - Se Proairesis (Vaše volba). Několik kusů oblečení, vytvořených s péčí v Kodani.",
          sep_footer_shipping:
            "+45 kr za dopravu v Dánsku - zdarma v Kodani.",
          sep_footer_privacy:
            "Žádný prodej dat. Žádné sledování. Žádné reklamy, které vás pronásledují.",
          sep_footer_only_dk:
            "Aktuálně doručujeme pouze v rámci Dánska.",
          sep_footer_instagram:
            "Instagram",
          sep_footer_tiktok:
            "TikTok",

          // About SEP scene
          sep_about_title:
            "O značce SEP",
          sep_about_p1:
            "Název SEP pochází z řecké myšlenky Se Proairesis, často překládané jako vaše volba. Jde o malé každodenní volby, které nenápadně formují to, jak žijete. Co nosíte, jak se hýbete, čemu věnujete pozornost. SEP je klidná značka postavená na těchto volbách.",
          sep_about_p2:
            "Každý kus je ručně lisovaný v Kodani v malých sériích. Žádné velké dropy, žádné rychlé sezony, žádný spěch. Smyslem není honit další novinku, ale najít pár věcí, které nosíte tak dlouho, až se stanou vaší součástí.",
          sep_about_p3:
            "Proto zůstává kolekce SEP minimalistická. Bílé tričko. Černá mikina. Černé kalhoty. Žádné neustálé novinky. Žádné hype dropy. Jen oblečení, které je měkké, čisté a klidně zapadne do zbytku vašeho šatníku.",
          sep_about_p4:
            "Stejný přístup platí i pro data. SEP vás nesleduje po internetu, neprodává vaše údaje a nepoužívá triky v rozhraní. Váš košík a statistiky Make It Happen žijí jen ve vašem zařízení.",
          sep_about_back_chip:
            "Zpět do obchodu SEP",
          sep_about_button_back_shop:
            "Zpět do obchodu SEP",
          sep_about_button_to_mih:
            "Přejít na Make It Happen",

          // Order message fragments
          sep_order_message_greeting:
            "Ahoj SEP. Tady je moje objednávka:",
          sep_order_message_subtotal:
            "Mezisoučet",
          sep_order_message_shipping:
            "Doprava",
          sep_order_message_total:
            "Celkem"
        }
      };

    /**
     * Helper - find a safe translation for a key.
     * Prefers the current language, falls back to English, then to the key itself.
     */
    function t(
      key
    ) {
      if (
        translations[
          currentLang
        ] &&
        Object
          .prototype
          .hasOwnProperty
          .call(
            translations[
              currentLang
            ],
            key
          )
      ) {
        return (
          translations[
            currentLang
          ][
            key
          ]
        );
      }

      if (
        translations
          .en &&
        Object
          .prototype
          .hasOwnProperty
          .call(
            translations
              .en,
            key
          )
      ) {
        return (
          translations
            .en[
            key
          ]
        );
      }

      return (
        key
      );
    }

    /**
     * Apply translations to all elements that declare a data-i18n key.
     * Inner HTML is replaced with translated text.
     */
    function applyTranslations() {
      const translatableNodes =
        document
          .querySelectorAll(
            "[data-i18n]"
          );

      translatableNodes
        .forEach(
          function handleNode(
            node
          ) {
            const key =
              node
                .getAttribute(
                  "data-i18n"
                );

            if (
              !key
            ) {
              return;
            }

            node
              .innerHTML =
              t(
                key
              );
          }
        );
    }

    /**
     * Decide which language to use on first load.
     * Priority:
     *   1. Local storage value if valid.
     *   2. Navigator language short code if supported.
     *   3. Default to English.
     */
    function getInitialLanguage() {
      const storedLang =
        window
          .localStorage
          .getItem(
            SEP_LANG_STORAGE_KEY
          );

      if (
        storedLang &&
        SEP_SUPPORTED_LANGS
          .includes(
            storedLang
          )
      ) {
        return (
          storedLang
        );
      }

      const browserLang =
        (
          navigator
            .language ||
          navigator
            .userLanguage ||
          ""
        )
          .split(
            "-"
          )[0]
          .toLowerCase();

      if (
        SEP_SUPPORTED_LANGS
          .includes(
            browserLang
          )
      ) {
        return (
          browserLang
        );
      }

      return (
        "en"
      );
    }

    /**
     * Update the in memory language, persist to storage and refresh buttons + strings.
     */
    function setLanguage(
      lang,
      shouldPersist
    ) {
      if (
        typeof shouldPersist ===
        "undefined"
      ) {
        shouldPersist =
          true;
      }

      if (
        !SEP_SUPPORTED_LANGS
          .includes(
            lang
          )
      ) {
        lang =
          "en";
      }

      currentLang =
        lang;

      if (
        shouldPersist
      ) {
        try {
          window
            .localStorage
            .setItem(
              SEP_LANG_STORAGE_KEY,
              lang
            );
        } catch (storageError) {
          // Storage failures are not critical here.
        }
      }

      applyTranslations();
      updateLanguageButtons();
    }

    /**
     * Update visual state of language selector buttons.
     * Active language gets a filled style, others are outlined.
     */
    function updateLanguageButtons() {
      const langButtons =
        document
          .querySelectorAll(
            ".lang-btn"
          );

      langButtons
        .forEach(
          function handleButton(
            btn
          ) {
            const btnLang =
              btn
                .getAttribute(
                  "data-lang"
                );

            if (
              btnLang ===
              currentLang
            ) {
              btn
                .classList
                .add(
                  "bg-white"
                );

              btn
                .classList
                .add(
                  "text-black"
                );

              btn
                .classList
                .remove(
                  "bg-transparent"
                );

              btn
                .classList
                .remove(
                  "text-gray-200"
                );
            } else {
              btn
                .classList
                .remove(
                  "bg-white"
                );

              btn
                .classList
                .remove(
                  "text-black"
                );

              btn
                .classList
                .add(
                  "bg-transparent"
                );

              btn
                .classList
                .add(
                  "text-gray-200"
                );
            }
          }
        );
    }

    // ------------------------------------------------------------
    // 2. GLOBAL NAVIGATION AND LANGUAGE BUTTONS
    // ------------------------------------------------------------

    /**
     * Attach click handler to the global menu button and nav links.
     * Nav markup is defined in Part 1.
     */
    function initGlobalNav() {
      const navContainer =
        document
          .getElementById(
            "globalNavButtons"
          );

      const navToggle =
        document
          .getElementById(
            "mainNavToggle"
          );

      const navMenu =
        document
          .getElementById(
            "navMenu"
          );

      if (
        navToggle &&
        navMenu
      ) {
        navToggle
          .addEventListener(
            "click",
            function handleNavToggle() {
              const isHidden =
                navMenu
                  .classList
                  .contains(
                    "hidden"
                  );

              if (
                isHidden
              ) {
                navMenu
                  .classList
                  .remove(
                    "hidden"
                  );
              } else {
                navMenu
                  .classList
                  .add(
                    "hidden"
                  );
              }
            }
          );
      }

      // Delegate click events for nav items that should switch scenes.
      if (
        navMenu
      ) {
        navMenu
          .addEventListener(
            "click",
            function handleNavMenuClick(
              event
            ) {
              const target =
                event
                  .target;

              if (
                !target
              ) {
                return;
              }

              const sceneTarget =
                target
                  .getAttribute(
                    "data-scene-target"
                  );

              if (
                sceneTarget
              ) {
                showScene(
                  sceneTarget
                );

                navMenu
                  .classList
                  .add(
                    "hidden"
                  );
              }
            }
          );
      }

      // Language buttons inside the global nav.
      const langButtons =
        document
          .querySelectorAll(
            ".lang-btn"
          );

      langButtons
        .forEach(
          function bindLangButton(
            btn
          ) {
            const lang =
              btn
                .getAttribute(
                  "data-lang"
                );

            btn
              .addEventListener(
                "click",
                function handleLangClick() {
                  setLanguage(
                    lang,
                    true
                  );
                }
              );
          }
        );

      // Small guard for when cart opens and we want to soften nav.
      if (
        navContainer
      ) {
        navContainer
          .dataset
          .navReady =
          "true";
      }
    }

    /**
     * Helper - fade nav when a modal or cart is open.
     * Called by cart logic in Part 4.
     */
    function setNavMuted(
      isMuted
    ) {
      const navContainer =
        document
          .getElementById(
            "globalNavButtons"
          );

      if (
        !navContainer
      ) {
        return;
      }

      if (
        isMuted
      ) {
        navContainer
          .style
          .opacity =
          "0.2";
      } else {
        navContainer
          .style
          .opacity =
          "1";
      }
    }

    // ------------------------------------------------------------
    // 3. SCENE SWITCHING HELPERS
    // ------------------------------------------------------------

    /**
     * Show a scene by its short name.
     * Example:
     *   showScene("sep-shop") will show section#scene-sep-shop.
     */
    function showScene(
      name
    ) {
      const allScenes =
        document
          .querySelectorAll(
            ".scene"
          );

      allScenes
        .forEach(
          function hideScene(
            scene
          ) {
            scene
              .classList
              .remove(
                "active"
              );
          }
        );

      const sceneId =
        "scene-" +
        name;

      const targetScene =
        document
          .getElementById(
            sceneId
          );

      if (
        targetScene
      ) {
        targetScene
          .classList
          .add(
            "active"
          );
      }

      // Always scroll user back to the top when switching.
      window
        .scrollTo(
          {
            top:
              0,
            left:
              0,
            behavior:
              "instant"
          }
        );
    }

    /**
     * Attach behaviour to any element with data-scene-target attribute.
     * This allows buttons and links all over the page to switch scenes without inline JS.
     */
    function wireSceneButtons() {
      const sceneButtons =
        document
          .querySelectorAll(
            "[data-scene-target]"
          );

      sceneButtons
        .forEach(
          function handleSceneButton(
            btn
          ) {
            btn
              .addEventListener(
                "click",
                function handleSceneClick(
                  event
                ) {
                  const targetSceneName =
                    btn
                      .getAttribute(
                        "data-scene-target"
                      );

                  if (
                    targetSceneName
                  ) {
                    showScene(
                      targetSceneName
                    );
                  }
                }
              );
          }
        );
    }

    // ------------------------------------------------------------
    // 4. GSAP ANIMATIONS
    // ------------------------------------------------------------

    /**
     * Initialise GSAP powered fade in animations.
     * Requires gsap and ScrollTrigger to be loaded in the head.
     */
    function initAnimations() {
      if (
        typeof gsap ===
        "undefined"
      ) {
        return;
      }

      if (
        typeof ScrollTrigger ===
        "undefined"
      ) {
        return;
      }

      gsap
        .registerPlugin(
          ScrollTrigger
        );

      // Fade and lift sections as they come into view.
      const fadeSections =
        document
          .querySelectorAll(
            ".fade-section"
          );

      fadeSections
        .forEach(
          function handleFadeSection(
            section
          ) {
            gsap
              .fromTo(
                section,
                {
                  opacity:
                    0,
                  y:
                    32
                },
                {
                  opacity:
                    1,
                  y:
                    0,
                  duration:
                    1.0,
                  ease:
                    "power2.out",
                  scrollTrigger:
                    {
                      trigger:
                        section,
                      start:
                        "top 80%",
                      toggleActions:
                        "play none none none"
                    }
                }
              );
          }
        );

      // Optional hero motion for SEP hero if present.
      const sepHero =
        document
          .querySelector(
            "[data-sep-hero]"
          );

      if (
        sepHero
      ) {
        gsap
          .fromTo(
            sepHero,
            {
              opacity:
                0,
              y:
                16
            },
            {
              opacity:
                1,
              y:
                0,
              duration:
                1.2,
              ease:
                "power2.out"
            }
          );
      }
    }

    // ------------------------------------------------------------
    // 5. INIT ALL - SKELETON
    // ------------------------------------------------------------

    /**
     * Global init sequence.
     * Part 4 will define:
     *   - initSepCart()
     *   - initMakeItHappen()
     *   - any additional helpers
     * and this function will call them.
     */
    function initAll() {
      // 1. Language
      const initialLang =
        getInitialLanguage();

      setLanguage(
        initialLang,
        false
      );

      // 2. Navigation and scene buttons
      initGlobalNav();
      wireSceneButtons();

      // 3. Animations
      initAnimations();

      // 4. SEP cart logic - defined in Part 4
      if (
        typeof initSepCart ===
        "function"
      ) {
        initSepCart();
      }

      // 5. Make It Happen logic - defined in Part 4
      if (
        typeof initMakeItHappen ===
        "function"
      ) {
        initMakeItHappen();
      }
    }

    // Note:
    //   The script tag stays open.
    //   Part 4 will add:
    //     - Cart logic
    //     - MobilePay logic
    //     - MIH data model and rendering
    //     - initAll() call on DOM ready
    //   and then close the script and body/html tags.
    // ============================================================
    // 6. SEP CART LOGIC
    // ============================================================

    // Local storage key for the SEP cart.
    const SEP_CART_STORAGE_KEY =
      "sep_cart_v1";

    // MobilePay number for SEP.
    const SEP_MOBILEPAY_NUMBER =
      "5894BZ";

    // Shipping amounts.
    const SEP_SHIPPING_CPH =
      0;

    const SEP_SHIPPING_REST_DK =
      45;

    // In memory cart.
    // Each item:
    //   {
    //     name: string,
    //     price: number,
    //     size: string,
    //     qty: number
    //   }
    let sepCart =
      [];

    // Is shipping currently set to Copenhagen
    // or to the rest of Denmark.
    let sepShippingIsCopenhagen =
      false;

    /**
     * Convenience helper to create a small popup message.
     * Used for:
     *   - added to cart
     *   - order message copied
     *   - MobilePay thanks
     */
    function createPopup(
      message
    ) {
      const popup =
        document
          .createElement(
            "div"
          );

      popup
        .className =
        "popup";

      popup
        .textContent =
        message;

      document
        .body
        .appendChild(
          popup
        );

      window
        .setTimeout(
          function showPopup() {
            popup
              .classList
              .add(
                "show"
              );
          },
          10
        );

      window
        .setTimeout(
          function hidePopup() {
            popup
              .classList
              .remove(
                "show"
              );

            window
              .setTimeout(
                function removePopup() {
                  popup
                    .remove();
                },
                300
              );
          },
          2000
        );
    }

    /**
     * Read SEP cart from local storage.
     */
    function loadSepCartFromStorage() {
      try {
        const stored =
          window
            .localStorage
            .getItem(
              SEP_CART_STORAGE_KEY
            );

        if (
          !stored
        ) {
          sepCart =
            [];
          return;
        }

        const parsed =
          JSON
            .parse(
              stored
            );

        if (
          Array
            .isArray(
              parsed
            )
        ) {
          sepCart =
            parsed;
        } else {
          sepCart =
            [];
        }
      } catch (parseError) {
        sepCart =
          [];
      }
    }

    /**
     * Persist SEP cart to local storage.
     */
    function saveSepCartToStorage() {
      try {
        window
          .localStorage
          .setItem(
            SEP_CART_STORAGE_KEY,
            JSON
              .stringify(
                sepCart
              )
          );
      } catch (storageError) {
        // If storage fails, the cart will still work for this session.
      }
    }

    /**
     * Get the numeric shipping cost based on the
     * current toggle state.
     */
    function getSepShippingAmount() {
      return (
        sepShippingIsCopenhagen
          ? SEP_SHIPPING_CPH
          : SEP_SHIPPING_REST_DK
      );
    }

    /**
     * Render cart items and totals into the sidebar.
     */
    function renderSepCart() {
      const cartItemsEl =
        document
          .getElementById(
            "cartItems"
          );

      const subtotalEl =
        document
          .getElementById(
            "cartSubtotal"
          );

      const totalEl =
        document
          .getElementById(
            "cartTotal"
          );

      const shippingLabelEl =
        document
          .getElementById(
            "cartShippingLabel"
          );

      if (
        !cartItemsEl ||
        !subtotalEl ||
        !totalEl ||
        !shippingLabelEl
      ) {
        return;
      }

      cartItemsEl
        .innerHTML =
        "";

      if (
        sepCart
          .length ===
        0
      ) {
        const emptyState =
          document
            .createElement(
              "p"
            );

        emptyState
          .className =
          "text-center text-gray-500 py-10 text-sm";

        emptyState
          .setAttribute(
            "data-i18n",
            "sep_cart_empty"
          );

        emptyState
          .innerHTML =
          t(
            "sep_cart_empty"
          );

        cartItemsEl
          .appendChild(
            emptyState
          );

        subtotalEl
          .textContent =
          "0 kr.";

        const shippingAmountEmpty =
          getSepShippingAmount();

        if (
          sepShippingIsCopenhagen
        ) {
          shippingLabelEl
            .textContent =
            t(
              "sep_cart_shipping_free_cph"
            );
        } else {
          shippingLabelEl
            .textContent =
            "+" +
            shippingAmountEmpty
              .toString() +
            " kr.";
        }

        totalEl
          .textContent =
          shippingAmountEmpty
            .toString() +
          " kr.";

        updateSepCartCounter();
        saveSepCartToStorage();

        return;
      }

      let subtotal =
        0;

      sepCart
        .forEach(
          function renderItem(
            item,
            index
          ) {
            const itemRow =
              document
                .createElement(
                  "div"
                );

            itemRow
              .className =
              "border-b border-gray-200 pb-3 mb-3 text-sm";

            const itemHeader =
              document
                .createElement(
                  "div"
                );

            itemHeader
              .className =
              "flex justify-between items-center";

            const nameSpan =
              document
                .createElement(
                  "span"
                );

            nameSpan
              .textContent =
              item
                .name;

            const linePrice =
              item
                .price *
              item
                .qty;

            const priceSpan =
              document
                .createElement(
                  "span"
                );

            priceSpan
              .textContent =
              linePrice
                .toString() +
              " kr.";

            itemHeader
              .appendChild(
                nameSpan
              );

            itemHeader
              .appendChild(
                priceSpan
              );

            const metaRow =
              document
                .createElement(
                  "div"
                );

            metaRow
              .className =
              "text-xs text-gray-500 mt-1";

            metaRow
              .textContent =
              "Size: " +
              item
                .size +
              " · Qty: " +
              item
                .qty
                .toString();

            const removeButton =
              document
                .createElement(
                  "button"
                );

            removeButton
              .type =
              "button";

            removeButton
              .className =
              "mt-1 text-xs text-red-500 underline";

            removeButton
              .textContent =
              t(
                "sep_cart_remove"
              );

            removeButton
              .addEventListener(
                "click",
                function handleRemoveClick() {
                  removeSepCartItem(
                    index
                  );
                }
              );

            itemRow
              .appendChild(
                itemHeader
              );

            itemRow
              .appendChild(
                metaRow
              );

            itemRow
              .appendChild(
                removeButton
              );

            cartItemsEl
              .appendChild(
                itemRow
              );

            subtotal +=
              linePrice;
          }
        );

      subtotalEl
        .textContent =
        subtotal
          .toString() +
        " kr.";

      const shippingAmount =
        getSepShippingAmount();

      if (
        sepShippingIsCopenhagen
      ) {
        shippingLabelEl
          .textContent =
          t(
            "sep_cart_shipping_free_cph"
          );
      } else {
        shippingLabelEl
          .textContent =
          "+" +
          shippingAmount
            .toString() +
          " kr.";
      }

      const total =
        subtotal +
        shippingAmount;

      totalEl
        .textContent =
        total
          .toString() +
        " kr.";

      updateSepCartCounter();
      saveSepCartToStorage();
    }

    /**
     * Add a new line to the SEP cart.
     * If an identical line already exists (same name and size),
     * merge the quantities.
     */
    function addToSepCart(
      productName,
      price,
      size,
      qty
    ) {
      if (
        !productName ||
        !size
      ) {
        return;
      }

      const numericQty =
        parseInt(
          qty,
          10
        );

      if (
        !Number
          .isFinite(
            numericQty
          ) ||
        numericQty <=
        0
      ) {
        return;
      }

      const numericPrice =
        Number(
          price
        );

      const existingIndex =
        sepCart
          .findIndex(
            function findItem(
              item
            ) {
              return (
                item
                  .name ===
                  productName &&
                item
                  .size ===
                  size
              );
            }
          );

      if (
        existingIndex >
        -1
      ) {
        sepCart[
          existingIndex
        ]
          .qty +=
          numericQty;
      } else {
        sepCart
          .push(
            {
              name:
                productName,
              price:
                numericPrice,
              size:
                size,
              qty:
                numericQty
            }
          );
      }

      renderSepCart();

      createPopup(
        t(
          "sep_popup_added_to_cart"
        )
      );
    }

    /**
     * Remove a cart line by index.
     */
    function removeSepCartItem(
      index
    ) {
      if (
        index <
        0 ||
        index >=
        sepCart
          .length
      ) {
        return;
      }

      sepCart
        .splice(
          index,
          1
        );

      renderSepCart();
    }

    /**
     * Update the small badge on the View Cart button.
     */
    function updateSepCartCounter() {
      const counterEl =
        document
          .getElementById(
            "cartCounter"
          );

      if (
        !counterEl
      ) {
        return;
      }

      const totalQty =
        sepCart
          .reduce(
            function sumQty(
              acc,
              item
            ) {
              return (
                acc +
                item
                  .qty
              );
            },
            0
          );

      if (
        totalQty >
        0
      ) {
        counterEl
          .textContent =
          totalQty
            .toString();

        counterEl
          .classList
          .remove(
            "hidden"
          );
      } else {
        counterEl
          .classList
          .add(
            "hidden"
          );
      }
    }

    /**
     * Open the SEP cart sidebar and overlay.
     */
    function openSepCart() {
      const cartSidebar =
        document
          .getElementById(
            "cartSidebar"
          );

      const cartOverlay =
        document
          .getElementById(
            "cartOverlay"
          );

      const heroButtons =
        document
          .getElementById(
            "sepHeroButtons"
          );

      if (
        cartSidebar
      ) {
        cartSidebar
          .classList
          .remove(
            "translate-x-full"
          );
      }

      if (
        cartOverlay
      ) {
        cartOverlay
          .classList
          .remove(
            "hidden"
          );
      }

      if (
        heroButtons
      ) {
        heroButtons
          .style
          .opacity =
          "0.2";
      }

      setNavMuted(
        true
      );
    }

    /**
     * Close the SEP cart sidebar and overlay.
     */
    function closeSepCart() {
      const cartSidebar =
        document
          .getElementById(
            "cartSidebar"
          );

      const cartOverlay =
        document
          .getElementById(
            "cartOverlay"
          );

      const heroButtons =
        document
          .getElementById(
            "sepHeroButtons"
          );

      if (
        cartSidebar
      ) {
        cartSidebar
          .classList
          .add(
            "translate-x-full"
          );
      }

      if (
        cartOverlay
      ) {
        cartOverlay
          .classList
          .add(
            "hidden"
          );
      }

      if (
        heroButtons
      ) {
        heroButtons
          .style
          .opacity =
          "1";
      }

      setNavMuted(
        false
      );
    }

    /**
     * Build a human readable order message based on the current
     * cart and shipping.
     */
    function buildSepOrderMessage() {
      const subtotalEl =
        document
          .getElementById(
            "cartSubtotal"
          );

      const shippingLabelEl =
        document
          .getElementById(
            "cartShippingLabel"
          );

      const totalEl =
        document
          .getElementById(
            "cartTotal"
          );

      const greeting =
        t(
          "sep_order_message_greeting"
        );

      const lines =
        [];

      lines
        .push(
          greeting
        );

      lines
        .push(
          ""
        );

      sepCart
        .forEach(
          function mapItem(
            item
          ) {
            const line =
              item
                .qty
                .toString() +
              " × " +
              item
                .name +
              " (Size: " +
              item
                .size +
              ")";

            lines
              .push(
                line
              );
          }
        );

      lines
        .push(
          ""
        );

      if (
        subtotalEl
      ) {
        lines
          .push(
            t(
              "sep_order_message_subtotal"
            ) +
            ": " +
            subtotalEl
              .textContent
          );
      }

      if (
        shippingLabelEl
      ) {
        lines
          .push(
            t(
              "sep_order_message_shipping"
            ) +
            ": " +
            shippingLabelEl
              .textContent
          );
      }

      if (
        totalEl
      ) {
        lines
          .push(
            t(
              "sep_order_message_total"
            ) +
            ": " +
            totalEl
              .textContent
          );
      }

      lines
        .push(
          ""
        );

      lines
        .push(
          "MobilePay: " +
          SEP_MOBILEPAY_NUMBER
        );

      return (
        lines
          .join(
            "\n"
          )
      );
    }

    /**
     * Wire up SEP cart related event listeners.
     */
    function initSepCart() {
      // Load existing data.
      loadSepCartFromStorage();

      // Find key DOM elements.
      const viewCartBtn =
        document
          .getElementById(
            "viewCartBtn"
          );

      const cartOverlay =
        document
          .getElementById(
            "cartOverlay"
          );

      const closeCartBtn =
        document
          .getElementById(
            "closeCart"
          );

      const shippingCphBtn =
        document
          .getElementById(
            "shippingCph"
          );

      const shippingDkBtn =
        document
          .getElementById(
            "shippingNonCph"
          );

      const openMobilePayBtn =
        document
          .getElementById(
            "openMobilePay"
          );

      const copyOrderBtn =
        document
          .getElementById(
            "copyMobilePay"
          );

      // Attach open cart handler.
      if (
        viewCartBtn
      ) {
        viewCartBtn
          .addEventListener(
            "click",
            function handleViewCartClick() {
              openSepCart();
            }
          );
      }

      // Overlay closes cart.
      if (
        cartOverlay
      ) {
        cartOverlay
          .addEventListener(
            "click",
            function handleOverlayClick() {
              closeSepCart();
            }
          );
      }

      // Close cart button.
      if (
        closeCartBtn
      ) {
        closeCartBtn
          .addEventListener(
            "click",
            function handleCloseCartClick() {
              closeSepCart();
            }
          );
      }

      // Shipping toggles.
      if (
        shippingCphBtn
      ) {
        shippingCphBtn
          .addEventListener(
            "click",
            function handleShippingCph() {
              sepShippingIsCopenhagen =
                true;

              renderSepCart();
            }
          );
      }

      if (
        shippingDkBtn
      ) {
        shippingDkBtn
          .addEventListener(
            "click",
            function handleShippingDk() {
              sepShippingIsCopenhagen =
                false;

              renderSepCart();
            }
          );
      }

      // Add to cart buttons for each product card.
      const addButtons =
        document
          .querySelectorAll(
            ".add-to-cart"
          );

      addButtons
        .forEach(
          function wireAddBtn(
            btn
          ) {
            btn
              .addEventListener(
                "click",
                function handleAddClick() {
                  const card =
                    btn
                      .closest(
                        ".product-card"
                      );

                  if (
                    !card
                  ) {
                    return;
                  }

                  const nameEl =
                    card
                      .querySelector(
                        "[data-product-name]"
                      );

                  const priceEl =
                    card
                      .querySelector(
                        "[data-product-price]"
                      );

                  const sizeSelect =
                    card
                      .querySelector(
                        "select"
                      );

                  const qtyInput =
                    card
                      .querySelector(
                        ".quantity-selector"
                      );

                  if (
                    !nameEl ||
                    !priceEl ||
                    !sizeSelect ||
                    !qtyInput
                  ) {
                    return;
                  }

                  const name =
                    nameEl
                      .textContent
                      .trim();

                  const priceText =
                    priceEl
                      .getAttribute(
                        "data-price"
                      ) ||
                    priceEl
                      .textContent;

                  const numericPrice =
                    parseInt(
                      priceText
                        .replace(
                          /\D/g,
                          ""
                        ),
                      10
                    ) || 0;

                  const size =
                    sizeSelect
                      .value;

                  const qty =
                    qtyInput
                      .value ||
                    "1";

                  addToSepCart(
                    name,
                    numericPrice,
                    size,
                    qty
                  );
                }
              );
          }
        );

      // MobilePay button.
      if (
        openMobilePayBtn
      ) {
        openMobilePayBtn
          .addEventListener(
            "click",
            function handleMobilePayClick() {
              const numericPhone =
                SEP_MOBILEPAY_NUMBER
                  .replace(
                    /\D/g,
                    ""
                  );

              if (
                numericPhone
              ) {
                const url =
                  "mobilepay://transfer?phone=" +
                  numericPhone;

                window
                  .location
                  .href =
                  url;
              }

              createPopup(
                t(
                  "sep_popup_mobilepay_thanks"
                )
              );
            }
          );
      }

      // Copy order message button.
      if (
        copyOrderBtn
      ) {
        copyOrderBtn
          .addEventListener(
            "click",
            function handleCopyOrderClick() {
              const message =
                buildSepOrderMessage();

              if (
                navigator
                  .clipboard &&
                navigator
                  .clipboard
                  .writeText
              ) {
                navigator
                  .clipboard
                  .writeText(
                    message
                  )
                  .then(
                    function onCopySuccess() {
                      createPopup(
                        t(
                          "sep_popup_order_copied"
                        )
                      );
                    }
                  )
                  .catch(
                    function onCopyError() {
                      createPopup(
                        t(
                          "sep_popup_order_copied"
                        )
                      );
                    }
                  );
              } else {
                // Fallback using a hidden textarea.
                const fallback =
                  document
                    .createElement(
                      "textarea"
                    );

                fallback
                  .style
                  .position =
                  "fixed";

                fallback
                  .style
                  .top =
                  "-1000px";

                fallback
                  .value =
                  message;

                document
                  .body
                  .appendChild(
                    fallback
                  );

                fallback
                  .select();

                try {
                  document
                    .execCommand(
                      "copy"
                    );
                } catch (fallbackError) {
                  // Ignore.
                }

                fallback
                  .remove();

                createPopup(
                  t(
                    "sep_popup_order_copied"
                  )
                );
              }
            }
          );
      }

      // Initial render.
      renderSepCart();
    }

    // ============================================================
    // 7. MAKE IT HAPPEN - DATA MODEL AND LOGIC
    // ============================================================

    // Storage keys for Make It Happen.
    const MIH_STORAGE_KEY_ENTRIES =
      "mih_entries_v5";

    const MIH_STORAGE_KEY_USERS =
      "mih_users_v5";

    const MIH_STORAGE_KEY_CURRENT_USER =
      "mih_current_user_v5";

    // Thirty days in milliseconds.
    const MIH_THIRTY_DAYS_MS =
      30 *
      24 *
      60 *
      60 *
      1000;

    // League names, in ascending order.
    const MIH_LEAGUES =
      [
        "amateurs",
        "intermediates",
        "pros",
        "legends"
      ];

    // In memory data sets.
    let mihEntries =
      [];

    let mihUsers =
      [];

    let mihCurrentUser =
      null;

    /**
     * Generate a simple unique identifier.
     */
    function mihGenerateId() {
      return (
        Date
          .now()
          .toString(
            36
          ) +
        Math
          .random()
          .toString(
            36
          )
          .slice(
            2,
            8
          )
      );
    }

    /**
     * Load MIH entries from local storage.
     */
    function mihLoadEntries() {
      try {
        const stored =
          window
            .localStorage
            .getItem(
              MIH_STORAGE_KEY_ENTRIES
            );

        if (
          !stored
        ) {
          mihEntries =
            [];
          return;
        }

        const parsed =
          JSON
            .parse(
              stored
            );

        if (
          Array
            .isArray(
              parsed
            )
        ) {
          mihEntries =
            parsed;
        } else {
          mihEntries =
            [];
        }
      } catch (error) {
        mihEntries =
          [];
      }
    }

    /**
     * Save MIH entries to local storage.
     */
    function mihSaveEntries() {
      try {
        window
          .localStorage
          .setItem(
            MIH_STORAGE_KEY_ENTRIES,
            JSON
              .stringify(
                mihEntries
              )
          );
      } catch (error) {
        // Non critical.
      }
    }

    /**
     * Load MIH users from local storage.
     */
    function mihLoadUsers() {
      try {
        const stored =
          window
            .localStorage
            .getItem(
              MIH_STORAGE_KEY_USERS
            );

        if (
          !stored
        ) {
          mihUsers =
            [];
          return;
        }

        const parsed =
          JSON
            .parse(
              stored
            );

        if (
          Array
            .isArray(
              parsed
            )
        ) {
          mihUsers =
            parsed;
        } else {
          mihUsers =
            [];
        }
      } catch (error) {
        mihUsers =
          [];
      }

      // Ensure league field is always valid.
      mihUsers
        .forEach(
          function normaliseLeague(
            user
          ) {
            if (
              !user
                .league ||
              !MIH_LEAGUES
                .includes(
                  user
                    .league
                )
            ) {
              user
                .league =
                "amateurs";
            }
          }
        );
    }

    /**
     * Save MIH users to local storage.
     */
    function mihSaveUsers() {
      try {
        window
          .localStorage
          .setItem(
            MIH_STORAGE_KEY_USERS,
            JSON
              .stringify(
                mihUsers
              )
          );
      } catch (error) {
        // Non critical.
      }
    }

    /**
     * Return user object by internal id.
     */
    function mihGetUserById(
      userId
    ) {
      return (
        mihUsers
          .find(
            function findUser(
              user
            ) {
              return (
                user
                  .id ===
                userId
              );
            }
          ) ||
        null
      );
    }

    /**
     * Return user object by name (case insensitive).
     */
    function mihGetUserByName(
      name
    ) {
      const trimmed =
        name
          .trim()
          .toLowerCase();

      return (
        mihUsers
          .find(
            function findUser(
              user
            ) {
              return (
                user
                  .name
                  .trim()
                  .toLowerCase() ===
                trimmed
              );
            }
          ) ||
        null
      );
    }

    /**
     * Decide which league a new user will start in.
     * New users are placed where the user count is lightest.
     */
    function mihAssignStartingLeague() {
      const counts =
        {
          amateurs:
            0,
          intermediates:
            0,
          pros:
            0,
          legends:
            0
        };

      mihUsers
        .forEach(
          function countUser(
            user
          ) {
            if (
              counts
                .hasOwnProperty(
                  user
                    .league
                )
            ) {
              counts[
                user
                  .league
              ] +=
                1;
            }
          }
        );

      const leagueCounts =
        MIH_LEAGUES
          .map(
            function mapLeague(
              league
            ) {
              return {
                league:
                  league,
                count:
                  counts[
                    league
                  ]
              };
            }
          );

      leagueCounts
        .sort(
          function sortLeastFirst(
            a,
            b
          ) {
            return (
              a
                .count -
              b
                .count
            );
          }
        );

      return (
        leagueCounts[0]
          .league
      );
    }

    /**
     * Remove users that have been logged out for more than
     * thirty days. Also remove their entries.
     */
    function mihCleanupOldAccounts() {
      const now =
        Date
          .now();

      const keptUsers =
        [];

      const removedIds =
        new Set();

      mihUsers
        .forEach(
          function inspectUser(
            user
          ) {
            const isCurrent =
              mihCurrentUser &&
              mihCurrentUser
                .id ===
              user
                .id;

            if (
              isCurrent
            ) {
              keptUsers
                .push(
                  user
                );
              return;
            }

            if (
              !user
                .lastLogoutAt
            ) {
              keptUsers
                .push(
                  user
                );
              return;
            }

            const delta =
              now -
              user
                .lastLogoutAt;

            if (
              delta >
              MIH_THIRTY_DAYS_MS
            ) {
              removedIds
                .add(
                  user
                    .id
                );
            } else {
              keptUsers
                .push(
                  user
                );
            }
          }
        );

      mihUsers =
        keptUsers;

      if (
        removedIds
          .size >
        0
      ) {
        mihEntries =
          mihEntries
            .filter(
              function keepEntry(
                entry
              ) {
                return (
                  !removedIds
                    .has(
                      entry
                        .userId
                    )
                );
              }
            );
      }

      mihSaveUsers();
      mihSaveEntries();
    }

    /**
     * Formatting helpers.
     */

    function mihFormatDate(
      timestamp
    ) {
      const d =
        new Date(
          timestamp
        );

      if (
        Number
          .isNaN(
            d
              .getTime()
          )
      ) {
        return (
          ""
        );
      }

      return (
        d
          .toLocaleDateString(
            undefined,
            {
              year:
                "numeric",
              month:
                "short",
              day:
                "numeric"
            }
          )
      );
    }

    function mihFormatMinutes(
      minutes
    ) {
      if (
        !Number
          .isFinite(
            minutes
          ) ||
        minutes <=
        0
      ) {
        return (
          "–"
        );
      }

      const totalSeconds =
        Math
          .round(
            minutes *
            60
          );

      const wholeMinutes =
        Math
          .floor(
            totalSeconds /
            60
          );

      const seconds =
        totalSeconds %
        60;

      const paddedSeconds =
        seconds
          .toString()
          .padStart(
            2,
            "0"
          );

      return (
        wholeMinutes
          .toString() +
        ":" +
        paddedSeconds
      );
    }

    function mihFormatImprovement(
      value
    ) {
      if (
        !Number
          .isFinite(
            value
          ) ||
        value ===
        0
      ) {
        return (
          "0%"
        );
      }

      const rounded =
        Math
          .round(
            value
          );

      if (
        rounded >
        0
      ) {
        return (
          "+" +
          rounded
            .toString() +
          "%"
        );
      }

      return (
        rounded
          .toString() +
        "%"
      );
    }

    /**
     * Compute per user stats from entries.
     * Returns an array of stat objects sorted for leaderboard.
     */
    function mihGetPlayerStats() {
      const byUser =
        {};

      mihUsers
        .forEach(
          function initialiseUserStats(
            user
          ) {
            byUser[
              user
                .id
            ] =
              {
                userId:
                  user
                    .id,
                name:
                  user
                    .name,
                league:
                  user
                    .league,
                runs:
                  0,
                totalDistance:
                  0,
                totalTime:
                  0,
                bestDistance:
                  0,
                baselineDistance:
                  null,
                baselineTime:
                  null,
                avgDistance:
                  0,
                avgPace:
                  null,
                improvement:
                  0
              };
          }
        );

      mihEntries
        .forEach(
          function applyEntry(
            entry
          ) {
            const stats =
              byUser[
                entry
                  .userId
              ];

            if (
              !stats
            ) {
              return;
            }

            if (
              stats
                .runs ===
              0
            ) {
              stats
                .baselineDistance =
                entry
                  .distanceKm;

              stats
                .baselineTime =
                entry
                  .timeMinutes;
            }

            stats
              .runs +=
              1;

            stats
              .totalDistance +=
              entry
                .distanceKm;

            stats
              .totalTime +=
              entry
                .timeMinutes;

            if (
              entry
                .distanceKm >
              stats
                .bestDistance
            ) {
              stats
                .bestDistance =
                entry
                  .distanceKm;
            }
          }
        );

      let allStats =
        Object
          .values(
            byUser
          );

      allStats
        .forEach(
          function finaliseStats(
            stats
          ) {
            if (
              stats
                .runs >
              0
            ) {
              stats
                .avgDistance =
                stats
                  .totalDistance /
                stats
                  .runs;
            } else {
              stats
                .avgDistance =
                0;
            }

            if (
              stats
                .totalDistance >
              0
            ) {
              stats
                .avgPace =
                stats
                  .totalTime /
                stats
                  .totalDistance;
            } else {
              stats
                .avgPace =
                null;
            }

            let distImprovement =
              0;

            if (
              stats
                .baselineDistance &&
              stats
                .runs >
              1
            ) {
              distImprovement =
                (
                  (stats
                    .avgDistance -
                    stats
                      .baselineDistance) /
                  stats
                    .baselineDistance
                ) *
                100;
            }

            let paceImprovement =
              0;

            if (
              stats
                .baselineTime &&
              stats
                .baselineDistance &&
              stats
                .runs >
              1 &&
              stats
                .avgPace
            ) {
              const baselinePace =
                stats
                  .baselineTime /
                stats
                  .baselineDistance;

              if (
                baselinePace >
                0
              ) {
                paceImprovement =
                  (
                    (baselinePace -
                      stats
                        .avgPace) /
                    baselinePace
                  ) *
                  100;
              }
            }

            stats
              .improvement =
              distImprovement +
              paceImprovement;
          }
        );

      // Leaderboard sorting:
      //   1. total distance
      //   2. runs
      //   3. average speed (distance per minute)
      //   4. total time (lower is better)
      allStats
        .sort(
          function sortLeaderboard(
            a,
            b
          ) {
            if (
              b
                .totalDistance !==
              a
                .totalDistance
            ) {
              return (
                b
                  .totalDistance -
                a
                  .totalDistance
              );
            }

            if (
              b
                .runs !==
              a
                .runs
            ) {
              return (
                b
                  .runs -
                a
                  .runs
              );
            }

            const aSpeed =
              a
                .totalTime >
              0
                ? a
                  .totalDistance /
                  a
                    .totalTime
                : 0;

            const bSpeed =
              b
                .totalTime >
              0
                ? b
                  .totalDistance /
                  b
                    .totalTime
                : 0;

            if (
              bSpeed !==
              aSpeed
            ) {
              return (
                bSpeed -
                aSpeed
              );
            }

            return (
              a
                .totalTime -
              b
                .totalTime
            );
          }
        );

      allStats =
        allStats
          .map(
            function addRank(
              stats,
              index
            ) {
              return {
                rank:
                  index +
                  1,
                userId:
                  stats
                    .userId,
                name:
                  stats
                    .name,
                league:
                  stats
                    .league,
                runs:
                  stats
                    .runs,
                totalDistance:
                  stats
                    .totalDistance,
                totalTime:
                  stats
                    .totalTime,
                avgDistance:
                  stats
                    .avgDistance,
                bestDistance:
                  stats
                    .bestDistance,
                improvement:
                  stats
                    .improvement
              };
            }
          );

      return (
        allStats
      );
    }

    /**
     * Render the header user chip in the MIH leaderboard header.
     */
    function mihRenderHeaderUser() {
      const controlsEl =
        document
          .getElementById(
            "user-controls"
          );

      const nameInput =
        document
          .getElementById(
            "name"
          );

      if (
        !controlsEl
      ) {
        return;
      }

      controlsEl
        .innerHTML =
        "";

      if (
        !mihCurrentUser
      ) {
        const status =
          document
            .createElement(
              "span"
            );

        status
          .id =
          "user-status";

        status
          .className =
          "text-xs text-gray-400";

        status
          .textContent =
          "Not logged in";

        const loginBtn =
          document
            .createElement(
              "button"
            );

        loginBtn
          .type =
          "button";

        loginBtn
          .className =
          "px-3 py-1 rounded-full border border-white/20 text-[11px] text-gray-300";

        loginBtn
          .textContent =
          "Log in";

        loginBtn
          .addEventListener(
            "click",
            function handleHeaderLoginClick() {
              showScene(
                "mih-login"
              );
            }
          );

        controlsEl
          .appendChild(
            status
          );

        controlsEl
          .appendChild(
          loginBtn
          );

        if (
          nameInput
        ) {
          nameInput
            .value =
            "";

          nameInput
            .placeholder =
            "Log in to set your name";
        }

        return;
      }

      const status =
        document
          .createElement(
            "span"
          );

      status
        .id =
        "user-status";

      status
        .className =
        "text-xs text-gray-300";

      const leagueLabel =
        mihCurrentUser
          .league
          .charAt(
            0
          )
          .toUpperCase() +
        mihCurrentUser
          .league
          .slice(
            1
          );

      status
        .innerHTML =
        "Logged in as " +
        "<span class=\"font-semibold\">" +
        mihCurrentUser
          .name +
        "</span>" +
        " · " +
        "<span class=\"px-2 py-0.5 rounded-full border border-white/25 text-[10px] uppercase tracking-wide\">" +
        leagueLabel +
        "</span>";

      const logoutBtn =
        document
          .createElement(
            "button"
          );

      logoutBtn
        .type =
        "button";

      logoutBtn
        .className =
        "px-3 py-1 rounded-full border border-white/20 text-[11px] text-gray-300";

      logoutBtn
        .textContent =
        "Log out";

      logoutBtn
        .addEventListener(
          "click",
          function handleLogoutClick() {
            mihLogout();
          }
        );

      const deleteBtn =
        document
          .createElement(
            "button"
          );

      deleteBtn
        .type =
        "button";

      deleteBtn
        .className =
        "px-3 py-1 rounded-full border border-red-400/60 text-[11px] text-red-200";

      deleteBtn
        .textContent =
        "Delete account";

      deleteBtn
        .addEventListener(
          "click",
          function handleDeleteAccountClick() {
            mihDeleteAccount();
          }
        );

      controlsEl
        .appendChild(
          status
        );

      controlsEl
        .appendChild(
          logoutBtn
        );

      controlsEl
        .appendChild(
          deleteBtn
        );

      if (
        nameInput
      ) {
        nameInput
          .value =
          mihCurrentUser
            .name;

        nameInput
          .placeholder =
          "";
      }
    }

    /**
     * Render the leaderboard table based on the current stats and filter.
     */
    function mihRenderLeaderboard() {
      const tbody =
        document
          .getElementById(
            "leaderboard-body"
          );

      const emptyEl =
        document
          .getElementById(
            "no-entries"
          );

      const filterSelect =
        document
          .getElementById(
            "league-filter"
          );

      if (
        !tbody
      ) {
        return;
      }

      tbody
        .innerHTML =
        "";

      const allStats =
        mihGetPlayerStats();

      let filtered =
        allStats;

      if (
        filterSelect &&
        filterSelect
          .value &&
        filterSelect
          .value !==
        "all"
      ) {
        filtered =
          allStats
            .filter(
              function filterLeague(
                stats
              ) {
                return (
                  stats
                    .league ===
                  filterSelect
                    .value
                );
              }
            );
      }

      if (
        filtered
          .length ===
        0
      ) {
        if (
          emptyEl
        ) {
          emptyEl
            .style
            .display =
            "block";
        }

        return;
      }

      if (
        emptyEl
      ) {
        emptyEl
          .style
          .display =
          "none";
      }

      filtered
        .forEach(
          function renderRow(
            stats
          ) {
            const tr =
              document
                .createElement(
                  "tr"
                );

            tr
              .className =
              "border-b border-white/10";

            let rankSymbol =
              stats
                .rank;

            if (
              stats
                .rank ===
              1
            ) {
              rankSymbol =
                "🥇";
            } else if (
              stats
                .rank ===
              2
            ) {
              rankSymbol =
                "🥈";
            } else if (
              stats
                .rank ===
              3
            ) {
              rankSymbol =
                "🥉";
            }

            const leagueLabel =
              stats
                .league
                .charAt(
                  0
                )
                .toUpperCase() +
              stats
                .league
                .slice(
                  1
                );

            tr
              .innerHTML =
              "<td class=\"py-2 pr-2\">" +
              rankSymbol +
              "</td>" +
              "<td class=\"py-2 px-2\">" +
              "<button type=\"button\" class=\"underline text-gray-200 text-xs md:text-sm\" data-mih-profile-id=\"" +
              stats
                .userId +
              "\">" +
              stats
                .name +
              "</button>" +
              "</td>" +
              "<td class=\"py-2 px-2\">" +
              "<span class=\"px-2 py-0.5 rounded-full border border-white/25 text-[10px] uppercase tracking-wide\">" +
              leagueLabel +
              "</span>" +
              "</td>" +
              "<td class=\"py-2 px-2\">" +
              stats
                .totalDistance
                .toFixed(
                  2
                ) +
              " km</td>" +
              "<td class=\"py-2 px-2\">" +
              stats
                .totalTime
                .toFixed(
                  1
                ) +
              " min</td>";

            tbody
              .appendChild(
                tr
              );
          }
        );

      // Wire profile buttons.
      const profileButtons =
        tbody
          .querySelectorAll(
            "[data-mih-profile-id]"
          );

      profileButtons
        .forEach(
          function bindProfileButton(
            btn
          ) {
            const userId =
              btn
                .getAttribute(
                  "data-mih-profile-id"
                );

            btn
              .addEventListener(
                "click",
                function handleProfileClick() {
                  mihOpenProfile(
                    userId
                  );
                }
              );
          }
        );
    }

    /**
     * Render the Stats table.
     */
    function mihRenderStats() {
      const tbody =
        document
          .getElementById(
            "stats-body"
          );

      const emptyEl =
        document
          .getElementById(
            "no-stats"
          );

      if (
        !tbody
      ) {
        return;
      }

      tbody
        .innerHTML =
        "";

      if (
        mihUsers
          .length ===
        0
      ) {
        if (
          emptyEl
        ) {
          emptyEl
            .style
            .display =
            "block";
        }

        return;
      }

      if (
        emptyEl
      ) {
        emptyEl
          .style
          .display =
          "none";
      }

      const stats =
        mihGetPlayerStats();

      stats
        .forEach(
          function renderStatsRow(
            s
          ) {
            const tr =
              document
                .createElement(
                  "tr"
                );

            tr
              .className =
              "border-b border-white/10";

            const leagueLabel =
              s
                .league
                .charAt(
                  0
                )
                .toUpperCase() +
              s
                .league
                .slice(
                  1
                );

            tr
              .innerHTML =
              "<td class=\"py-2 px-2\">" +
              s
                .name +
              "</td>" +
              "<td class=\"py-2 px-2\">" +
              "<span class=\"px-2 py-0.5 rounded-full border border-white/25 text-[10px] uppercase tracking-wide\">" +
              leagueLabel +
              "</span>" +
              "</td>" +
              "<td class=\"py-2 px-2\">" +
              s
                .runs
                .toString() +
              "</td>" +
              "<td class=\"py-2 px-2\">" +
              s
                .totalDistance
                .toFixed(
                  2
                ) +
              " km</td>" +
              "<td class=\"py-2 px-2\">" +
              s
                .totalTime
                .toFixed(
                  1
                ) +
              " min</td>" +
              "<td class=\"py-2 px-2\">" +
              s
                .avgDistance
                .toFixed(
                  2
                ) +
              " km</td>" +
              "<td class=\"py-2 px-2\">" +
              s
                .bestDistance
                .toFixed(
                  2
                ) +
              " km</td>" +
              "<td class=\"py-2 px-2\">" +
              mihFormatImprovement(
                s
                  .improvement
              ) +
              "</td>";

            tbody
              .appendChild(
                tr
              );
          }
        );
    }

    /**
     * Render the "My activities" table for the current user.
     */
    function mihRenderMyActivities() {
      const tbody =
        document
          .getElementById(
            "my-activities-body"
          );

      const emptyEl =
        document
          .getElementById(
            "no-my-activities"
          );

      if (
        !tbody
      ) {
        return;
      }

      tbody
        .innerHTML =
        "";

      if (
        !mihCurrentUser
      ) {
        if (
          emptyEl
        ) {
          emptyEl
            .style
            .display =
            "block";

          emptyEl
            .textContent =
            "Log in to see and manage your activities.";
        }

        return;
      }

      const myEntries =
        mihEntries
          .filter(
            function filterMyEntries(
              entry
            ) {
              return (
                entry
                  .userId ===
                mihCurrentUser
                  .id
              );
            }
          );

      if (
        myEntries
          .length ===
        0
      ) {
        if (
          emptyEl
        ) {
          emptyEl
            .style
            .display =
            "block";

          emptyEl
            .textContent =
            "No activities yet for this account.";
        }

        return;
      }

      if (
        emptyEl
      ) {
        emptyEl
          .style
          .display =
          "none";
      }

      myEntries
        .slice()
        .sort(
          function sortByDateDesc(
            a,
            b
          ) {
            return (
              b
                .timestamp -
              a
                .timestamp
            );
          }
        )
        .forEach(
          function renderActivityRow(
            entry
          ) {
            const tr =
              document
                .createElement(
                  "tr"
                );

            tr
              .className =
              "border-b border-white/10";

            tr
              .innerHTML =
              "<td class=\"py-2 px-2\">" +
              mihFormatDate(
                entry
                  .timestamp
              ) +
              "</td>" +
              "<td class=\"py-2 px-2\">" +
              entry
                .distanceKm
                .toFixed(
                  2
                ) +
              " km</td>" +
              "<td class=\"py-2 px-2\">" +
              entry
                .timeMinutes
                .toFixed(
                  1
                ) +
              " min</td>" +
              "<td class=\"py-2 px-2 text-right\">" +
              "<button type=\"button\" class=\"text-[11px] text-red-300 underline\" data-mih-delete-id=\"" +
              entry
                .id +
              "\">Delete</button>" +
              "</td>";

            tbody
              .appendChild(
                tr
              );
          }
        );

      const deleteButtons =
        tbody
          .querySelectorAll(
            "[data-mih-delete-id]"
          );

      deleteButtons
        .forEach(
          function bindDelete(
            btn
          ) {
            const id =
              btn
                .getAttribute(
                  "data-mih-delete-id"
                );

            btn
              .addEventListener(
                "click",
                function handleDeleteClick() {
                  mihDeleteActivity(
                    id
                  );
                }
              );
          }
        );
    }

    /**
     * Delete a single activity by id, if it belongs to the current user.
     */
    function mihDeleteActivity(
      id
    ) {
      if (
        !mihCurrentUser
      ) {
        window
          .alert(
            "You need to be logged in to delete activities."
          );

        return;
      }

      const entry =
        mihEntries
          .find(
            function findEntry(
              e
            ) {
              return (
                e
                  .id ===
                id
              );
            }
          );

      if (
        !entry
      ) {
        return;
      }

      if (
        entry
          .userId !==
        mihCurrentUser
          .id
      ) {
        window
          .alert(
            "You can only delete your own activities."
          );

        return;
      }

      const confirmed =
        window
          .confirm(
            "Delete this activity?"
          );

      if (
        !confirmed
      ) {
        return;
      }

      mihEntries =
        mihEntries
          .filter(
            function keepEntry(
              e
            ) {
              return (
                e
                  .id !==
                id
              );
            }
          );

      mihSaveEntries();
      mihRenderLeaderboard();
      mihRenderStats();
      mihRenderMyActivities();
    }

    /**
     * Open a profile scene for a given user id.
     */
    function mihOpenProfile(
      userId
    ) {
      const user =
        mihGetUserById(
          userId
        );

      if (
        !user
      ) {
        return;
      }

      const userEntries =
        mihEntries
          .filter(
            function filterByUser(
              entry
            ) {
              return (
                entry
                  .userId ===
                userId
              );
            }
          );

      let totalDistance =
        0;

      let totalTime =
        0;

      userEntries
        .forEach(
          function addUp(
            entry
          ) {
            totalDistance +=
              entry
                .distanceKm;

            totalTime +=
              entry
                .timeMinutes;
          }
        );

      const runs =
        userEntries
          .length;

      const avgDistance =
        runs >
        0
          ? totalDistance /
            runs
          : 0;

      const avgPace =
        totalDistance >
        0
          ? totalTime /
            totalDistance
          : null;

      let best5k =
        null;

      let best10k =
        null;

      let best100m =
        null;

      if (
        avgPace
      ) {
        best5k =
          avgPace *
          5;

        best10k =
          avgPace *
          10;

        best100m =
          avgPace *
          0.1;
      }

      const profileNameEl =
        document
          .getElementById(
            "profileName"
          );

      const profileLeagueEl =
        document
          .getElementById(
            "profileLeague"
          );

      const profileTotalDistanceEl =
        document
          .getElementById(
            "profileTotalDistance"
          );

      const profileTotalTimeEl =
        document
          .getElementById(
            "profileTotalTime"
          );

      const profileRunsEl =
        document
          .getElementById(
            "profileRuns"
          );

      const profileAvgDistanceEl =
        document
          .getElementById(
            "profileAvgDistance"
          );

      const profileBest5kEl =
        document
          .getElementById(
            "profileBest5k"
          );

      const profileBest10kEl =
        document
          .getElementById(
            "profileBest10k"
          );

      const profileBest100mEl =
        document
          .getElementById(
            "profileBest100m"
          );

      if (
        profileNameEl
      ) {
        profileNameEl
          .textContent =
          user
            .name;
      }

      if (
        profileLeagueEl
      ) {
        const leagueLabel =
          user
            .league
            .charAt(
              0
            )
            .toUpperCase() +
          user
            .league
            .slice(
              1
            );

        profileLeagueEl
          .textContent =
          "League: " +
          leagueLabel;
      }

      if (
        profileTotalDistanceEl
      ) {
        profileTotalDistanceEl
          .textContent =
          totalDistance
            .toFixed(
              2
            ) +
          " km";
      }

      if (
        profileTotalTimeEl
      ) {
        profileTotalTimeEl
          .textContent =
          totalTime
            .toFixed(
              1
            ) +
          " min";
      }

      if (
        profileRunsEl
      ) {
        profileRunsEl
          .textContent =
          runs
            .toString();
      }

      if (
        profileAvgDistanceEl
      ) {
        profileAvgDistanceEl
          .textContent =
          runs >
          0
            ? avgDistance
              .toFixed(
                2
              ) +
              " km"
            : "–";
      }

      if (
        profileBest5kEl
      ) {
        profileBest5kEl
          .textContent =
          best5k
            ? mihFormatMinutes(
                best5k
              )
            : "–";
      }

      if (
        profileBest10kEl
      ) {
        profileBest10kEl
          .textContent =
          best10k
            ? mihFormatMinutes(
                best10k
              )
            : "–";
      }

      if (
        profileBest100mEl
      ) {
        profileBest100mEl
          .textContent =
          best100m
            ? mihFormatMinutes(
                best100m
              )
            : "–";
      }

      showScene(
        "mih-profile"
      );
    }

    /**
     * Handle login or account creation.
     */
    function mihLogin(
      name,
      password
    ) {
      const trimmedName =
        name
          .trim();

      if (
        !trimmedName ||
        !password
      ) {
        window
          .alert(
            "Please enter both name and password."
          );

        return;
      }

      const existing =
        mihGetUserByName(
          trimmedName
        );

      if (
        !existing
      ) {
        const league =
          mihAssignStartingLeague();

        const newUser =
          {
            id:
              mihGenerateId(),
            name:
              trimmedName,
            password:
              password,
            league:
              league,
            createdAt:
              Date
                .now(),
            lastLoginAt:
              Date
                .now(),
            lastLogoutAt:
              null
          };

        mihUsers
          .push(
            newUser
          );

        mihCurrentUser =
          newUser;

        mihSaveUsers();

        try {
          window
            .localStorage
            .setItem(
              MIH_STORAGE_KEY_CURRENT_USER,
              newUser
                .id
            );
        } catch (error) {
          // Non critical.
        }

        mihRenderHeaderUser();
        mihRenderMyActivities();
        mihRenderLeaderboard();
        mihRenderStats();

        showScene(
          "mih-welcome"
        );

        return;
      }

      if (
        existing
          .password !==
        password
      ) {
        window
          .alert(
            "Wrong password for this name."
          );

        return;
      }

      existing
        .lastLoginAt =
        Date
          .now();

      mihCurrentUser =
        existing;

      mihSaveUsers();

      try {
        window
          .localStorage
          .setItem(
            MIH_STORAGE_KEY_CURRENT_USER,
            existing
              .id
          );
      } catch (error) {
        // Non critical.
      }

      mihRenderHeaderUser();
      mihRenderMyActivities();
      mihRenderLeaderboard();
      mihRenderStats();

      showScene(
        "mih-welcome"
      );
    }

    /**
     * Log out the current user.
     */
    function mihLogout() {
      if (
        !mihCurrentUser
      ) {
        return;
      }

      const user =
        mihGetUserById(
          mihCurrentUser
            .id
        );

      if (
        user
      ) {
        user
          .lastLogoutAt =
          Date
            .now();
      }

      mihSaveUsers();

      try {
        window
          .localStorage
          .removeItem(
            MIH_STORAGE_KEY_CURRENT_USER
          );
      } catch (error) {
        // Non critical.
      }

      mihCurrentUser =
        null;

      mihRenderHeaderUser();
      mihRenderMyActivities();
      mihRenderLeaderboard();
      mihRenderStats();

      showScene(
        "mih-login"
      );
    }

    /**
     * Delete the current account and all its entries.
     */
    function mihDeleteAccount() {
      if (
        !mihCurrentUser
      ) {
        return;
      }

      const confirmed =
        window
          .confirm(
            "This will delete your account and all your activities. Are you sure?"
          );

      if (
        !confirmed
      ) {
        return;
      }

      const id =
        mihCurrentUser
          .id;

      mihUsers =
        mihUsers
          .filter(
            function keepUser(
              user
            ) {
              return (
                user
                  .id !==
                id
              );
            }
          );

      mihEntries =
        mihEntries
          .filter(
            function keepEntry(
              entry
            ) {
              return (
                entry
                  .userId !==
                id
              );
            }
          );

      mihSaveUsers();
      mihSaveEntries();

      try {
        window
          .localStorage
          .removeItem(
            MIH_STORAGE_KEY_CURRENT_USER
          );
      } catch (error) {
        // Non critical.
      }

      mihCurrentUser =
        null;

      mihRenderHeaderUser();
      mihRenderMyActivities();
      mihRenderLeaderboard();
      mihRenderStats();

      showScene(
        "mih-login"
      );
    }

    /**
     * Wire up MIH forms and inputs.
     */
    function mihWireForms() {
      const loginForm =
        document
          .getElementById(
            "login-form"
          );

      const entryForm =
        document
          .getElementById(
            "entry-form"
          );

      const leagueFilter =
        document
          .getElementById(
            "league-filter"
          );

      if (
        loginForm
      ) {
        loginForm
          .addEventListener(
            "submit",
            function handleLoginSubmit(
              event
            ) {
              event
                .preventDefault();

              const nameInput =
                document
                  .getElementById(
                    "login-name"
                  );

              const passwordInput =
                document
                  .getElementById(
                    "login-password"
                  );

              if (
                !nameInput ||
                !passwordInput
              ) {
                return;
              }

              const name =
                nameInput
                  .value;

              const pw =
                passwordInput
                  .value;

              mihLogin(
                name,
                pw
              );

              loginForm
                .reset();
            }
          );
      }

      if (
        entryForm
      ) {
        entryForm
          .addEventListener(
            "submit",
            function handleEntrySubmit(
              event
            ) {
              event
                .preventDefault();

              if (
                !mihCurrentUser
              ) {
                window
                  .alert(
                    "Please log in before adding activities."
                  );

                showScene(
                  "mih-login"
                );

                return;
              }

              const distanceInput =
                document
                  .getElementById(
                    "distance"
                  );

              const timeInput =
                document
                  .getElementById(
                    "time"
                  );

              if (
                !distanceInput ||
                !timeInput
              ) {
                return;
              }

              const distance =
                parseFloat(
                  distanceInput
                    .value
                );

              const time =
                parseFloat(
                  timeInput
                    .value
                );

              if (
                !Number
                  .isFinite(
                    distance
                  ) ||
                !Number
                  .isFinite(
                    time
                  ) ||
                distance <=
                0 ||
                time <=
                0
              ) {
                window
                  .alert(
                    "Please fill in distance and time with values greater than zero."
                  );

                return;
              }

              mihEntries
                .push(
                  {
                    id:
                      mihGenerateId(),
                    userId:
                      mihCurrentUser
                        .id,
                    distanceKm:
                      distance,
                    timeMinutes:
                      time,
                    timestamp:
                      Date
                        .now()
                  }
                );

              mihSaveEntries();
              mihRenderLeaderboard();
              mihRenderStats();
              mihRenderMyActivities();

              entryForm
                .reset();

              showScene(
                "mih-leaderboard"
              );
            }
          );
      }

      if (
        leagueFilter
      ) {
        leagueFilter
          .addEventListener(
            "change",
            function handleLeagueFilterChange() {
              mihRenderLeaderboard();
            }
          );
      }
    }

    /**
     * Initialise Make It Happen data and UI.
     */
    function initMakeItHappen() {
      mihLoadEntries();
      mihLoadUsers();

      // Restore current user if any.
      try {
        const currentId =
          window
            .localStorage
            .getItem(
              MIH_STORAGE_KEY_CURRENT_USER
            );

        if (
          currentId
        ) {
          const user =
            mihGetUserById(
              currentId
            );

          if (
            user
          ) {
            mihCurrentUser =
              user;
          } else {
            mihCurrentUser =
              null;

            window
              .localStorage
              .removeItem(
                MIH_STORAGE_KEY_CURRENT_USER
              );
          }
        }
      } catch (error) {
        mihCurrentUser =
          null;
      }

      mihCleanupOldAccounts();
      mihWireForms();
      mihRenderHeaderUser();
      mihRenderLeaderboard();
      mihRenderStats();
      mihRenderMyActivities();
    }

    // ============================================================
    // 8. BOOTSTRAP
    // ============================================================

    if (
      document &&
      document
        .readyState ===
      "loading"
    ) {
      document
        .addEventListener(
          "DOMContentLoaded",
          function handleDomReady() {
            initAll();
          }
        );
    } else {
      // Document already parsed.
      initAll();
    }
  </script>
</body>
</html>
