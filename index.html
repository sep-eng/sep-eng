<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SEP & Make It Happen</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.4/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.4/ScrollTrigger.min.js"></script>
    <style>
        /* Global Styles */
        :root {
            --primary: #000000;
            --secondary: #ffffff;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(to bottom, var(--primary), var(--secondary));
            color: var(--secondary);
            min-height: 100vh;
            transition: all 0.3s ease;
        }
        
        .scene {
            display: none;
            opacity: 0;
            transition: opacity 0.3s ease;
            min-height: 100vh;
            padding-top: 80px;
        }
        
        .scene.active {
            display: block;
            opacity: 1;
        }
        
        .fade-section {
            opacity: 0;
            transform: translateY(20px);
        }
        
        /* Cart Styles */
        .cart-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            z-index: 90;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        
        .cart-overlay.active {
            opacity: 1;
            pointer-events: all;
        }
        
        .cart-sidebar {
            position: fixed;
            top: 0;
            right: -100%;
            width: 100%;
            max-width: 400px;
            height: 100vh;
            background: var(--secondary);
            color: var(--primary);
            z-index: 100;
            transition: right 0.3s ease;
            overflow-y: auto;
        }
        
        .cart-sidebar.active {
            right: 0;
        }
        
        /* Navigation Styles */
        .nav-menu {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 200;
        }
        
        .nav-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: var(--secondary);
            color: var(--primary);
            border-radius: 8px;
            padding: 1rem;
            min-width: 200px;
            opacity: 0;
            pointer-events: none;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .nav-dropdown.active {
            opacity: 1;
            pointer-events: all;
            transform: translateY(0);
        }
        
        /* Product Card Styles */
        .product-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            overflow: hidden;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        
        /* Button Styles */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            font-weight: 500;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .btn-primary {
            background: var(--secondary);
            color: var(--primary);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .btn-secondary {
            background: transparent;
            color: var(--secondary);
            border: 1px solid var(--secondary);
        }
        
        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        /* Badge Styles */
        .badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            height: 24px;
            min-width: 24px;
            padding: 0 6px;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            background: var(--secondary);
            color: var(--primary);
        }
        
        /* League Badges */
        .league-badge {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .league-amateur {
            background: #4ade80;
            color: #052e16;
        }
        
        .league-intermediate {
            background: #60a5fa;
            color: #1e3a8a;
        }
        
        .league-pro {
            background: #f59e0b;
            color: #78350f;
        }
        
        .league-legend {
            background: #ec4899;
            color: #831843;
        }
        
        /* Form Styles */
        .form-input {
            width: 100%;
            padding: 0.75rem 1rem;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.1);
            color: var(--secondary);
            transition: all 0.3s ease;
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--secondary);
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.2);
        }
        
        /* Table Styles */
        .table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .table th, .table td {
            padding: 0.75rem 1rem;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .table th {
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.75rem;
            letter-spacing: 0.05em;
            color: rgba(255, 255, 255, 0.6);
        }
        
        /* Toast Styles */
        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            background: #10b981;
            color: white;
            font-weight: 500;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            z-index: 1000;
        }
        
        .toast.active {
            opacity: 1;
        }
        
        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .cart-sidebar {
                width: 100%;
                max-width: none;
            }
            
            .product-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <div class="nav-menu">
        <button id="menu-toggle" class="btn btn-secondary">
            <span>Menu</span>
        </button>
        <div id="nav-dropdown" class="nav-dropdown">
            <div class="flex flex-col space-y-2">
                <a href="#" class="nav-link" data-scene="sep-shop">SEP Shop</a>
                <a href="#" class="nav-link" data-scene="sep-about">About SEP</a>
                <a href="#" class="nav-link" data-scene="mih-welcome">Make It Happen</a>
                <a href="#" class="nav-link" data-scene="mih-about">About MIH</a>
                <div class="pt-2 mt-2 border-t border-gray-200">
                    <div class="text-xs font-medium mb-1" data-i18n="language">Language</div>
                    <div class="flex space-x-2">
                        <button class="lang-btn active" data-lang="en">English</button>
                        <button class="lang-btn" data-lang="da">Dansk</button>
                        <button class="lang-btn" data-lang="cs">Česky</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Cart Overlay -->
    <div id="cart-overlay" class="cart-overlay"></div>

    <!-- Cart Sidebar -->
    <div id="cart-sidebar" class="cart-sidebar">
        <div class="p-6">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-xl font-bold" data-i18n="your_cart">Your Cart</h2>
                <button id="close-cart" class="text-gray-500 hover:text-gray-700">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            
            <div class="mb-4">
                <div class="text-sm font-medium mb-2" data-i18n="shipping_to">Shipping to</div>
                <div class="flex space-x-2">
                    <button id="shipping-cph" class="shipping-btn active" data-location="copenhagen">Copenhagen</button>
                    <button id="shipping-dk" class="shipping-btn" data-location="denmark">Rest of Denmark</button>
                </div>
            </div>
            
            <div id="cart-items" class="mb-6">
                <!-- Cart items will be inserted here -->
            </div>
            
            <div class="border-t border-gray-200 pt-4 mb-4">
                <div class="flex justify-between mb-2">
                    <span data-i18n="subtotal">Subtotal</span>
                    <span id="cart-subtotal">0 kr</span>
                </div>
                <div class="flex justify-between mb-2">
                    <span data-i18n="shipping">Shipping</span>
                    <span id="cart-shipping">0 kr</span>
                </div>
                <div class="flex justify-between font-bold text-lg">
                    <span data-i18n="total">Total</span>
                    <span id="cart-total">0 kr</span>
                </div>
            </div>
            
            <div class="flex flex-col space-y-2">
                <button id="open-mobilepay" class="btn btn-primary">
                    <span data-i18n="open_mobilepay">Open MobilePay</span>
                </button>
                <button id="copy-order" class="btn btn-secondary">
                    <span data-i18n="copy_order">Copy Order Message</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <!-- SEP Shop Scene -->
    <section id="scene-sep-shop" class="scene">
        <div class="container mx-auto px-4 py-12">
            <!-- Hero Section -->
            <div class="flex flex-col items-center justify-center min-h-[60vh] text-center mb-16 fade-section">
                <h1 class="text-4xl md:text-5xl font-bold mb-4 max-w-3xl" data-i18n="hero_title">Minimalist clothing made with intention</h1>
                <p class="text-xl mb-8 max-w-2xl opacity-80" data-i18n="hero_subtitle">Soft, clean and hand pressed in Copenhagen</p>
                <div class="flex flex-wrap justify-center gap-4">
                    <a href="#products" class="btn btn-primary" data-i18n="shop_now">Shop Now</a>
                    <button id="view-cart" class="btn btn-secondary relative">
                        <span data-i18n="view_cart">View Cart</span>
                        <span id="cart-count" class="badge absolute -top-2 -right-2 hidden">0</span>
                    </button>
                </div>
            </div>
            
            <!-- Products Section -->
            <div id="products" class="mb-24 fade-section">
                <h2 class="text-2xl font-bold mb-8 text-center" data-i18n="our_products">Our Products</h2>
                <div class="product-grid grid grid-cols-1 md:grid-cols-3 gap-8">
                    <!-- Product 1: White T-Shirt -->
                    <div class="product-card p-6">
                        <div class="mb-4 aspect-square bg-gray-100 rounded-lg overflow-hidden">
                            <img src="http://static.photos/minimal/640x360/1" alt="SEP White T-Shirt" class="w-full h-full object-cover">
                        </div>
                        <h3 class="text-xl font-semibold mb-2" data-i18n="white_tshirt">SEP White T-Shirt</h3>
                        <div class="text-lg font-medium mb-4">180 kr</div>
                        
                        <div class="mb-4">
                            <label class="block text-sm font-medium mb-2" data-i18n="size">Size</label>
                            <select class="product-size form-input">
                                <option value="XS">XS</option>
                                <option value="S">S</option>
                                <option value="M" selected>M</option>
                                <option value="L">L</option>
                                <option value="XL">XL</option>
                            </select>
                        </div>
                        
                        <div class="mb-4">
                            <label class="block text-sm font-medium mb-2" data-i18n="quantity">Quantity</label>
                            <input type="number" min="1" value="1" class="product-quantity form-input">
                        </div>
                        
                        <button class="add-to-cart btn btn-primary w-full" data-product="white-tshirt" data-i18n="add_to_cart">Add to Cart</button>
                    </div>
                    
                    <!-- Product 2: Black Hoodie -->
                    <div class="product-card p-6">
                        <div class="mb-4 aspect-square bg-gray-800 rounded-lg overflow-hidden">
                            <img src="http://static.photos/minimal/640x360/2" alt="SEP Black Hoodie" class="w-full h-full object-cover">
                        </div>
                        <h3 class="text-xl font-semibold mb-2" data-i18n="black_hoodie">SEP Black Hoodie</h3>
                        <div class="text-lg font-medium mb-4">180 kr</div>
                        
                        <div class="mb-4">
                            <label class="block text-sm font-medium mb-2" data-i18n="size">Size</label>
                            <select class="product-size form-input">
                                <option value="XS">XS</option>
                                <option value="S">S</option>
                                <option value="M" selected>M</option>
                                <option value="L">L</option>
                                <option value="XL">XL</option>
                            </select>
                        </div>
                        
                        <div class="mb-4">
                            <label class="block text-sm font-medium mb-2" data-i18n="quantity">Quantity</label>
                            <input type="number" min="1" value="1" class="product-quantity form-input">
                        </div>
                        
                        <button class="add-to-cart btn btn-primary w-full" data-product="black-hoodie" data-i18n="add_to_cart">Add to Cart</button>
                    </div>
                    
                    <!-- Product 3: Black Trousers -->
                    <div class="product-card p-6">
                        <div class="mb-4 aspect-square bg-gray-900 rounded-lg overflow-hidden">
                            <img src="http://static.photos/minimal/640x360/3" alt="SEP Black Trousers" class="w-full h-full object-cover">
                        </div>
                        <h3 class="text-xl font-semibold mb-2" data-i18n="black_trousers">SEP Black Trousers</h3>
                        <div class="text-lg font-medium mb-4">180 kr</div>
                        
                        <div class="mb-4">
                            <label class="block text-sm font-medium mb-2" data-i18n="size">Size</label>
                            <select class="product-size form-input">
                                <option value="XS">XS</option>
                                <option value="S">S</option>
                                <option value="M" selected>M</option>
                                <option value="L">L</option>
                                <option value="XL">XL</option>
                            </select>
                        </div>
                        
                        <div class="mb-4">
                            <label class="block text-sm font-medium mb-2" data-i18n="quantity">Quantity</label>
                            <input type="number" min="1" value="1" class="product-quantity form-input">
                        </div>
                        
                        <button class="add-to-cart btn btn-primary w-full" data-product="black-trousers" data-i18n="add_to_cart">Add to Cart</button>
                    </div>
                </div>
            </div>
            
            <!-- How to Order Section -->
            <div class="max-w-3xl mx-auto mb-24 fade-section">
                <h2 class="text-2xl font-bold mb-8 text-center" data-i18n="how_to_order">How to Order</h2>
                <div class="space-y-6">
                    <div class="flex items-start">
                        <div class="flex-shrink-0 h-10 w-10 rounded-full bg-white text-black flex items-center justify-center font-bold mr-4">1</div>
                        <div>
                            <h3 class="font-semibold mb-1" data-i18n="step1_title">Choose product and size</h3>
                            <p class="opacity-80" data-i18n="step1_desc">Select your preferred item and the right size for you.</p>
                        </div>
                    </div>
                    <div class="flex items-start">
                        <div class="flex-shrink-0 h-10 w-10 rounded-full bg-white text-black flex items-center justify-center font-bold mr-4">2</div>
                        <div>
                            <h3 class="font-semibold mb-1" data-i18n="step2_title">Add to cart</h3>
                            <p class="opacity-80" data-i18n="step2_desc">Add your selected items to the cart.</p>
                        </div>
                    </div>
                    <div class="flex items-start">
                        <div class="flex-shrink-0 h-10 w-10 rounded-full bg-white text-black flex items-center justify-center font-bold mr-4">3</div>
                        <div>
                            <h3 class="font-semibold mb-1" data-i18n="step3_title">Copy order message</h3>
                            <p class="opacity-80" data-i18n="step3_desc">Copy your order details to paste in MobilePay.</p>
                        </div>
                    </div>
                    <div class="flex items-start">
                        <div class="flex-shrink-0 h-10 w-10 rounded-full bg-white text-black flex items-center justify-center font-bold mr-4">4</div>
                        <div>
                            <h3 class="font-semibold mb-1" data-i18n="step4_title">Pay with MobilePay</h3>
                            <p class="opacity-80" data-i18n="step4_desc">Send the payment to MobilePay 5894BZ.</p>
                        </div>
                    </div>
                    <div class="flex items-start">
                        <div class="flex-shrink-0 h-10 w-10 rounded-full bg-white text-black flex items-center justify-center font-bold mr-4">5</div>
                        <div>
                            <h3 class="font-semibold mb-1" data-i18n="step5_title">Send order via DM</h3>
                            <p class="opacity-80" data-i18n="step5_desc">DM us on Instagram with your order details.</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Footer -->
            <footer class="text-center opacity-70 text-sm fade-section">
                <div class="mb-4">
                    <p class="font-medium">SEP - <span data-i18n="se_proairesis">Se Proairesis</span> (<span data-i18n="your_choice">Your Choice</span>)</p>
                    <p data-i18n="mobilepay_number">MobilePay: 5894BZ</p>
                    <p data-i18n="shipping_info">+45 kr shipping, free in Copenhagen</p>
                    <p data-i18n="delivery_note">Currently delivering only in Denmark</p>
                </div>
                <div class="mb-4">
                    <p data-i18n="privacy_statement">No data selling. No ads that follow you. No creepy tracking.</p>
                </div>
                <div class="flex justify-center space-x-4">
                    <a href="https://instagram.com/seproairesis" target="_blank" class="hover:underline">Instagram</a>
                    <a href="https://tiktok.com/@seproairesis" target="_blank" class="hover:underline">TikTok</a>
                </div>
            </footer>
        </div>
    </section>

    <!-- About SEP Scene -->
    <section id="scene-sep-about" class="scene bg-black text-white">
        <div class="container mx-auto px-4 py-20 max-w-3xl">
            <h1 class="text-3xl font-bold mb-8" data-i18n="about_sep">About SEP</h1>
            
            <div class="space-y-6 mb-12">
                <p data-i18n="about_paragraph1">
                    SEP comes from the ancient Greek "Se Proairesis" meaning "Your Choice". 
                    It represents our philosophy of intentional living through simple, 
                    mindful choices in what we wear and how we live.
                </p>
                <p data-i18n="about_paragraph2">
                    Each piece is hand pressed in Copenhagen in small batches, 
                    focusing on quality over quantity. We reject the constant 
                    drops and hype culture of modern fashion, offering instead 
                    a small selection of essential items designed to last.
                </p>
                <p data-i18n="about_paragraph3">
                    We believe in privacy as a fundamental right. We don't sell 
                    your data, don't track you across the internet, and don't 
                    use dark patterns to manipulate your choices.
                </p>
            </div>
            
            <div class="flex flex-wrap gap-4">
                <button class="btn btn-primary" data-scene="sep-shop" data-i18n="back_to_shop">Back to SEP Shop</button>
                <button class="btn btn-secondary" data-scene="mih-welcome" data-i18n="go_to_mih">Go to Make It Happen</button>
            </div>
        </div>
    </section>

    <!-- Make It Happen Welcome Scene -->
    <section id="scene-mih-welcome" class="scene">
        <div class="container mx-auto px-4 py-20 text-center">
            <h1 class="text-4xl font-bold mb-6">Move more. Compete. Make it happen.</h1>
            
            <div class="max-w-2xl mx-auto mb-12">
                <p class="text-xl mb-8">
                    A simple movement challenge to track your runs, walks or cycles. 
                    Log your distance, climb the leaderboard, and challenge yourself 
                    to improve.
                </p>
                
                <div class="flex flex-wrap justify-center gap-4 mb-12">
                    <button class="btn btn-primary" data-scene="mih-leaderboard">See Leaderboard</button>
                    <button class="btn btn-secondary" data-scene="mih-about">What is this?</button>
                </div>
                
                <div class="flex flex-wrap justify-center gap-2">
                    <span class="px-3 py-1 bg-gray-100 text-gray-800 rounded-full text-sm">Four leagues</span>
                    <span class="px-3 py-1 bg-gray-100 text-gray-800 rounded-full text-sm">Automatic placement</span>
                    <span class="px-3 py-1 bg-gray-100 text-gray-800 rounded-full text-sm">Distance tracking</span>
                    <span class="px-3 py-1 bg-gray-100 text-gray-800 rounded-full text-sm">Improvement rewards</span>
                </div>
            </div>
            
            <div class="max-w-md mx-auto">
                <button class="btn btn-secondary" data-scene="sep-shop">Back to SEP</button>
            </div>
        </div>
    </section>

    <!-- Make It Happen Login Scene -->
    <section id="scene-mih-login" class="scene">
        <div class="container mx-auto px-4 py-20 max-w-md">
            <h1 class="text-3xl font-bold mb-8 text-center">Log In / Sign Up</h1>
            
            <form id="mih-login-form" class="space-y-6">
                <div>
                    <label for="mih-name" class="block text-sm font-medium mb-2">Name</label>
                    <input type="text" id="mih-name" class="form-input w-full" required>
                </div>
                
                <div>
                    <label for="mih-password" class="block text-sm font-medium mb-2">Password</label>
                    <input type="password" id="mih-password" class="form-input w-full" required>
                </div>
                
                <button type="submit" class="btn btn-primary w-full">Continue</button>
            </form>
            
            <p class="text-xs mt-6 text-center opacity-70">
                Accounts logged out for more than 30 days are automatically deleted 
                together with their activity data.
            </p>
        </div>
    </section>

    <!-- Make It Happen Leaderboard Scene -->
    <section id="scene-mih-leaderboard" class="scene">
        <div class="container mx-auto px-4 py-12">
            <div class="flex flex-col lg:flex-row gap-8">
                <!-- Left Column: Activity Form -->
                <div class="lg:w-1/3">
                    <div class="sticky top-20">
                        <h2 class="text-2xl font-bold mb-6">My Activity</h2>
                        
                        <form id="mih-activity-form" class="space-y-4 mb-8">
                            <div>
                                <label class="block text-sm font-medium mb-2">Name</label>
                                <input type="text" id="mih-current-user" class="form-input w-full" disabled>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium mb-2">Distance (km)</label>
                                <input type="number" step="0.1" id="mih-distance" class="form-input w-full" required>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium mb-2">Time (minutes)</label>
                                <input type="number" step="1" id="mih-time" class="form-input w-full" required>
                            </div>
                            
                            <button type="submit" class="btn btn-primary w-full">Save my activity</button>
                        </form>
                        
                        <div class="bg-white bg-opacity-10 p-4 rounded-lg">
                            <h3 class="font-bold mb-2">Ranking Logic</h3>
                            <ul class="text-sm space-y-2">
                                <li>• Distance: Total km logged</li>
                                <li>• Commitment: Number of sessions</li>
                                <li>• Consistency: Weeks with activity</li>
                                <li>• Improvement: Pace and distance gains</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- Right Column: Leaderboard -->
                <div class="lg:w-2/3">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold">Leaderboard</h2>
                        <select id="mih-league-filter" class="form-input">
                            <option value="all">All Leagues</option>
                            <option value="amateurs">Amateurs</option>
                            <option value="intermediates">Intermediates</option>
                            <option value="pros">Pros</option>
                            <option value="legends">Legends</option>
                        </select>
                    </div>
                    
                    <div class="overflow-x-auto">
                        <table class="table w-full">
                            <thead>
                                <tr>
                                    <th>Rank</th>
                                    <th>Name</th>
                                    <th>League</th>
                                    <th>Distance</th>
                                    <th>Avg. Pace</th>
                                </tr>
                            </thead>
                            <tbody id="mih-leaderboard-body">
                                <!-- Leaderboard rows will be inserted here -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="mt-12">
                        <h3 class="text-xl font-bold mb-4">My Activities</h3>
                        <div id="mih-user-activities">
                            <!-- User activities will be inserted here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Make It Happen Stats Scene -->
    <section id="scene-mih-stats" class="scene">
        <div class="container mx-auto px-4 py-20 max-w-4xl">
            <h1 class="text-3xl font-bold mb-8">Community Stats</h1>
            
            <div class="overflow-x-auto">
                <table class="table w-full">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>League</th>
                            <th>Runs</th>
                            <th>Total Distance</th>
                            <th>Total Time</th>
                            <th>Avg. Distance</th>
                            <th>Best Distance</th>
                            <th>Improvement</th>
                        </tr>
                    </thead>
                    <tbody id="mih-stats-body">
                        <!-- Stats rows will be inserted here -->
                    </tbody>
                </table>
            </div>
            
            <div class="mt-8 text-center">
                <button class="btn btn-secondary" data-scene="mih-leaderboard">Back to Leaderboard</button>
            </div>
        </div>
    </section>

    <!-- Make It Happen Profile Scene -->
    <section id="scene-mih-profile" class="scene">
        <div class="container mx-auto px-4 py-20 max-w-2xl">
            <div class="text-center mb-12">
                <h1 id="mih-profile-name" class="text-3xl font-bold mb-2">Runner Name</h1>
                <span id="mih-profile-league" class="league-badge league-amateur">Amateur</span>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-12">
                <div class="bg-white bg-opacity-10 p-6 rounded-lg">
                    <h2 class="text-xl font-bold mb-4">Summary</h2>
                    <div class="space-y-4">
                        <div class="flex justify-between">
                            <span>Total Distance</span>
                            <span id="mih-profile-distance" class="font-bold">0 km</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Total Time</span>
                            <span id="mih-profile-time" class="font-bold">0 min</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Number of Runs</span>
                            <span id="mih-profile-runs" class="font-bold">0</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Average Distance</span>
                            <span id="mih-profile-avg-distance" class="font-bold">0 km</span>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white bg-opacity-10 p-6 rounded-lg">
                    <h2 class="text-xl font-bold mb-4">Estimated Best Times</h2>
                    <div class="space-y-4">
                        <div class="flex justify-between">
                            <span>5 km</span>
                            <span id="mih-profile-5k" class="font-bold">-</span>
                        </div>
                        <div class="flex justify-between">
                            <span>10 km</span>
                            <span id="mih-profile-10k" class="font-bold">-</span>
                        </div>
                        <div class="flex justify-between">
                            <span>100 m</span>
                            <span id="mih-profile-100m" class="font-bold">-</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="text-center">
                <button class="btn btn-secondary" data-scene="mih-leaderboard">Back to Leaderboard</button>
            </div>
        </div>
    </section>

    <!-- Make It Happen About Scene -->
    <section id="scene-mih-about" class="scene">
        <div class="container mx-auto px-4 py-20 max-w-3xl">
            <h1 class="text-3xl font-bold mb-8">About Make It Happen</h1>
            
            <div class="space-y-6 mb-12">
                <p>
                    Make It Happen is a simple health challenge designed to 
                    encourage movement without the need for subscriptions, 
                    special apps or fancy gear. Just log your runs, walks 
                    or cycles and track your progress.
                </p>
                <p>
                    The challenge is suitable for everyone - older runners, 
                    heavier runners, busy parents and complete beginners. 
                    The four leagues ensure you're competing with people at 
                    a similar level, with automatic placement to keep groups 
                    balanced.
                </p>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 my-8">
                    <div class="bg-white bg-opacity-10 p-4 rounded-lg">
                        <h3 class="font-bold mb-2">Healthy</h3>
                        <p class="text-sm">Focus on consistent movement and gradual improvement.</p>
                    </div>
                    <div class="bg-white bg-opacity-10 p-4 rounded-lg">
                        <h3 class="font-bold mb-2">Free</h3>
                        <p class="text-sm">No subscriptions, no fees, no special equipment needed.</p>
                    </div>
                    <div class="bg-white bg-opacity-10 p-4 rounded-lg">
                        <h3 class="font-bold mb-2">Fun</h3>
                        <p class="text-sm">Friendly competition to keep you motivated.</p>
                    </div>
                </div>
                
                <p>
                    Your data stays in your browser - we don't sell it, don't 
                    track you, and don't use dark patterns. This is a simple 
                    tool to help you move more, nothing else.
                </p>
            </div>
            
            <div class="flex flex-wrap gap-4">
                <button class="btn btn-primary" data-scene="mih-leaderboard">Go to Leaderboard</button>
                <button class="btn btn-secondary" data-scene="sep-shop">Back to SEP</button>
            </div>
        </div>
    </section>

    <script>
        // ==============================================
        // TRANSLATION SYSTEM
        // ==============================================
        
        // Translation dictionary
        const translations = {
            en: {
                // Navigation
                "language": "Language",
                
                // SEP Shop
                "hero_title": "Minimalist clothing made with intention",
                "hero_subtitle": "Soft, clean and hand pressed in Copenhagen",
                "shop_now": "Shop Now",
                "view_cart": "View Cart",
                "our_products": "Our Products",
                "white_tshirt": "SEP White T-Shirt",
                "black_hoodie": "SEP Black Hoodie",
                "black_trousers": "SEP Black Trousers",
                "size": "Size",
                "quantity": "Quantity",
                "add_to_cart": "Add to Cart",
                "how_to_order": "How to Order",
                "step1_title": "Choose product and size",
                "step1_desc": "Select your preferred item and the right size for you.",
                "step2_title": "Add to cart",
                "step2_desc": "Add your selected items to the cart.",
                "step3_title": "Copy order message",
                "step3_desc": "Copy your order details to paste in MobilePay.",
                "step4_title": "Pay with MobilePay",
                "step4_desc": "Send the payment to MobilePay 5894BZ.",
                "step5_title": "Send order via DM",
                "step5_desc": "DM us on Instagram with your order details.",
                "se_proairesis": "Se Proairesis",
                "your_choice": "Your Choice",
                "mobilepay_number": "MobilePay: 5894BZ",
                "shipping_info": "+45 kr shipping, free in Copenhagen",
                "delivery_note": "Currently delivering only in Denmark",
                "privacy_statement": "No data selling. No ads that follow you. No creepy tracking.",
                
                // Cart
                "your_cart": "Your Cart",
                "shipping_to": "Shipping to",
                "subtotal": "Subtotal",
                "shipping": "Shipping",
                "total": "Total",
                "open_mobilepay": "Open MobilePay",
                "copy_order": "Copy Order Message",
                "remove": "Remove",
                "free_in_cph": "Free in Copenhagen",
                "added_to_cart": "Added to cart",
                "order_copied": "Order message copied",
                
                // About SEP
                "about_sep": "About SEP",
                "about_paragraph1": "SEP comes from the ancient Greek \"Se Proairesis\" meaning \"Your Choice\". It represents our philosophy of intentional living through simple, mindful choices in what we wear and how we live.",
                "about_paragraph2": "Each piece is hand pressed in Copenhagen in small batches, focusing on quality over quantity. We reject the constant drops and hype culture of modern fashion, offering instead a small selection of essential items designed to last.",
                "about_paragraph3": "We believe in privacy as a fundamental right. We don't sell your data, don't track you across the internet, and don't use dark patterns to manipulate your choices.",
                "back_to_shop": "Back to SEP Shop",
                "go_to_mih": "Go to Make It Happen"
            },
            da: {
                // Navigation
                "language": "Sprog",
                
                // SEP Shop
                "hero_title": "Minimalistisk tøj lavet med intention",
                "hero_subtitle": "Blødt, rent og håndpresset i København",
                "shop_now": "Shop Nu",
                "view_cart": "Se Kurv",
                "our_products": "Vores Produkter",
                "white_tshirt": "SEP Hvid T-Shirt",
                "black_hoodie": "SEP Sort Hoodie",
                "black_trousers": "SEP Sort Bukser",
                "size": "Størrelse",
                "quantity": "Antal",
                "add_to_cart": "Tilføj til Kurv",
                "how_to_order": "Sådan Bestiller Du",
                "step1_title": "Vælg produkt og størrelse",
                "step1_desc": "Vælg dit foretrukne produkt og den rigtige størrelse.",
                "step2_title": "Tilføj til kurven",
                "step2_desc": "Tilføj dine valgte varer til kurven.",
                "step3_title": "Kopier ordrebesked",
                "step3_desc": "Kopier dine ordredetaljer for at indsætte i MobilePay.",
                "step4_title": "Betal med MobilePay",
                "step4_desc": "Send betalingen til MobilePay 5894BZ.",
                "step5_title": "Send ordre via DM",
                "step5_desc": "Send os en DM på Instagram med dine ordredetaljer.",
                "se_proairesis": "Se Proairesis",
                "your_choice": "Dit Valg",
                "mobilepay_number": "MobilePay: 5894BZ",
                "shipping_info": "+45 kr fragt, gratis i København",
                "delivery_note": "Leverer kun i Danmark i øjeblikket",
                "privacy_statement": "Ingen salg af data. Ingen annoncer der følger dig. Ingen creepy sporing.",
                
                // Cart
                "your_cart": "Din Kurv",
                "shipping_to": "Forsendelse til",
                "subtotal": "Subtotal",
                "shipping": "Fragt",
                "total": "Total",
                "open_mobilepay": "Åbn MobilePay",
                "copy_order": "Kopier Ordrebesked",
                "remove": "Fjern",
                "free_in_cph": "Gratis i København",
                "added_to_cart": "Tilføjet til kurven",
                "order_copied": "Ordrebesked kopieret",
                
                // About SEP
                "about_sep": "Om SEP",
                "about_paragraph1": "SEP kommer fra det oldgræske \"Se Proairesis\" som betyder \"Dit Valg\". Det repræsenterer vores filosofi om bevidst livsførelse gennem enkle, bevidste valg i hvad vi bærer og hvordan vi lever.",
                "about_paragraph2": "Hvert stykke er håndpresset i København i små batches med fokus på kvalitet frem for kvantitet. Vi afviser den konstante udrulning og hypekultur i moderne mode, og tilbyder i stedet et lille udvalg af essentielle varer designet til at holde.",
                "about_paragraph3": "Vi tror på privatliv som en grundlæggende ret. Vi sælger ikke dine data, sporer dig ikke på tværs af internettet og bruger ikke dark patterns til at manipulere dine valg.",
                "back_to_shop": "Tilbage til SEP Shop",
                "go_to_mih": "Gå til Make It Happen"
            },
            cs: {
                // Navigation
                "language": "Jazyk",
                
                // SEP Shop
                "hero_title": "Minimalistické oblečení vytvořené s úmyslem",
                "hero_subtitle": "Měkké, čisté a ručně lisované v Kodani",
                "shop_now": "Nakupovat Nyní",
                "view_cart": "Zobrazit Košík",
                "our_products": "Naše Produkty",
                "white_tshirt": "SEP Bílé Tričko",
                "black_hoodie": "SEP Černá Mikina",
                "black_trousers": "SEP Černé Kalhoty",
                "size": "Velikost",
                "quantity": "Množství",
                "add_to_cart": "Přidat do Košíku",
                "how_to_order": "Jak Objednat",
                "step1_title": "Vyberte produkt a velikost",
                "step1_desc": "Vyberte si preferovaný produkt a správnou velikost.",
                "step2_title": "Přidejte do košíku",
                "step2_desc": "Přidejte vybrané položky do košíku.",
                "step3_title": "Zkopírujte zprávu objednávky",
                "step3_desc": "Zkopírujte podrobnosti objednávky pro vložení do MobilePay.",
                "step4_title": "Zaplaťte MobilePay",
                "step4_desc": "Odešlete platbu na MobilePay 5894BZ.",
                "step5_title": "Odešlete objednávku přes DM",
                "step5_desc": "Pošlete nám DM na Instagramu s podrobnostmi objednávky.",
                "se_proairesis": "Se Proairesis",
                "your_choice": "Tvoje Volba",
                "mobilepay_number": "MobilePay: 5894BZ",
                "shipping_info": "+45 Kč doprava, v Kodani zdarma",
                "delivery_note": "V současné době doručujeme pouze v Dánsku",
                "privacy_statement": "Žádný prodej dat. Žádné reklamy, které vás sledují. Žádné creepy sledování.",
                
                // Cart
                "your_cart": "Váš Košík",
                "shipping_to": "Doprava do",
                "subtotal": "Mezisoučet",
                "shipping": "Doprava",
                "total": "Celkem",
                "open_mobilepay": "Otevřít MobilePay",
                "copy_order": "Kopírovat Zprávu Objednávky",
                "remove": "Odebrat",
                "free_in_cph": "V Kodani zdarma",
                "added_to_cart": "Přidáno do košíku",
                "order_copied": "Zpráva objednávky zkopírována",
                
                // About SEP
                "about_sep": "O SEP",
                "about_paragraph1": "SEP pochází ze starořeckého \"Se Proairesis\", což znamená \"Tvoje Volba\". Představuje naši filozofii vědomého života prostřednictvím jednoduchých, promyšlených voleb v tom, co nosíme a jak žijeme.",
                "about_paragraph2": "Každý kus je ručně lisován v Kodani v malých sériích s důrazem na kvalitu před kvantitou. Odmítáme neustálé novinky a hype kulturu moderní módy a místo toho nabízíme malý výběr základních kousků navržených tak, aby vydržely.",
                "about_paragraph3": "Věříme, že soukromí je základním právem. Neprodáváme vaše data, nesledujeme vás na internetu a nepoužíváme dark patterns k manipulaci vašich rozhodnutí.",
                "back_to_shop": "Zpět do SEP Shopu",
                "go_to_mih": "Přejít na Make It Happen"
            }
        };
        
        // Current language
        let currentLang = 'en';
        
        // Translation function
        function t(key) {
            return translations[currentLang][key] || translations.en[key] || key;
        }
        
        // Apply translations to all elements with data-i18n attribute
        function applyTranslations() {
            document.querySelectorAll('[data-i18n]').forEach(el => {
                el.innerHTML = t(el.getAttribute('data-i18n'));
            });
        }
        
        // Set language and save preference
        function setLanguage(lang) {
            if (translations[lang]) {
                currentLang = lang;
                localStorage.setItem('sep_lang', lang);
                applyTranslations();
                
                // Update active language button
                document.querySelectorAll('.lang-btn').forEach(btn => {
                    if (btn.getAttribute('data-lang') === lang) {
                        btn.classList.add('active');
                    } else {
                        btn.classList.remove('active');
                    }
                });
            }
        }
        
        // Initialize language
        function initLanguage() {
            const savedLang = localStorage.getItem('sep_lang');
            const browserLang = navigator.language.substring(0, 2);
            
            if (savedLang && translations[savedLang]) {
                setLanguage(savedLang);
            } else if (translations[browserLang]) {
                setLanguage(browserLang);
            } else {
                setLanguage('en');
            }
        }
        
        // ==============================================
        // SCENE MANAGEMENT
        // ==============================================
        
        // Show a specific scene
        function showScene(name) {
            // Hide all scenes
            document.querySelectorAll('.scene').forEach(scene => {
                scene.classList.remove('active');
            });
            
            // Show the requested scene
            const scene = document.getElementById(`scene-${name}`);
            if (scene) {
                scene.classList.add('active');
            }
            
            // Scroll to top
            window.scrollTo({
                top: 0,
                behavior: 'instant'
            });
            
            // Special handling for certain scenes
            if (name === 'mih-leaderboard') {
                renderLeaderboard();
                renderUserActivities();
            } else if (name === 'mih-stats') {
                renderStats();
            }
        }
        
        // ==============================================
        // SEP CART SYSTEM
        // ==============================================
        
        // Cart state
        let cart = {
            items: [],
            shipping: 'copenhagen'
        };
        
        // Product definitions
        const products = {
            'white-tshirt': {
                nameKey: 'white_tshirt',
                price: 180,
                image: 'http://static.photos/minimal/640x360/1'
            },
            'black-hoodie': {
                nameKey: 'black_hoodie',
                price: 180,
                image: 'http://static.photos/minimal/640x360/2'
            },
            'black-trousers': {
                nameKey: 'black_trousers',
                price: 180,
                image: 'http://static.photos/minimal/640x360/3'
            }
        };
        
        // Load cart from localStorage
        function loadCart() {
            const savedCart = localStorage.getItem('cart');
            if (savedCart) {
                cart = JSON.parse(savedCart);
            }
            updateCartUI();
        }
        
        // Save cart to localStorage
        function saveCart() {
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCartUI();
        }
        
        // Add item to cart
        function addToCart(productId, size, quantity) {
            // Check if item already exists in cart with same size
            const existingIndex = cart.items.findIndex(
                item => item.productId === productId && item.size === size
            );
            
            if (existingIndex >= 0) {
                // Update quantity if item exists
                cart.items[existingIndex].quantity += parseInt(quantity);
            } else {
                // Add new item if it doesn't exist
                cart.items.push({
                    productId,
                    size,
                    quantity: parseInt(quantity)
                });
            }
            
            saveCart();
            showToast(t('added_to_cart'));
        }
        
        // Remove item from cart
        function removeFromCart(index) {
            cart.items.splice(index, 1);
            saveCart();
        }
        
        // Update shipping location
        function updateShipping(location) {
            cart.shipping = location;
            saveCart();
        }
        
        // Calculate cart totals
        function calculateCartTotals() {
            let subtotal = 0;
            
            cart.items.forEach(item => {
                const product = products[item.productId];
                subtotal += product.price * item.quantity;
            });
            
            const shippingCost = cart.shipping === 'copenhagen' ? 0 : 45;
            const total = subtotal + shippingCost;
            
            return {
                subtotal,
                shippingCost,
                total
            };
        }
        
        // Update cart UI
        function updateCartUI() {
            // Update cart items list
            const cartItemsEl = document.getElementById('cart-items');
            cartItemsEl.innerHTML = '';
            
            if (cart.items.length === 0) {
                cartItemsEl.innerHTML = '<p class="text-center py-4" data-i18n="cart_empty">Your cart is empty</p>';
            } else {
                cart.items.forEach((item, index) => {
                    const product = products[item.productId];
                    const itemTotal = product.price * item.quantity;
                    
                    const itemEl = document.createElement('div');
                    itemEl.className = 'flex justify-between items-center py-3 border-b border-gray-200';
                    itemEl.innerHTML = `
                        <div class="flex-1">
                            <div class="font-medium">${t(product.nameKey)}</div>
                            <div class="text-sm">${item.size} • ${item.quantity}x</div>
                        </div>
                        <div class="text-right">
                            <div class="font-medium">${itemTotal} kr</div>
                            <button class="text-xs text-red-500 hover:text-red-700 remove-item" data-index="${index}" data-i18n="remove">${t('remove')}</button>
                        </div>
                    `;
                    cartItemsEl.appendChild(itemEl);
                });
            }
            
            // Update totals
            const totals = calculateCartTotals();
            document.getElementById('cart-subtotal').textContent = `${totals.subtotal} kr`;
            document.getElementById('cart-shipping').textContent = 
                cart.shipping === 'copenhagen' ? `${t('free_in_cph')}` : `${totals.shippingCost} kr`;
            document.getElementById('cart-total').textContent = `${totals.total} kr`;
            
            // Update shipping buttons
            document.getElementById('shipping-cph').classList.toggle('active', cart.shipping === 'copenhagen');
            document.getElementById('shipping-dk').classList.toggle('active', cart.shipping === 'denmark');
            
            // Update cart counter
            const totalItems = cart.items.reduce((sum, item) => sum + item.quantity, 0);
            const cartCountEl = document.getElementById('cart-count');
            
            if (totalItems > 0) {
                cartCountEl.textContent = totalItems;
                cartCountEl.classList.remove('hidden');
            } else {
                cartCountEl.classList.add('hidden');
            }
        }
        
        // Copy order message to clipboard
        function copyOrderMessage() {
            if (cart.items.length === 0) return;
            
            const totals = calculateCartTotals();
            let message = `Hej SEP!\n\nJeg vil gerne bestille:\n`;
            
            cart.items.forEach(item => {
                const product = products[item.productId];
                message += `${item.quantity}x ${t(product.nameKey)} (${item.size})\n`;
            });
            
            message += `\nSubtotal: ${totals.subtotal} kr\n`;
            message += `Fragt: ${cart.shipping === 'copenhagen' ? 'Gratis i København' : `${totals.shippingCost} kr`}\n`;
            message += `Total: ${totals.total} kr\n\n`;
            message += `MobilePay: 5894BZ`;
            
            navigator.clipboard.writeText(message)
                .then(() => {
                    showToast(t('order_copied'));
                })
                .catch(err => {
                    console.error('Failed to copy order message:', err);
                });
        }
        
        // Open MobilePay
        function openMobilePay() {
            if (cart.items.length === 0) return;
            
            // Try to open MobilePay app
            window.location.href = 'mobilepay://transfer';
            
            // Show thank you message
            setTimeout(() => {
                showToast('Tak for din støtte til SEP');
            }, 1000);
        }
        
        // Show toast notification
        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('active');
            
            setTimeout(() => {
                toast.classList.remove('active');
            }, 3000);
        }
        
        // ==============================================
        // MAKE IT HAPPEN SYSTEM
        // ==============================================
        
        // Data version (for localStorage keys)
        const MIH_DATA_VERSION = 1;
        
        // League definitions
        const leagues = ['amateurs', 'intermediates', 'pros', 'legends'];
        
        // Load MIH data from localStorage
        function loadMihData() {
            return {
                users: JSON.parse(localStorage.getItem(`mih_users_v${MIH_DATA_VERSION}`) || '[]'),
                entries: JSON.parse(localStorage.getItem(`mih_entries_v${MIH_DATA_VERSION}`) || '[]'),
                currentUser: JSON.parse(localStorage.getItem(`mih_current_user_v${MIH_DATA_VERSION}`) || 'null')
            };
        }
        
        // Save MIH data to localStorage
        function saveMihData(data) {
            localStorage.setItem(`mih_users_v${MIH_DATA_VERSION}`, JSON.stringify(data.users));
            localStorage.setItem(`mih_entries_v${MIH_DATA_VERSION}`, JSON.stringify(data.entries));
            
            if (data.currentUser) {
                localStorage.setItem(`mih_current_user_v${MIH_DATA_VERSION}`, JSON.stringify(data.currentUser));
            } else {
                localStorage.removeItem(`mih_current_user_v${MIH_DATA_VERSION}`);
            }
        }
        
        // Clean up old accounts (logged out for more than 30 days)
        function cleanupOldAccounts() {
            const data = loadMihData();
            const now = Date.now();
            const thirtyDaysAgo = now - (30 * 24 * 60 * 60 * 1000);
            
            // Filter out users who haven't logged in for 30 days
            const activeUsers = data.users.filter(user => {
                return user.lastLogin && user.lastLogin > thirtyDaysAgo;
            });
            
            // Filter entries to only include active users
            const activeUserIds = activeUsers.map(user => user.id);
            const activeEntries = data.entries.filter(entry => {
                return activeUserIds.includes(entry.userId);
            });
            
            // Update current user if it's been logged out for too long
            if (data.currentUser && (!data.currentUser.lastLogin || data.currentUser.lastLogin < thirtyDaysAgo)) {
                data.currentUser = null;
            }
            
            // Save cleaned data if changes were made
            if (activeUsers.length !== data.users.length || activeEntries.length !== data.entries.length) {
                saveMihData({
                    users: activeUsers,
                    entries: activeEntries,
                    currentUser: data.currentUser
                });
            }
            
            return {
                users: activeUsers,
                entries: activeEntries,
                currentUser: data.currentUser
            };
        }
        
        // Handle login/signup
        function handleMihLogin(name, password) {
            const data = loadMihData();
            
            // Check if user exists
            const existingUser = data.users.find(user => user.name.toLowerCase() === name.toLowerCase());
            
            if (existingUser) {
                // Verify password
                if (existingUser.password === password) {
                    // Update last login
                    existingUser.lastLogin = Date.now();
                    data.currentUser = { id: existingUser.id, name: existingUser.name };
                    saveMihData(data);
                    
                    // Redirect to leaderboard
                    showScene('mih-leaderboard');
                    return true;
                } else {
                    alert('Wrong password');
                    return false;
                }
            } else {
                // Create new user
                const newUser = {
                    id: Date.now().toString(),
                    name,
                    password,
                    league: determineLeague(data.users),
                    createdAt: Date.now(),
                    lastLogin: Date.now()
                };
                
                data.users.push(newUser);
                data.currentUser = { id: newUser.id, name: newUser.name };
                saveMihData(data);
                
                // Redirect to leaderboard
                showScene('mih-leaderboard');
                return true;
            }
        }
        
        // Determine which league to place new user in
        function determineLeague(users) {
            // Count users in each league
            const leagueCounts = {};
            leagues.forEach(league => {
                leagueCounts[league] = users.filter(user => user.league === league).length;
            });
            
            // Find league with fewest users
            let minLeague = leagues[0];
            let minCount = leagueCounts[minLeague];
            
            leagues.forEach(league => {
                if (leagueCounts[league] < minCount) {
                    minLeague = league;
                    minCount = leagueCounts[league];
                }
            });
            
            return minLeague;
        }
        
        // Add new activity
        function addActivity(userId, distance, time) {
            const data = loadMihData();
            
            const newEntry = {
                id: Date.now().toString(),
                userId,
                distanceKm: parseFloat(distance),
                timeMinutes: parseInt(time),
                timestamp: Date.now()
            };
            
            data.entries.push(newEntry);
            saveMihData(data);
            
            // Update leaderboard and activities
            renderLeaderboard();
            renderUserActivities();
        }
        
        // Delete activity
        function deleteActivity(entryId) {
            const data = loadMihData();
            data.entries = data.entries.filter(entry => entry.id !== entryId);
            saveMihData(data);
            
            // Update leaderboard and activities
            renderLeaderboard();
            renderUserActivities();
        }
        
        // Calculate user stats
        function calculateUserStats(userId) {
            const data = loadMihData();
            const userEntries = data.entries.filter(entry => entry.userId === userId);
            
            if (userEntries.length === 0) {
                return null;
            }
            
            const totalDistance = userEntries.reduce((sum, entry) => sum + entry.distanceKm, 0);
            const totalTime = userEntries.reduce((sum, entry) => sum + entry.timeMinutes, 0);
            const avgDistance = totalDistance / userEntries.length;
            const avgPace = totalTime / totalDistance; // min/km
            
            // Find best distance
            const bestDistance = Math.max(...userEntries.map(entry => entry.distanceKm));
            
            // Calculate improvement (compare last 5 activities to previous 5)
            let improvement = 0;
            if (userEntries.length >= 10) {
                const recent = userEntries.slice(-5);
                const previous = userEntries.slice(-10, -5);
                
                const recentAvg = recent.reduce((sum, entry) => sum + entry.distanceKm, 0) / 5;
                const previousAvg = previous.reduce((sum, entry) => sum + entry.distanceKm, 0) / 5;
                
                improvement = ((recentAvg - previousAvg) / previousAvg) * 100;
            }
            
            return {
                runs: userEntries.length,
                totalDistance,
                totalTime,
                avgDistance,
                avgPace,
                bestDistance,
                improvement
            };
        }
        
        // Render leaderboard
        function renderLeaderboard() {
            const data = loadMihData();
            const filter = document.getElementById('mih-league-filter').value;
            
            // Calculate stats for all users
            const userStats = data.users.map(user => {
                const stats = calculateUserStats(user.id) || {
                    runs: 0,
                    totalDistance: 0,
                    totalTime: 0,
                    avgDistance: 0,
                    avgPace: 0,
                    bestDistance: 0,
                    improvement: 0
                };
                
                return {
                    ...user,
                    ...stats
                };
            });
            
            // Filter by league if needed
            const filteredStats = filter === 'all' 
                ? userStats 
                : userStats.filter(user => user.league === filter);
            
            // Sort by total distance (descending)
            filteredStats.sort((a, b) => b.totalDistance - a.totalDistance);
            
            // Render table
            const tbody = document.getElementById('mih-leaderboard-body');
            tbody.innerHTML = '';
            
            filteredStats.forEach((user, index) => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-white hover:bg-opacity-10 cursor-pointer';
                row.setAttribute('data-user-id', user.id);
                
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td class="font-medium">${user.name}</td>
                    <td><span class="league-badge league-${user.league}">${user.league}</span></td>
                    <td>${user.totalDistance.toFixed(1)} km</td>
                    <td>${user.avgPace.toFixed(1)} min/km</td>
                `;
                
                tbody.appendChild(row);
            });
            
            // Add click handlers to view profiles
            tbody.querySelectorAll('tr').forEach(row => {
                row.addEventListener('click', () => {
                    const userId = row.getAttribute('data-user-id');
                    showUserProfile(userId);
                });
            });
        }
        
        // Render user activities
        function renderUserActivities() {
            const data = loadMihData();
            const container = document.getElementById('mih-user-activities');
            
            if (!data.currentUser) {
                container.innerHTML = '<p class="text-center py-4">Please log in to view your activities</p>';
                return;
            }
            
            const userEntries = data.entries
                .filter(entry => entry.userId === data.currentUser.id)
                .sort((a, b) => b.timestamp - a.timestamp);
            
            if (userEntries.length === 0) {
                container.innerHTML = '<p class="text-center py-4">No activities yet</p>';
                return;
            }
            
            const table = document.createElement('table');
            table.className = 'table';
            
            const tbody = document.createElement('tbody');
            
            userEntries.forEach(entry => {
                const date = new Date(entry.timestamp);
                const dateStr = date.toLocaleDateString();
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${dateStr}</td>
                    <td>${entry.distanceKm.toFixed(1)} km</td>
                    <td>${entry.timeMinutes} min</td>
                    <td><button class="text-red-500 hover:text-red-700 delete-activity" data-entry-id="${entry.id}">Delete</button></td>
                `;
                
                tbody.appendChild(row);
            });
            
            table.appendChild(tbody);
            container.innerHTML = '';
            container.appendChild(table);
            
            // Add delete handlers
            container.querySelectorAll('.delete-activity').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const entryId = btn.getAttribute('data-entry-id');
                    if (confirm('Are you sure you want to delete this activity?')) {
                        deleteActivity(entryId);
                    }
                });
            });
        }
        
        // Render stats table
        function renderStats() {
            const data = loadMihData();
            
            // Calculate stats for all users
            const userStats = data.users.map(user => {
                const stats = calculateUserStats(user.id) || {
                    runs: 0,
                    totalDistance: 0,
                    totalTime: 0,
                    avgDistance: 0,
                    bestDistance: 0,
                    improvement: 0
                };
                
                return {
                    ...user,
                    ...stats
                };
            });
            
            // Sort by total distance (descending)
            userStats.sort((a, b) => b.totalDistance - a.totalDistance);
            
            // Render table
            const tbody = document.getElementById('mih-stats-body');
            tbody.innerHTML = '';
            
            userStats.forEach(user => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-white hover:bg-opacity-10';
                
                row.innerHTML = `
                    <td class="font-medium">${user.name}</td>
                    <td><span class="league-badge league-${user.league}">${user.league}</span></td>
                    <td>${user.runs}</td>
                    <td>${user.totalDistance.toFixed(1)} km</td>
                    <td>${user.totalTime} min</td>
                    <td>${user.avgDistance.toFixed(1)} km</td>
                    <td>${user.bestDistance.toFixed(1)} km</td>
                    <td>${user.improvement.toFixed(1)}%</td>
                `;
                
                tbody.appendChild(row);
            });
        }
        
        // Show user profile
        function showUserProfile(userId) {
            const data = loadMihData();
            const user = data.users.find(u => u.id === userId);
            
            if (!user) return;
            
            const stats = calculateUserStats(userId) || {
                runs: 0,
                totalDistance: 0,
                totalTime: 0,
                avgDistance: 0,
                avgPace: 0,
                bestDistance: 0
            };
            
            // Update profile elements
            document.getElementById('mih-profile-name').textContent = user.name;
            document.getElementById('mih-profile-league').textContent = user.league;
            document.getElementById('mih-profile-league').className = `league-badge league-${user.league}`;
            
            document.getElementById('mih-profile-distance').textContent = `${stats.totalDistance.toFixed(1)} km`;
            document.getElementById('mih-profile-time').textContent = `${stats.totalTime} min`;
            document.getElementById('mih-profile-runs').textContent = stats.runs;
            document.getElementById('mih-profile-avg-distance').textContent = `${stats.avgDistance.toFixed(1)} km`;
            
            // Calculate estimated best times
            if (stats.avgPace > 0) {
                document.getElementById('mih-profile-5k').textContent = `${(stats.avgPace * 5).toFixed(1)} min`;
                document.getElementById('mih-profile-10k').textContent = `${(stats.avgPace * 10).toFixed(1)} min`;
                document.getElementById('mih-profile-100m').textContent = `${(stats.avgPace * 0.1).toFixed(1)} min`;
            } else {
                document.getElementById('mih-profile-5k').textContent = '-';
                document.getElementById('mih-profile-10k').textContent = '-';
                document.getElementById('mih-profile-100m').textContent = '-';
            }
            
            // Show profile scene
            showScene('mih-profile');
        }
        
        // ==============================================
        // INITIALIZATION
        // ==============================================
        
        function initAll() {
            // Initialize language
            initLanguage();
            
            // Load cart
            loadCart();
            
            // Clean up old MIH accounts
            cleanupOldAccounts();
            
            // Set up event listeners
            setupEventListeners();
            
            // Initialize GSAP animations
            initAnimations();
            
            // Show initial scene
            showScene('sep-shop');
        }
        
        function setupEventListeners() {
            // Navigation menu toggle
            document.getElementById('menu-toggle').addEventListener('click', () => {
                document.getElementById('nav-dropdown').classList.toggle('active');
            });
            
            // Navigation links
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const scene = link.getAttribute('data-scene');
                    showScene(scene);
                    document.getElementById('nav-dropdown').classList.remove('active');
                });
            });
            
            // Language buttons
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const lang = btn.getAttribute('data-lang');
                    setLanguage(lang);
                });
            });
            
            // Cart toggle
            document.getElementById('view-cart').addEventListener('click', () => {
                document.getElementById('cart-overlay').classList.add('active');
                document.getElementById('cart-sidebar').classList.add('active');
            });
            
            // Close cart
            document.getElementById('close-cart').addEventListener('click', closeCart);
            document.getElementById('cart-overlay').addEventListener('click', closeCart);
            
            // Shipping buttons
            document.getElementById('shipping-cph').addEventListener('click', () => {
                updateShipping('copenhagen');
            });
            
            document.getElementById('shipping-dk').addEventListener('click', () => {
                updateShipping('denmark');
            });
            
            // Remove item buttons (delegated)
            document.getElementById('cart-items').addEventListener('click', (e) => {
                if (e.target.classList.contains('remove-item')) {
                    const index = parseInt(e.target.getAttribute('data-index'));
                    removeFromCart(index);
                }
            });
            
            // MobilePay button
            document.getElementById('open-mobilepay').addEventListener('click', (e) => {
                e.preventDefault();
                openMobilePay();
            });
            
            // Copy order button
            document.getElementById('copy-order').addEventListener('click', (e) => {
                e.preventDefault();
                copyOrderMessage();
            });
            
            // Add to cart buttons
            document.querySelectorAll('.add-to-cart').forEach(btn => {
                btn.addEventListener('click', () => {
                    const productId = btn.getAttribute('data-product');
                    const card = btn.closest('.product-card');
                    const size = card.querySelector('.product-size').value;
                    const quantity = card.querySelector('.product-quantity').value;
                    
                    addToCart(productId, size, quantity);
                });
            });
            
            // MIH Login form
            document.getElementById('mih-login-form').addEventListener('submit', (e) => {
                e.preventDefault();
                const name = document.getElementById('mih-name').value;
                const password = document.getElementById('mih-password').value;
                
                handleMihLogin(name, password);
            });
            
            // MIH Activity form
            document.getElementById('mih-activity-form').addEventListener('submit', (e) => {
                e.preventDefault();
                const data = loadMihData();
                
                if (!data.currentUser) {
                    alert('Please log in first');
                    return;
                }
                
                const distance = document.getElementById('mih-distance').value;
                const time = document.getElementById('mih-time').value;
                
                addActivity(data.currentUser.id, distance, time);
                
                // Reset form
                document.getElementById('mih-distance').value = '';
                document.getElementById('mih-time').value = '';
            });
            
            // MIH League filter
            document.getElementById('mih-league-filter').addEventListener('change', () => {
                renderLeaderboard();
            });
            
            // Scene links
            document.querySelectorAll('[data-scene]').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.preventDefault();
                    const scene = btn.getAttribute('data-scene');
                    showScene(scene);
                });
            });
        }
        
        function initAnimations() {
            // Initialize GSAP animations for fade sections
            gsap.registerPlugin(ScrollTrigger);
            
            document.querySelectorAll('.fade-section').forEach(section => {
                gsap.from(section, {
                    opacity: 0,
                    y: 20,
                    duration: 0.6,
                    scrollTrigger: {
                        trigger: section,
                        start: "top 80%",
                        toggleActions: "play none none none",
                        once: true
                    }
                });
            });
        }
        
        function closeCart() {
            document.getElementById('cart-overlay').classList.remove('active');
            document.getElementById('cart-sidebar').classList.remove('active');
        }
        
        // Initialize everything when DOM is loaded
        document.addEventListener('DOMContentLoaded', initAll);
    </script>
</body>
</html>
